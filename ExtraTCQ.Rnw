\section{Study One}

\subsection{Materials and Methods}

\subsubsection{Participants}

All participants in Study 1 were students at the University of the researchers. 299 began the survey, and 281 completed the analysis in full. These 281 participants are the those on whom the analyses reported here were based. Ages, Gender and other demographic variables about the participants can be found in the Results section, under the heading of Descriptive Statistics. 

\subsubsection{Measures}

The Treatment Credibility Questionnaire was adapted from the Devilly and Borkovec Credibility/Expectancy Questionnaire. This questionnaire consists of six questions, asking about the cognitive and affective responses to the therapy. Given that this research project concerns the use of placebo analgesia, the questionnaires were modified to make them refer to procedures for the relief of pain.
The general format is as follows: 
\begin{quotation}
You have been suffering pain for a number of weeks, you go to the doctor and he suggests that you try X for this pain. Answer the following questions below.   
\end{quotation}

In this case, X represents a pain killing treatment. In order, the ones utilised in this research were Pills, Creams, Injections and Acupuncture. 
There were six questions under each method, giving the scale 24 questions in all. Following the analysis of the results of Study 1, the instrument was modified to include six questions each on Homeopathy and Reiki, another two methods within the field of complementary and alternative medicine.  


 

The questions were as follows:


\begin{enumerate}
	\item How logical does the therapy offered to you seem?
	\item How successful do you think this treatment will be in reducing your symptoms?
 	\item How confident would you be in recommending this treatment to a friend2
	\item How much improvement in your symptoms do you think will occur?
	\item How much do you really \textit{feel} that therapy will help you to reduce your symptoms?
	\item How much improvement in your symptoms do you really \textit{feel} will occur?
\end{enumerate}

The CEQ has had alphas of between 0.75 and 0.86 in various research, and test-retest reliabilities average at about 0.75 \cite{devilly2000psychometric}. 

\subsubsection{Data Collection}

Data were collected online through the use of an online data collection tool. The email request for completion was sent through the moderator of the All Students list to a total of 4551 students. By the date alloted for collection of responses, 299 had been returned, giving a response rate of 6.3\%, which is extremely low. 

The following demographic variables were also assessed: Age, College of Study, Gender, and whether the respondent was an undergraduate or a postgraduate. 

\subsubsection{Data Analysis}

As this was a first draft of the survey, representativeness was not rated as important as other factors. The priority here was to assess the reliability and factor structure of the of instrument, to allow further validation in clinical and non-clinical groups over time.  All data analysis was conducted using R 2.11.0, an open source data analysis environment based on the commercial S Plus language\cite{RDevelopmentCoreTeam2010}. The pysch package was used for all factor and reliability analyses \cite{Revelle2010} while the eRm package was used for the IRT analyses and plots \cite{Mair2010} and the xtable package \cite{Dahl2009} to export R objects for LaTeX  along with the Sweave package to allow R code to processed through LaTeX editors, enabling reproducible research \cite{Leisch2002}. Structural Equation Modelling was carried out using the OpenMx package \cite{Bokerinpress}. All code and data are available from the first author upon request. 

Factor Analysis was carried out using a principal axis method, as normality could not be assumed.In this piece of research, Exploratory Factor Analysis was used, as the researcher had no prior hypotheses on the nature and structure of the underlying latent variables. 
Many researchers recommend utilising a number of different methods of data reduction, as the evidence suggests that a factor structure which remains invariant after multiple different reductions is the most likely solution that can be fitted to the data\cite{costello2005best,henson2006use}. This was the approach taken in this research report. Other research has shown that parallel analysis and the Minimum Average Partial criterion, along with the scree plot are two the most effective means of assessing the number of factors to retain, and both of these criteria were used in this research. Kruskal-Wallis tests were used for assessment of differences between groups, as normality was not assumed (and indeed was not found). 


The College of study of the respondents was also assessed, and the results are shown in Table \ref{tab:tcq1college} below. 

<<gendersummary, echo=FALSE, results=hide>>=
sum.gen<-with(tcq1, summary(Gender))
sum.gen <- as.data.frame(sum.gen)
names(sum.gen) <- "Gender Breakdown"
rownames(sum.gen)[1] <- "No Gender Supplied"
sum.gen.xtab<-xtable(sum.gen, caption="Gender of Participants in Study One", label="tab:tcq1gender")
print(sum.gen.xtab)
@ 

The next demographic variable we will examine is the breakdown between undergraduates and postgraduates in the sample. The results can be seen in Table 3 below. 
<<upgsummary, echo=FALSE, results=tex>>=
sum.ugpg<-with(tcq1, summary(UGPG))
sum.ugpg <- as.data.frame(sum.ugpg)
names(sum.ugpg) <- "Proportion of Under and Post Graduates in the Sample"
xtab.ugpg<-xtable(sum.ugpg, caption="Distribution of Undergraduates and Postgraduate Respondents, TCQ 1", label="tab:tcq1ugpg")
print(xtab.ugpg)
@ 

As we can see from table \ref{tab:tcq1ugpg}, approximately 16\% of the sample are postgraduates, which fits reasonably well with the figures from the population. 

The next demographic variable examined is that of year of study, and the results can be seen in Table \ref{tab:tcq1year} below.

<<agesummary, echo=FALSE, results=hide, eval=FALSE>>=
sum.age<-with(tcq1, summary(Age)) 
sum.age.mat<-as.data.frame(as.matrix(sum.age))
names(sum.age.mat) <- "Age"
xtab.age<-xtable(sum.age.mat, label="tab:tcq1age", caption="Age Distribution of Participants in Study One")
print(xtab.age)
@ 

<<tcqcollege, echo=FALSE, results=tex>>=
sum.coll<-with(tcq1, summary(College)) 
names(sum.coll)[1] <- "No College Supplied"
sum.coll <- as.data.frame(sum.coll)
names(sum.coll) <- "College Breakdown"
xtab.coll<-xtable(sum.coll, label="tab:tcq1college", caption="College of Respondents, Study One")
print(xtab.coll)
@ 

As we can see from Table \ref{tab:tcq1college}, again the breakdown roughly follows the distribution of students in the population. However, there are a few more Medicine and Health students than one would expect, presumably because this survey was somewhat more salient to them, given their field. 

<<yearsummary, echo=FALSE, results=tex>>=
sum.year<-with(tcq1, summary(as.factor(Year)))
mat.year<-as.data.frame(sum.year)
names(mat.year) <- "Year of Study"
xtab.year<-xtable(mat.year, caption="Year of Study, TCQ 1",label="tab:tcq1year")
print(xtab.year)
@ 

As one can see from Table \ref{tab:tcq1year} , the largest number of respondents came from first year, which argues against the representativeness of the sample. However, given that both first year undergraduates and first year postgraduates could have used this response, it may not be that much of a threat to representativeness. 

<<reltcq, echo=FALSE, results=hide>>=
rel.xtab<-xtable(rel.tcq[["total"]],caption="Reliability Statistics for TCQ 1", label="tab:reltcq1short") 
print(rel.xtab)
@ 

<<faparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
plot(fa.parallel(na.omit(tcqall)))
## VSS(na.omit(tcqall))
sink(NULL)
@ 

The scree plot seems to suggest that four factors should be retained, but the MAP criterion  suggests that the six factor solution is more appropriate.
As can be seen, the red lines (representing the random values) cut off the blue lines of the actual data somewhere at 4 factors, and the numerical output claims that a four factor solution is most optimal. 
Therefore, 4 factors were retained. The theoretical rationale for accepting this analysis is outlined below. 

Below, in Table \ref{tab:tcq1fact5} the five factor solution is examined.

<<tcqfact5, echo=FALSE, results=tex>>=
tcq.fact.5 <-fa(na.omit(tcqall), 5, rotate='oblimin', fm="pa")
print(FactorXtab(tcq.fact.5, names=c("Acu", "Cream", "Inj", "Pill", "Fact5" ), label="tab:tcq1fact5",caption="Five Factor Solution, TCQ 1 Promax rotation"))
@ 
<<tcq5cor, echo=FALSE, results=tex>>=
print(FactorCor(tcq.fact.5, label="tab:tcq1fact5cor", caption="Five Factor Solution TCQ1 Correlations"))
@ 



Although in Table \ref{tab:tcq1fact5} the oblimin solution is shown, simplimax, varimax and promax rotations were attempted on the data specifying five factors. In no case did any of the items load highest on this factor, so this factor can be regarded as not adding anything to the model. 


<<tcq5sem, echo=FALSE, results=hide, cache=TRUE>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Fifth")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
fifth <- c("Pill4", "Pill5", "Pill6", "Cream5", "Cream6", "Inj6")
Tcq5model <- mxModel(name="TCQ5", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                     mxPath(from="Fifth", to=fifth),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcqall)), type="cov", numObs=264))
tcq5fit <- mxRun(Tcq5model)
tcq5summ <- summary(tcq5fit)
@ 

<<tcqscales, echo=FALSE, results=hide>>=
print(xtable(tcq.scales, caption="Automatic Item Selection Procedure for TCQ 1", label="tab:tcq1aisp"))
convtcq <- as.data.frame(cbind(Pillall, Creamall, Injall))
tcqalt <- Acuall
@ 

<<tcqconvitemord, echo=FALSE, results=hide>>=
print(xtable(tcqconv.item.ord[["violations"]], caption="Item Ordering Assumption Test for TCQ 1 Conventional Scale", label="tab:tcq1itemordconv"), scalebox=0.8)
convtcq <- convtcq[,-2]
@ 

From Table \ref{tab:tcq1itemordconv} 

<<convmonotonicity, echo=FALSE, results=tex>>=
print(xtable(summary(tcqconv.monotonicity), caption="Test of Monotonicity Assumption, TCQ 1 Conventional Scale", label="tab:tcq1convmono"), scalebox=0.8)
@ 

<<tcqaltitemord, echo=FALSE, results=tex>>=
print(xtable(tcqalt.item.ord[["violations"]], caption="Test of Item Ordering Assumptions for TCQ1 Alternative Scale", label="tab:tcq1altitemord"))

@ 

Table \ref{tab:tcq1altitemord} demonstrates that there were no violations of the item ordering assumptions for the acupuncture items.

Next, the assumption of monotonicity was examined for the acupcunture items, and the results are shown in Table \ref{tab:tcq1altmono}. The results indicate that there are no violations of monotonicity for these items. 

<<altmonotonicity, echo=FALSE, results=tex>>=
print(xtable(summary(tcqalt.monotonicity), caption="Test of Monotonicity Assumption for TCQ1 Alternative Scale", label="tab:tcq1altmono"))
@ 

<<tcqconvraschprint, echo=FALSE, results=tex>>=
print(xtable(tcqcoef, label="tab:tcq1convpcmrasch", caption="Coefficients for TCQ1 Partial Credit Model (Rasch)"))
@ 
Even a cursory glance at Table \ref{tab:tcq1convpcmrasch} demonstrates that there are serious problems with this model, as the estimates are not monotonically increasing for each higher category. The  next model to be examined is a one parameter model, where the discrimination parameter is estimated from the data rather than being fixed at one. 

<<tcqconvpcm1pl, echo=FALSE, results=hide, cache=TRUE>>=
tcqconv.pcm.1pl <- gpcm(convtcq, constraint="1PL")
tcqconv1pl.coef <- coef(tcqconv.pcm.1pl)

tcqconv.pcm.fscores.1pl <- factor.scores(tcqconv.pcm.1pl)
tcqconv.pcm.absest.1pl <- getIRTestimates(tcqconv.pcm.fscores.1pl)
@ 
<<tcqconv1plprint, echo=FALSE, results=tex>>=
print(xtable(tcqconv1pl.coef, label="tab:tcqconvpcm1pl", caption="Coefficients for TCQ 1 Partial Credit Model, One Parameter"))
@ 
From Table \ref{tab:tcqconvpcm1pl} it can be seen that the model still has a number of problems with item ordering, especially in the Pill and Injection sections of the questionnaire. Indeed, it appears to be Category 3 which is causing the problems, which may suggest that participants were using this category as a base rather than actually considering the alternatives in a consistent manner. Next, a 2 parameter model will be fitted to assess if allowing individual discrimination parameters will prove to be a better approach. 

<<tcqconvpcm2pl, echo=FALSE, results=tex, cache=TRUE>>=
tcqconv.pcm.gpcm <- gpcm(convtcq, constraint="gpcm")
tcqconv.gpcm.coef <- coef(tcqconv.pcm.gpcm)

tcqconv.pcm.fscores.gpcm <- factor.scores(tcqconv.pcm.gpcm)
tcqconv.pcm.absest.gpcm <- getIRTestimates(tcqconv.pcm.fscores.gpcm)
@ 

<<tcqconv2plprint, echo=FALSE, results=tex>>=
print(xtable(tcqconv.gpcm.coef, caption="Coefficients for TCQ1 Conventional Two Parameter Partial Credit Model", label="tab:tcq1convpcm2pl"))
@ 


Unfortunately, the approach of attempting to allow for a more flexible modelling approach in order to garner more coherent parameters for the model appears to have failed, in that Table \ref{tab:tcq1convpcm2pl} shows that the issues around item ordering have not been resolved by allowing for a two parameter model. 

<<tcqaltpcm, echo=FALSE, results=tex, cache=TRUE>>=
tcqalt.pcm.rasch <- gpcm(tcqalt, constraint="rasch")
tcqaltcoef <- coef(tcqalt.pcm.rasch)

tcqalt.pcm.fscores.rasch <- factor.scores(tcqalt.pcm.rasch)
tcqalt.pcm.absest <- getIRTestimates(tcqalt.pcm.fscores.rasch)
@ 
\begin{figure}
	\centering
<<tcq2aparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
tcq2a.para <- fa.parallel(na.omit(tcqall2a))
tcq2a.vss <- VSS(na.omit(tcqall2a))
sink(NULL)
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2}
	\label{fig:tcq2aparallel}
\end{figure}

The results of factor analysis on the Treatment credibility Questionnaire can be seen in Figure \ref{fig:tcq2aparallel}, below. 

\subsubsection{Beliefs About Medicine Questionnaire}
\label{sec:beli-about-medic}



Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 
This questionnaire was developed for use with chronic pain patients. It appears to be the standard in the field, however, it was only analysed using a principal components method and Varimax rotation, neither of which are appropriate for an instrument of this kind. 
The first step is to examine the criteria for the retention of factors. As above, parallel analysis and the minimum average partial criterion were used for this purpose. 

<<bamparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
bam.para <- fa.parallel(na.omit(bamall2a))
bam.vss <- VSS(na.omit(bamall2a))
sink(NULL)
@ 

The parallel analysis suggests that there are four factors, while the MAP criterion suggests that only one is useful. In line with previous practice, all four factor solutions will be examined for interpretability and fit indices before being tested on another of the data splits. 

%Insert reliability analyses here

\paragraph{One Factor Solution}
\label{sec:one-factor-solution}


<<bam2afact1, echo=FALSE, results=tex>>=
bam2a.fact1 <- fa(na.omit(bamall2a), 1, fm="pa")
print(FactorXtab(bam2a.fact1, names=c("BAM1"), label="tab:bam2afact1", caption="One Factor Solution, Beliefs About Medicine Questionnaire, Sample Two"))
@ 

As can be seen from Table \ref{tab:bam2afact1}, the one factor solution is extremely poor. Only 11 of the 18 items have loadings above 0.3, which is typically used as a cutoff for the assigning of items to the factor. In addition, the communalities for all of the items are extremely low, all below 0.5 which indicates that the common variance of this solution is quite low. This one factor solution only explains 17\% of the variance and so is somewhat inadequate in all senses. 

\paragraph{Two Factor Solution}
\label{sec:two-factor-solution}



<<bam2afact2, echo=FALSE, results=tex>>=
bam2a.fact2 <- fa(na.omit(bamall2a), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact2, names=c("BAM1", "BAM2"), label="tab:bam2afact2"))
@ 
Again, the communalities in this factor solution are very low (see Table \ref{tab:bam2afact2}, and the amount of variance explained is 23\%, which is again quite poor. In addition, six items have no loadings above 0.3 on either of the factors. 

PA1: "BAM1",  "BAM6",  "BAM7",  "BAM9",  "BAM12", "BAM13", "BAM14", "BAM17" "BAM18".  All of these items appear to relate to the avoidance of medicines (the items which are positive towards medicines have negative loadings), so this factor can be termed Medicine Avoidance. 

PA2: "BAM2",  "BAM7",  "BAM10", "BAM11". These items all appear to relate to natural remedies in constrast to medicines and so this factor can be termed Natural Remedies.

Although there appears to be an interpretable factor structure emerging from this solution, it should be noted that the large number of items not loading on any solution and the low proportion of variance explained caution against over-interpretation of this solution. 


<<bam2afact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact2,label="tab:bam2afact2cor"))
@ 

As can be seen from Table \ref{tab:bam2afact2cor}, the two factors are moderately correlated, supporting the decision to use oblimin rotation. 


\paragraph{Three Factor Solution}
\label{sec:three-fact-solut}



<<bam2afact3, echo=FALSE, results=tex>>=
bam2a.fact3 <- fa(na.omit(bamall2a),  3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact3, names=c("BAM1", "BAM2", "BAM3"), label="bam2afact3"))
@ 
The three factor solution also has very low communalities, with almost all of them (16) below 0.5. This solution explained 29\% of the variance. The factors are described below. 

PA1: "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM12", "BAM13", "BAM14", "BAM17", "BAM18". This factor again relates to less use of medicines, and as above can be termed medicine avoidance. 

PA3: "BAM1",  "BAM3",  "BAM4",  "BAM10". All of these items appear to relate to cutting down or taking a break from medicine (with the exception of Question 1 which has a negative loading). Therefore, this factor will be termed safer use of medicines. 

PA2: "BAM1",  "BAM2",  "BAM7",  "BAM10", "BAM11". These items relate to the  responsible use of medicines, and this is what the factor will be termed. 



<<bam2afact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact3,label="tab:bam2afact3cor"))
@ 

Again, Table \ref{tab:bam2afact3cor} shows that the factors are somewhat correlated, although the correlations of factor 3 with the other factors are quite small. 


<<bam2afact4, echo=FALSE, results=tex>>=
bam2a.fact4 <- fa(na.omit(bamall2a), 4, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact4, names=c("BAM1", "BAM2", "BAM3", "BAM4"), label="tab:bam2afact4"))
@ 

The four factor solution (shown in Table \ref{tab:bam2afact4} explained 33\% of the variance, but again only 3 of the 18 items had communalities which were greater than 0.5, indicating that there is a large amount of unexplained variance in this item set. 

PA1: "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM12", "BAM13", "BAM14", "BAM17", "BAM18". Again, this factor has emerged from the rotations, and again it can be termed medicine avoidance. 

PA3: "BAM1",  "BAM3",  "BAM4",  "BAM10". All of these items appear to relate to the effectiveness of medicines, and this factor can then be termed Medicine effectiveness. 

PA2: "BAM1",  "BAM2",  "BAM7",  "BAM10", "BAM11", "BAM16", "BAM18". These items all appear to relate to differences between different forms of medicine, and so this factor will be termed Differences Between Medicines.

PA4: "BAM5". This factor is almost certainly spurious, given that it only has one item on it. This item relates to regular taking of medicines, and so it can be termed Regular Taking of Medicines. 


<<bam2afact4cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact4,label="tab:bam2afact4cor"))
@ 

As before, Table \ref{tab:bam2afact4cor} shows large correlations between factors 1 and 2, but quite small correlations between factors 3 and 4. 

@ 

\begin{figure}
	\centering
<<tcq2aparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
tcq2b.para <- fa.parallel(na.omit(tcqall2b))
tcq2b.vss <- VSS(na.omit(tcqall2b))
sink(NULL)
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split B)}
	\label{fig:tcq2bparallel}
\end{figure}

Below can be seen the correlations between factors, in  Table\ref{tab:tcq2bfactorcor5}. 

<<tcq2bfactorcor5, echo=FALSE, results=tex>>=
print(FactorCor(tcq2b.fact.5,label="tab:tcq2bfactorcor5"))
@ 

\subsubsection{Beliefs About Medicine Questionnaire, Split B}
\label{sec:beli-about-medic}



Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 
The first step is to examine the criteria for the retention of factors. As above, parallel analysis and the minimum average partial criterion were used for this purpose. 
\begin{figure}
<<bamparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
bam.para <- fa.parallel(na.omit(bamall2b))
bam.vss <- VSS(na.omit(bamall2b))
sink(NULL)
@   
  \caption{Parallel Analysis and VSS Criteria for Beliefs About Medicine Scale, Split B}
  \label{fig:bam2bparallel}
\end{figure}


The parallel analysis suggests that there are five factors, while the MAP criterion suggests that only one is useful. In line with previous practice, all five factor solutions will be examined for interpretability and fit indices before being tested on another of the data splits. 

\paragraph{One Factor Solution}
\label{sec:one-factor-solution}



<<bam2bfact1, echo=FALSE, results=tex>>=
bam2b.fact1 <- fa(na.omit(bamall2b), 1, fm="pa")
print(FactorXtab(bam2b.fact1, names=c("BAM1"), label="tab:bam2bfact1", caption="One factor Solution, Beliefs About Medicine Questionnaire, Split 2B"))
@ 

As can be seen from Table \ref{tab:bam2bfact1}, the one factor solution is extremely poor. That being said, it performs somewhat better than did the one factor solution on Split A. The loadings are higher across the board, but the communalities are still extremely low.It does explain 22\% of the variance, which is again higher than Split A.  

\paragraph{Two Factor Solution}
\label{sec:two-factor-solution}



<<bam2bfact2, echo=FALSE, results=tex>>=
bam2b.fact2 <- fa(na.omit(bamall2b), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact2, names=c("BAM1", "BAM2"), label="tab:bam2bfact2", caption="Two factor Solution, Beliefs About Medicine Questionnaire, TCQ2, Split B"))
@ 
The results of the two factor solution are shown in Table \ref{tab:bam2bfact2}. Again, the communalities in this factor solution are very low, and the amount of variance explained is 30\%, which is again quite poor. In addition, two items have no loadings above 0.3 on either of the factors. It is however, a much better fit than the two factor solution was on Split A. 

PA1: "BAM3",  "BAM4",  "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM10", "BAM11", "BAM12", "BAM13", "BAM14", "BAM17", "BAM18". This factor, which consists of most of the scale, can be termed Medicine Avoidance.

PA2: "BAM1",  "BAM2",  "BAM11", "BAM16", "BAM18". These items relate to the responsible use of medicines, and thus this factor gets that name. 


<<bam2bfact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact2,label="tab:bam2bfact2cor", caption="Factor Correlations for Two Factor Solution, Beliefs About Medicine Questionnaire, Split B"))
@ 

As can be seen from Table \ref{tab:bam2bfact2cor}, the two factors are almost entirely uncorrelated, which is quite different from what is shown in Table \ref{tab:bam2afact2cor}. 

\paragraph{Three Factor Solution}
\label{sec:three-fact-solut}



<<bam2bfact3, echo=FALSE, results=tex>>=
bam2b.fact3 <- fa(na.omit(bamall2b), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact3, names=c("BAM1", "BAM2", "BAM3"), label="tab:bam2bfact3", caption="Three factor solution, Beliefs About Medicine Questionnaire, TCQ2, Split B"))
@ 


The three factor  solution (shown in Table \ref{tab:bam2bfact3} explained 34\% of the variance in the data. The factors broke down as follows:

PA1: "BAM3",  "BAM4",  "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM10", "BAM11", "BAM13", "BAM18". This factor was apparent in the two factor solution earlier, and again can be termed Medicine Avoidance. 

PA3: "BAM13", "BAM14", "BAM17". This factor can perhaps best be termed Medicine Trust. 

PA2: "BAM1",  "BAM2",  "BAM11", "BAM16", "BAM18". Again, this factor can best be termed responsible use of medicines. 


<<bam2bfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact3,label="tab:bam2bfact3cor", caption="Factor Correlations, Three Factor Solution, Beliefs About Medicine Questionnaire, TCQ2, Split B"))
@ 

Again, Table \ref{tab:bam2bfact3cor} shows that two of the factors are somewhat correlated, but the third is not.

\paragraph{Four Factor Solution}
\label{sec:four-factor-solution}



<<bam2bfact4, echo=FALSE, results=tex>>=
bam2b.fact4 <- fa(na.omit(bamall2b), 4, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact4, names=c("BAM1", "BAM2", "BAM3", "BAM4"), label="tab:bam2bfact4", caption="Four Factor Solution, Beliefs About Medicine Questionnaire, TCQ 2, Split B"))
@ 

The four factor structure is shown in Table \ref{tab:bam2bfact4}. 


PA3: "BAM12", "BAM13", "BAM14", "BAM17". These items almost all relate to doctors and medicine, and so this factor is termed Doctors and Medicine. 

PA4: "BAM3",  "BAM4",  "BAM6",  "BAM7",  "BAM10", "BAM11", "BAM15". These items have clustered together in almost all the solutions, and again are termed  Avoidance of Medicines.

PA2: "BAM1",  "BAM2",  "BAM5",  "BAM16", "BAM18". Again, these items have tended to cluster together, and can best be termed as Responsible Use of Medicines. 

PA1: "BAM6",  "BAM8",  "BAM9",  "BAM18". These items all relate to safety or danger of medicines, and thus this factor will be termed Medicine Safety.



<<bam2bfact4cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact4,label="tab:bam2bfact4cor", caption="Factor Correlations, Beliefs About Medicine Questionnaire Four Factor Solution, TCQ 2, Split B"))
@ 

As before, Table \ref{tab:bam2afact4cor} shows large correlations between factors all of the factors save 3, which appears to be relatively uncorrelated with all of the other factors. 

\paragraph{Five Factor Solution}
\label{sec:five-factor-solution}



<<bam2bfact5, echo=FALSE, results=tex>>=
bam2b.fact5 <- fa(na.omit(bamall2b), 5, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact5, names=c("BAM1", "BAM2", "BAM3", "BAM4", "BAM5"), label="tab:bam2bfact5", caption="Five Factor Solution, Beliefs About Medicine Questionnaire, TCQ 2, Split B"))
@ 

Table \ref{tab:bam2bfact5} shows the five factor solution for the Beliefs About Medicine Questionnaire. 

PA3: "BAM13", "BAM14", "BAM17". Again, these items can best be subsumed as a factor called Doctors and Medicines. 

PA4: "BAM3",  "BAM4",  "BAM6",  "BAM7",  "BAM10", "BAM11", "BAM15". Again, this factor can best be termed Medicine Avoidance. 

PA2:"BAM2", "BAM5". These items relate to the best way in which to take medicines, and can thus be termed Effective Medicine Usage.

PA1: "BAM6",  "BAM11", "BAM18". These items all relate to the safety of medicines and thus this factor can be termed Safety and Medicines. 

PA5: "BAM8",  "BAM9",  "BAM15". These items relate to the dangers associated with medicines, and thus the factor can best be termed Danger and Medicines. 

<<bam2bfact5cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact5,label="tab:bam2bfact5cor", caption="Factor Correlations, Beliefs About Medicine Five Factor Solution, TCQ 2, Split B"))
@ 

As can be seen from Table \ref{tab:bam2bfact5cor}, all of the factors are moderately correlated with one another. 


\begin{figure}
	\centering
<<tcq2cparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
tcq2c.para <- fa.parallel(na.omit(tcqall2c))
tcq2c.vss <- VSS(na.omit(tcqall2c))
sink(NULL)
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split C)}
	\label{fig:tcq2cparallel}
\end{figure}

Figure \ref{fig:tcq2cparallel} shows the results of parallel analysis on Split C for the Treatment Credibility Questionnaire. 

The below were the results of a varimax rotation on Split C. 
% PA2:"Pill1"  "Pill2"  "Pill3"  "Pill4"  "Pill5"  "Pill6"  "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6" "Inj1"   "Inj2"   "Inj3"   "Inj4"   "Inj5"   "Inj6". This factor consists of extremely high loadings on the Pill and Injection items, and moderate ($0.3-0.4$) loadings on the Cream items. It can therefore best be referred to as the Conventional treatments factors.

% PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6" "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". This factor appears to have small loadings on all of the alternative items, pointing towards this factor representing variance all these items had in common. This factor is therefore termed Alternative Treatments. 

% PA5: "Hom1" "Hom3" "Hom4" "Hom5" "Hom6" "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". This factor consists of moderate loadings on Homeopathy and large loadings on Reiki. This factor can probably best be termed Reiki and Alterntative Treatments. 

% PA3: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This factor maps exactly to the Acupuncture items and so retains that name. 

% PA4: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". This factor again maps exactly to the Creams items, and is therefore termed Cream. This factor solution was from a varimax rotation, note the interesting differences between it and the others. 


Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 

\subsubsection{Beliefs About Medicine Questionnaire}
\label{sec:beli-about-medic}


\begin{figure}
<<bam2cparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
bam2c.para <- fa.parallel(na.omit(bamall2c))
bam2c.vss <- VSS(na.omit(bamall2c))
sink(NULL)
@   
  \caption{Parallel Analysis and VSS Criteria for Beliefs About Medicine Scale, Split C}
  \label{fig:bam2cparallel}
\end{figure}


The parallel analysis criterion suggests three factors here, while the MAP criterion suggests one, previous practice will be followed and the solutions with one, two and three factors will be extracted and examined. 

\paragraph{One Factor Solution}
\label{sec:one-factor-solution}



<<bam2cfact1, echo=FALSE, results=tex>>=
bam2c.fact1 <- fa(na.omit(bamall2c), 1, fm="pa")
print(FactorXtab(bam2c.fact1, names=c("BAM1"),label="tab:bam2cfact1", caption="One Factor Solution, Beliefs About Medicine Questionnaire, TCQ2, Split C"))
@ 

The loadings and communalities are uniformly low (shown in Table \ref{tab:bam2cfact1} for this solution, and ther proportion of variance explained was 20\%. 

\paragraph{Two Factor Solution}
\label{sec:two-factor-solution}


<<bam2cfact2, echo=FALSE, results=tex>>=
bam2c.fact2 <- fa(na.omit(bamall2c), 2, rotate="oblimin", fm="pa")
                                                  print(FactorXtab(bam2c.fact2,names=c("BAM1", "BAM2"), label="tab:bam2cfact2", caption="Two factor Solution, Beliefs About Medicine Questionnaire, TCQ2, Split C"))
@ 
As can be seen from Table \ref{tab:bam2cfact2} the listings of items which loaded on factors below, some of the items did not load on any factor, which is normally an indicator of a poor factor solution. 


PA1: "BAM2",  "BAM6",  "BAM8",  "BAM9",  "BAM10", "BAM13", "BAM14", "BAM17", "BAM18". All of these items appear to relate to the problems with medications, suggesting that this factor should be termed Medication Avoidance. 

PA2: "BAM2",  "BAM3",  "BAM7",  "BAM10", "BAM11", "BAM16". These items all appear to relate to the safe use of medicines, and so this factor is termed Safe Use of Medicines. 

<<bam2cfact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2c.fact2,label="tab:bam2cfact2cor", caption="Factor Correlations, Two Factor Solution, Beliefs About Medicine Questionnaire, Split C"))
@ 

As can be seen from Table \ref{tab:bam2cfact2cor}, the two factors are moderately correlated, in contrast to Split B ( Table \ref{tab:bam2bfact2cor}), but like Split A (Table \ref{tab:bam2afact2cor}). 

<<bam2cfact3, echo=FALSE, results=tex>>=
bam2c.fact3 <- fa(na.omit(bamall2c), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2c.fact3, names=c("BAM1", "BAM2", "BAM3"), label="tab:bam2cfact3", caption="Three Factor Solution, Beliefs About Medicine Questionnaire, TCQ2, Split C"))
@ 

Table \ref{tab:bam2cfact3} shows the structure of the three factor solution in this split. 


PA1: "BAM13", "BAM14", "BAM17". All of these items relate to doctors and so this factor can best be termed Doctors and Medicines. 

PA3: "BAM3",  "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM10", "BAM18". All these items appear to relate to the safety of medicines, and so this factor is named thusly. 

PA2: "BAM2",  "BAM3",  "BAM11", "BAM16". These items refer to different types of medicines, and so this factor is termed Specific Use of Medicines. 

<<bam2cfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2c.fact3,label="tab:bam2cfact3cor", caption="Factor Correlations, Three Factor Solution, Beliefs About Medicine Questionnaire, Split C"))
@ 

The correlations shown in Table \ref{tab:bam2cfact3cor} are quite similiar to those found in the other three factor solutions, with two of the factors having moderate correlations while a third is not really correlated with this pair. 

\begin{figure}
	\centering
<<tcq2dparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
par(mfrow=c(1,2))
tcq2d.para <- fa.parallel(na.omit(tcqall2d))
tcq2d.vss <- VSS(na.omit(tcqall2d))
sink(NULL)
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split D)}
	\label{fig:tcq2dparallel}
\end{figure}

\subsubsection{Beliefs About Medicine Questionnaire, Split D}
\label{sec:beli-about-medic}



Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 

\begin{figure}
<<bam2dparallel, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
sink("tmp.txt")
bam2d.para <- fa.parallel(na.omit(bamall2d))
bam2d.vss <- VSS(na.omit(bamall2d))
sink(NULL)
@   
  \caption{Parallel Analysis Scree Plot for Beliefs About Medicine Questionnaire, Split D}
  \label{fig:bam2dparallel}
\end{figure}


The parallel analysis criterion suggests three factors here (shown in Figure \ref{fig:bam2dparallel}, while the MAP criterion suggests one, previous practice will be followed and the solutions with one, two and three factors will be extracted and examined. 

\paragraph{One Factor Solution}
\label{sec:one-factor-solution}



<<bam2dfact1, echo=FALSE, results=tex>>=
bam2d.fact1 <- fa(na.omit(bamall2d), 1, fm="pa")
print(FactorXtab(bam2d.fact1, names=c("BAM1"), label="tab:bam2dfact1",caption="One Factor Solution, Beliefs About Medicine Questionnaire, TCQ 2 Split D"))
@ 

As can be seen from Table \ref{tab:bam2dfact1}, the factor solution has a number of items (5, 11, 12, 15 \& 16) which do not load on it. This solution explained about 21\% of the variance which is quite poor, though in line with what we have seen in other splits for a one factor solution.  

\paragraph{Two Factor Solution}
\label{sec:two-factor-solution}



<<bam2dfact2, echo=FALSE, results=tex>>=
bam2d.fact2 <- fa(na.omit(bamall2d), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2d.fact2,names=c("BAM1", "BAM2"), label="tab:bam2dfact2", caption="Two Factor Solution, Beliefs About Medicine Questionnaire, Split D"))
@ 

Table \ref{tab:bam2dfact2} shows the coefficients for the two factor solution in Split D. 

PA2: "BAM3",  "BAM4",  "BAM6",  "BAM7",  "BAM8",  "BAM9",  "BAM10", "BAM11", "BAM18". These items all relate to the dangers surrounding medicines, and reasons to avoid using them, and so this factor can best be termed Safe use of Medicines. 

PA1: "BAM2",  "BAM6",  "BAM13", "BAM14", "BAM17". Most of these items relate to doctors and their use of medicines, and so this factor can best be termed Doctors and Medicines. 

<<bam2dfact2dcor, echo=FALSE, results=tex>>=
print(FactorCor(bam2d.fact2, label="tab:bam2dfact2dcor", caption="Factor Correlations Two Factor Solution, Beliefs About Medicine Questionnaire, Split D"))
@ 

It can be seen from Table \ref{tab:bam2dfact2dcor} that the two factors are moderately correlated, similarly to the previous splits. 


\paragraph{Three Factor Solution}
\label{sec:three-fact-solut}





<<bam2dfact3, echo=FALSE, results=tex>>=
bam2d.fact3 <- fa(na.omit(bamall2d), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2d.fact3, names=c("BAM1", "BAM2", "BAM3"), label="tab:bam2dfact3", caption="Three Factor Solution, Beliefs About Medicine Questionnaire, Split D"))
@ 

Table \ref{tab:bam2dfact3} shows the structure of the three factor solution in Split D. 

PA1: "BAM2",  "BAM13", "BAM14", "BAM17". Most of these items relate to doctors, and so this factor can best be termed Doctors and Medicines. 

PA3: "BAM1",  "BAM3",  "BAM6",  "BAM8",  "BAM18". These items all relate to the dangers surrounding medicines, and so this factor can best be termed Dangers of Medicines. 

PA2: "BAM7",  "BAM9",  "BAM10", "BAM11". These items all appear to relate to the dangers and avoidance of medicines, and so this factor can best be termed avoidance of medicines. 


<<bam2dfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2d.fact3, label="tab:bam2dfact3cor", caption="Factor Correlations, Three factor solution, Beliefs About Medicine, Questionnaire, Split D"))
@ 

It can be seen from Table \ref{tab:bam2dfact3cor} that all of the factors correlate moderately with one another, supporting the use of oblique rotations for this split. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split A will be tested on the out of sample data. 

<<bam1notAsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,9,10,12,13,14,17), sep="")
bamnoload <- paste(Bam, c(1,2,5,8,11,15,16, 18), sep="")
Bam1modelnotA<- mxModel(name="Bam1notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam1fitnotA <- mxRun(Bam1modelnotA)
Bam2asumm1 <- summary(Bam1fitnotA)
@ 

<<bam2notAsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Natural Remedies" )
medavoid <- paste(Bam, c(1,6,7,9,12,13,14,17,18), sep="")
natrem <- paste(Bam, c(2,7,10,11), sep="")
bamnoload <- paste(Bam, c(3,4,5,8,15,16), sep="")
Bam2modelnotA<- mxModel(name="Bam2notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Natural Remedies", to=natrem),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam2fitnotA <- mxRun(Bam2modelnotA)
Bam2asummnotA <- summary(Bam2fitnotA)
@ 


<<bam3notAsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safer Medicines","Responsible Use of Medicines"  )
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
safemed <- paste(Bam, c(1,3,4,10), sep="")
respmed <- paste(Bam, c(1,2,7,10,11), sep="")
bamnoload <- paste(Bam, c(5,15,16), sep="")
Bam3modelnotA<- mxModel(name="Bam3notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam3fitnotA <- mxRun(Bam3modelnotA)
Bam3asummnotA <- summary(Bam3fitnotA)
@ 


<<bam4notAsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotA<- mxModel(name="Bam4notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam4fitnotA <- mxRun(Bam4modelnotA)
Bam4asummnotA <- summary(Bam4fitnotA)
@ 

<<bamnotAsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notA <- mxCompare(Bam1fitnotA, c(Bam2fitnotA, Bam3fitnotA, Bam4fitnotA))
print(xtable(bamsemcompare.notA, label="tab:bamnotAsemcompare", captio="Comparison of Beliefs About Medicine Factor Solutions from Split A Tested on Splits B, C and D"))
@ 

As can be seen from Table \ref{tab:bamnotAsemcompare}, the four factor solution appears to replicate best on the out of sample data. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split B will be tested on the out of sample data (that is, Splits A, C and D). 

<<bam1notBsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotB<- mxModel(name="Bam1notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=512))
Bam1fitnotB <- mxRun(Bam1modelnotB)
Bam1asumm.notB <- summary(Bam1fitnotB)
@ 

<<bam2notBsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Responsible Use of Medicines")
medavoid <- paste(Bam, c(3,4,6,7,8,9,10,11,12,13,14,17,18), sep="")
respmed <- paste(Bam, c(1,2,11,16,18), sep="")
bamnoload <- paste(Bam, c(5,15), sep="")
Bam2modelnotB <- mxModel(name="Bam2notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=512))
Bam2fitnotB <- mxRun(Bam2modelnotB)
Bam2asummnotB <- summary(Bam2fitnotB)
@ 


<<bam3notBsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safer Medicines","Responsible Use of Medicines"  )
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
safemed <- paste(Bam, c(1,3,4,10), sep="")
respmed <- paste(Bam, c(1,2,7,10,11), sep="")
bamnoload <- paste(Bam, c(5,15,16), sep="")
Bam3modelnotB<- mxModel(name="Bam3notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=524))
Bam3fitnotB <- mxRun(Bam3modelnotB)
Bam3asummnotB <- summary(Bam3fitnotB)
@ 


<<bam4notBsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotB<- mxModel(name="Bam4notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=524))
Bam4fitnotB <- mxRun(Bam4modelnotB)
Bam4asummnotB <- summary(Bam4fitnotB)
@ 

<<bamnotBsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notB <- mxCompare(Bam1fitnotB, c(Bam2fitnotB, Bam3fitnotB, Bam4fitnotB))
print(xtable(bamsemcompare.notB, label="tab:bamnotBsemcompare", caption="Beliefs About Medicine Questionnaire Split B Models Tested Against Splits A, C and D"))
@ 

It can be seen from Table \ref{tab:bamnotBsemcompare} that the two factor model provided the best fit to the out-of-sample data in  this case. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split B will be tested on the out of sample data (that is, Splits A, C and D). 

<<bam1notCsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotC<- mxModel(name="Bam1notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=512))
Bam1fitnotC <- mxRun(Bam1modelnotC)
Bam1asumm.notC <- summary(Bam1fitnotC)
@ 

<<bam2notCsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safe Use of Medicines")
medavoid <- paste(Bam, c(2,6,8,9,10,13,14,17,18), sep="")
safemed <- paste(Bam, c(2,3,7,10,11,16), sep="")
bamnoload <- paste(Bam, c(1,4,5,12,15), sep="")
Bam2modelnotC <- mxModel(name="Bam2notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safe Use of Medicines", to=safemed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=512))
Bam2fitnotC <- mxRun(Bam2modelnotC)
Bam2asummnotC <- summary(Bam2fitnotC)
@ 


<<bam3notCsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Safer Medicines","Specific Use of Medicines")
docmed <- paste(Bam, c(13,14,17), sep="")
safemed <- paste(Bam, c(3,6,7,8,9,10,18), sep="")
specmed <- paste(Bam, c(2,3,11,16), sep="")
bamnoload <- paste(Bam, c(1,4,5,12,15), sep="")
Bam3modelnotC<- mxModel(name="Bam3notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=docmed),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Specific Use of Medicines", to=specmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=524))
Bam3fitnotC <- mxRun(Bam3modelnotC)
Bam3asummnotC <- summary(Bam3fitnotC)
@ 


<<bamnotCsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notC <- mxCompare(Bam1fitnotC, c(Bam2fitnotC, Bam3fitnotC))
print(xtable(bamsemcompare.notC, label="tab:bamnotCsemcompare", caption="Beliefs About Medicine Questionnaire Models from Split C tested against Splits A, B and D"))
@ 

It can be seen from Table \ref{tab:bamnotCsemcompare} that the one factor solution fits the out of sample data best in this case. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split D will be tested on the out of sample data (that is, Splits A, B and C). 

<<bam1notDsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(1,2,3,4,6,7,8,9,10,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(5,11,12,15,16), sep="")
Bam1modelnotD<- mxModel(name="Bam1notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=512))
Bam1fitnotD <- mxRun(Bam1modelnotD)
Bam1asumm.notD <- summary(Bam1fitnotD)
@ 

<<bam2notDsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Safe Use of Medicines")
safemed <- paste(Bam, c(3,4,6,8,9,10,11), sep="")
docmed <- paste(Bam, c(2,6,13,14,17), sep="")
bamnoload <- paste(Bam, c(1,5,7,12,15,16), sep="")
Bam2modelnotD <- mxModel(name="Bam2notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=medavoid),
                      mxPath(from="Safe Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=512))
Bam2fitnotD <- mxRun(Bam2modelnotD)
Bam2asummnotD <- summary(Bam2fitnotD)
@ 


<<bam3notDsem, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Dangers of Medicines","Avoidance of Medicines")
docmed <- paste(Bam, c(2,13,14,17), sep="")
dangermed <- paste(Bam, c(1,3,6,8,18), sep="")
medavoid <- paste(Bam, c(7,9,10,11), sep="")
bamnoload <- paste(Bam, c(4,5,7,12,15,16), sep="")
Bam3modelnotD<- mxModel(name="Bam3notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=docmed),
                      mxPath(from="Dangers of Medicines", to=dangermed),
                        mxPath(from="Avoidance of Medicines", to=medavoid),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=524))
Bam3fitnotD <- mxRun(Bam3modelnotD)
Bam3asummnotD <- summary(Bam3fitnotD)
@ 


<<bamnotDsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notD <- mxCompare(Bam1fitnotD, c(Bam2fitnotD, Bam3fitnotD))
print(xtable(bamsemcompare.notD, label="tab:bamnotDsemcompare", caption="Beliefs About Medicine Questionnaire Models from Split D, tested against Splits A, B and C"))
@ 

It can be seen from Table \ref{tab:bamnotDsemcompare} that the one factor solution fits the out of sample data best in the case of the Split D models tested on the out of sample data. 

<<bam4notAsemAll, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotA.all<- mxModel(name="Bam4notAAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam4fitnotA.all <- mxRun(Bam4modelnotA.all)
Bam4asummnotA.all <- summary(Bam4fitnotA.all)
@ 

<<bam2notBsemAll, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Responsible Use of Medicines")
medavoid <- paste(Bam, c(3,4,6,7,8,9,10,11,12,13,14,17,18), sep="")
respmed <- paste(Bam, c(1,2,11,16,18), sep="")
bamnoload <- paste(Bam, c(5,15), sep="")
Bam2modelnotB.all <- mxModel(name="Bam2notBAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam2fitnotB.all <- mxRun(Bam2modelnotB.all)
Bam2asummnotB.all <- summary(Bam2fitnotB.all)
@ 

<<bam1notCsemAll, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotC.all<- mxModel(name="Bam1notCAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam1fitnotC.all <- mxRun(Bam1modelnotC.all)
Bam1asumm.notC.all <- summary(Bam1fitnotC.all)
@ 

<<bam1notDsemAll, echo=FALSE, results=hide, cache=TRUE>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(1,2,3,4,6,7,8,9,10,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(5,11,12,15,16), sep="")
Bam1modelnotD.all<- mxModel(name="Bam1notDAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=671))
Bam1fitnotD.all <- mxRun(Bam1modelnotD.all)
Bam1asumm.notD.all <- summary(Bam1fitnotD.all)
@

<<bamallsemcompare, echo=FALSE, results=tex>>=
bamall.semcompare <- mxCompare(Bam4fitnotA.all, c(Bam2fitnotB.all, Bam1fitnotC.all, Bam1fitnotD.all))
print(xtable(bamall.semcompare, label="tab:bamallsemcompare", caption="Best Model from Each Split tested against one another on the full dataset, Beliefs About Medicine Questionnaire"))
@ 

As can be seen from Table \ref{tab:bamallsemcompare}, the two factor model from Split B provided the best fit to all of the data, striking a balance between the complexity of the four factor model and the over simplicity of the one factor model. 

Next, the beliefs about medicine questionnaire was examined in terms of item response theory.

<<bam2ascales, echo=FALSE, results=tex>>=
bam2a.scales <- aisp(na.omit(bamall2a))
print(xtable(bam2a.scales, label="tab:bam2ascales", caption=" Item Scale Analysis  for Beliefs About Medicine Questionnaire, IRT scale, Split A"))
@ 

It can be seen from Table ~\ref{tab:bam2ascales} that many items on the beliefs about medicine questionnaire do not appear to be part of any scale (indicated by the zeros next to the item number). The algorithm suggests that there are two scales.

The first is made up of BAM6, BAM7, BAM9, BAM13, BAM14 and BAM17.
The second is made up of BAM4 and BAM10. This second scale appears to be less than useful, as some of the other tests of assumptions require at least three items per scale. The approach taken here will be to eliminate all but the first scale and conduct our analyses on that set of six items.

<<bam2areduce, echo=FALSE, results=hide, cache=TRUE>>=
bam2ascale <- bamall2a[,c("BAM6","BAM7","BAM9","BAM13","BAM14","BAM17")]
## bam2ascale.other <- bamall2a[,!c("BAM6","BAM7","BAM9","BAM13","BAM14","BAM17")]
@ 

The next step is to check the assumption of invariant item ordering. This is less important here, but is checked for the sake of completeness. 

<<bam2aiio, echo=FALSE, results=tex>>=
bam2a.iio <- check.iio(na.omit(bam2ascale))
print(xtable(bam2a.iio$violations, label="tab:bam2aiio", caption="Item Ordering Assumption Check for Reduced Beliefs About Medicine Questionnaire, Split A"))
@ 

As can be seen from Table ~\ref{tab:bam2aiio}, no items violated the invariant item ordering assumption, and so are are retained until the next stage. The next step is to check the assumption of monotonicity.

<<bam2acheckmono, echo=FALSE, results=tex>>=
bam2a.mono <- check.monotonicity(na.omit(bam2ascale))
print(xtable(summary(bam2a.mono), label="tab:bam2amono", caption="Monotonicity Check, Beliefs About Medicine Questionnaire, Split A"))
@ 

Table \ref{tab:bam2amono} shows that there were no violations of monotonicity in this split for the reduced set of items. 

The next step in our analysis plan is to fit a rasch model to the beliefs about medicine scale. 

<<bam2agpcm, echo=FALSE, results=hide, cache=TRUE>>=
bam2a.gpcm.rasch <- gpcm(bam2ascale, constraint="rasch")
bam2a.gpcm.1PL <- gpcm(bam2ascale, constraint="1PL")
bam2a.gpcm.gpcm <- gpcm(bam2ascale, constraint="gpcm")
@ 

<<bam2arasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2a.gpcm.rasch)), label="tab:bam2arasch", caption="Coefficients for Beliefs About Medicine Questionnaire, Rasch partial credit model"))
@ 

As can be seen from Table ~\ref{tab:bam2arasch}, this model shows problems typical to the PCM of the middle category having a lower estimated ability threshold than do the categories to either side. Nonetheless, it can be seen that BAM9, ``It is better to do without medicines'' has the highest thresholds, followed by 17, ``Doctors use too many medicines'', which makes sense as these questions are more absolutist than many of the others. 

We next examine the fit of a one paramater generalised partial credit model with a discrimination parameter estimated from the data. 

<<bam2a1PL, echo=FALSE, results=tex>>=

print(xtable(coef2mat(coef(bam2a.gpcm.1PL)), label="tab:bam2a1PL", caption="Coefficients for Beliefs About Medicine Questionnaire, One parameter Generalised Partial Credit Model"))
@ 

Again, Table \ref{tab:bam2a1PL} makes it very clear that the one parameter GPCM provides little advantage over the Rasch model, in that the estimated difficulties are very similar and the discrimination parameter has not moved very much. 

Next, the fit of a two parameter GPCM to this scale was examined. 

<<bam2agpcm, echo=FALSE, results=tex>>=

print(xtable(coef2mat(coef(bam2a.gpcm.gpcm)), label="tab:bam2agpcm", caption="Coefficients for Beliefs About Medicine Questionnaire, Split A, Two Parameter Generalised Partial Credit Model"))
@ 
It can be clearly seen from Table ~\ref{tab:bam2agpcm} that the two parameter GPCM provides a more interesting picture. Again, 7 is the most difficult, but has a very low discrimination parameter, suggesting that it is relatively poor at clustering high and low scorers on the scale. However, 17 has lowered its difficulties, but shows much better discrimination. 

In line with previous practice, the next models fit were the one and two parameter graded response models. 

<<bam2agrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2a.grm.1pl <- grm(na.omit(bam2ascale), constrained=TRUE)
bam2a.grm.2pl <- grm(na.omit(bam2ascale), constrained=FALSE, Hessian=TRUE)
@ 

<<bam2agrm1pl, echo=FALSE, results=tex>>=

bam2acoef.mat <- coef2mat(coef(bam2a.grm.1pl))
print(xtable(bam2acoef.mat, label="tab:bam2agrm1pl", caption="Coefficients for Beliefs About Medicine Questionnaire, Split A, One parameter Graded Response Model"))
@ 

It can be seen from Table \ref{tab:bam2agrm1pl} that the fit of this model is much better that the fit of any of the partial credit models. 

The next step is to fit a two parameter GRM, and examine the differences in fit between the two models. 

<<bam2agrm2pl, echo=FALSE, results=tex>>=

bam2acoef.mat <- coef2mat(coef(bam2a.grm.2pl))
print(xtable(bam2acoef.mat, label="tab:bam2agrm2pl", caption="Coefficients for Beliefs About Medicine Questionnaire, Split A, Two parameter Graded Response Model"))
@ 

It can be seen from Table \ref{tab:bam2agrm2pl} that this model reveals some interesting features of the items. BAM13 and BAM17 have the highest discrimination parameters, but the ability estimates of their extremities have moved down to compensate. 

A likelihood ratio test carried out between the two models suggested that the two parameter model was significantly better than the one parameter model, ($p\le 0.001$). Again, this is a tentative result until the performance of the model on new data is examined. In any case, while both the AIC and the LR test favoured the two parameter model, the BIC was lower for the one parameter model indicating that according to this criterion, the one parameter model was superior. 

Next, the performance of all the Beliefs About Medicine Models was assessed on unseen data (Splits B, C and D). 

<<bampcmtest, echo=FALSE, results=tex, cache=TRUE>>=
bamnota.irt <-  tcq2nota[,c("BAM6","BAM7","BAM9","BAM13","BAM14","BAM17")]
bam2a.pcm.rasch.done <- testIRTModels(bam2a.gpcm.rasch, bamnota.irt, gpcmconstraint="rasch", grmconstraint=NULL)
bam2a.pcm.1pl.done <- testIRTModels(bam2a.gpcm.1PL, bamnota.irt, gpcmconstraint="1PL", grmconstraint=NULL)
bam2a.pcm.gpcm.done <- testIRTModels(bam2a.gpcm.gpcm, bamnota.irt, gpcmconstraint="gpcm", grmconstraint=NULL)
bam2a.pcm.modcomp <- rbind(bam2a.pcm.rasch.done, bam2a.pcm.1pl.done, bam2a.pcm.gpcm.done)
rownames(bam2a.pcm.modcomp) <- c("Rasch PCM", "One Parameter PCM", "Two Parameter PCM")

@ 
<<bam2apcmmodcompprint, echo=FALSE, results=tex>>=
bam2a.pcm.modcomp.xtab <- xtable(bam2a.pcm.modcomp, caption="Partial Credit Models for BAM Scale from Split A Performance on Heldout Data", label="tab:bam2apcmmodcomp")
print(bam2a.pcm.modcomp.xtab)
@ 
From Table \ref{tab:bam2apcmmodcomp} it can be seen that the rasch model provided the best performance on unseen data. 

Next, the performance of the graded response models on unseen  data was assessed. 

<<bam2agrmtest, echo=FALSE, results=tex, cache=TRUE>>=
## bam2a.test <- bamnota.irt[,2:length(bamnota.irt)]
## bam2a.grm.1pl.done <- testIRTModels(bam2a.grm.1pl, bam2a.test)
@ 
%fix split A levels problem

The same model fitting procedure will now be repeated for the Beliefs About Medicine Questionnaire in this split. 

<<bam2baisp, echo=FALSE, results=tex>>=
bam2b.aisp <- aisp(na.omit(bamall2b))
print(xtable(bam2b.aisp, label="tab:bam2baisp", caption="Item Selection Procedure for Beliefs About Medicine Questionnaire, Split B"))
@ 

As shown in Table \ref{tab:bam2baisp}, some items do not load on any scales, and there is one two item scale (BAM1 and BAM2), along with one larger scale. As two items are not enough to form a useful scale, the larger scale will be the only one which is analysed. 

The scale that will be analysed consists of BAM3, BAM4, BAM6, BAM9, BAM10, BAM11, BAM13, BAM14 and BAM17. This is a larger scale than was observed with Split A. 

<<bamscale2b,echo=FALSE, results=hide>>=
bamscale2b <- bamall2b[,c("BAM3","BAM4","BAM6","BAM9","BAM10","BAM11","BAM13","BAM14", "BAM17")]
@ 

The first step is to examine the invariant item ordering assumption.

<<bam2checkiio, echo=FALSE, results=tex>>=
bam2b.iio <- check.iio(na.omit(bamscale2b))
print(xtable(bam2b.iio$violations, label="tab:bam2checkiio", caption="Item Ordering Assumption Check for Beliefs About Medicine Scale, Split B"))
@ 

In line with the results of Split A, no items were in violation of this assumption. 

The next assumption which needs to be checked is the monotonicity assumption. 

<<bam2bcheckmono, echo=FALSE, results=tex>>=
bam2b.mono <- check.monotonicity(na.omit(bamscale2b))
print(xtable(summary(bam2b.mono), label="tab:bam2bcheckmono", caption="Monotonicity Check, Beliefs About Medicine Scale, Split B"))
@ 

Table \ref{tab:bam2bcheckmono} shows clearly that there were no violations of the monotonicity assumption in this sample. 

The final preliminary model check consists of a plot displaying the number of Guttman errors for each participant.
\begin{figure}
<<bam2bguttman, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
bam2b.guttman <- check.errors(na.omit(bamscale2b))
bam2b.guttplot <- ggplot(as.data.frame(bam2b.guttman), aes(x=bam2b.guttman))+geom_histogram(binwidth=2)
print(bam2b.guttplot)
@   
  \caption{Plot of Guttman errors for Beliefs about Medicine Scale, Split B}
  \label{fig:bam2bguttmanplot}
\end{figure}

As can be seen from Figure \ref{fig:bam2bguttmanplot}, the number of guttman errors was much higher for this scale than was observed in the previous split. This suggests that some of the respondents were not answering the questions in a consistent fashion, and will be investigated further when the person fit statistics are examined on a per model basis. 

The first step in modelling the Beliefs about Medicines questionnaire is to attempt to fit a Rasch partial credit model.

<<bam2bgpcm, echo=FALSE, results=hide, cache=TRUE>>=
bam2b.gpcm.rasch <- gpcm(bamscale2b, constraint="rasch")
bam2b.gpcm.1PL <- gpcm(bamscale2b, constraint="1PL")
bam2b.gpcm.gpcm <- gpcm(bamscale2b, constraint="gpcm")
@ 





The estimated parameters for the Rasch model are shown  in Table \ref{tab:bam2bgpcmrasch}. 


<<bam2bgpcmrasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.gpcm.rasch)), label="tab:bam2bgpcmrasch", caption="Coefficients for Beliefs About Medicine Questionnaire, Split B, Rasch generalised Partial Credit Model"))
@ 

It can be seen from Table \ref{tab:bam2bgpcmrasch} that the Rasch PCM has thresholds in line with those of the conventional item TCQ, and that Q6 is regarded as the most difficult, which is not surprising given the content of the item ``Medicines often do more harm than good''. 

Next, the coefficients are examined for a one parameter PCM on this scale. 


<<bam2bgpcm1pl, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.gpcm.1PL)), label="tab:bam2bgpcm1pl", caption="Coefficients for Beliefs About Medicine Questionnaire, Split B, One Parameter Generalised Partial Credit Model"))
@ 

Table \ref{tab:bam2bgpcm1pl} shows the estimated coefficients for this model. It can be seen that there are no major changes from the Rasch model, the discrimination parameter has lowered, but the ability thresholds have risen slightly, most noticeably in the case of BAM6. 


Finally, the fit of a two parameter PCM was examined.

<<bam2bgpcmgpcm, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.gpcm.gpcm)), label="tab:bam2bgpcm2pl", caption="Coefficients for Beliefs About Medicine Questionnaire, Split B, Two Parameter Generalised Partial Credit Model"))
@ 

Table \re{tab:bam2bgpcm2pl} shows the results of this fit. It can be seen that the discrimination parameters of items 6, 13,14 and 17 have markedly increased, while those of the other items have lowered slightly. 

The next step in the process of modelling was to fit one and two parameter Graded Response Models. 

<<bam2bgrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2b.grm.1pl <- grm(bamscale2b, constrained=TRUE)
bam2b.grm.2pl <- grm(bamscale2b, constrained=FALSE)
@ 

<<bam2bgrm1sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.grm.1pl)), label="tab:bam2bgrm1sum", caption="Coefficients for Beliefs About Medicine Questionnaire, Split B, One Parameter Graded Response Model"))
@ 

Table \ref{tab:bam2bgrm1sum} shows no signs of problems with monotonicity, and the fit appears acceptable. Next, the two parameter GRM was examined.

<<bam2bgrm2sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.grm.2pl)), label="tab:bam2bgrm2sum", caption="Coefficients for Beliefs About Medicine Questionnaire, Two parameter Graded Response Model"))
@ 

Table \ref{tab:bam2bgrm2sum} shows that the fit of the two parameter model is equally unproblematic. 

<<bam2banovagrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2bgrm.anova <- anova(bam2b.grm.1pl, bam2b.grm.2pl)
@ 

A likelihood ratio test suggests that the two parameter model provides a significantly better fit ($p \le 0.001$) than does the one parameter model. 


Finally, the performance of each of the different types of IRT models on unseen data was assessed. 

<<bam2bpcmmodtest, echo=FALSE, results=tex, cache=TRUE>>=
bamnotb.irt <- tcq2notb[,c("BAM3", "BAM4", "BAM6", "BAM9", "BAM10", "BAM11", "BAM13", "BAM14", "BAM17")]
bam2b.gpcm.rasch.done <- testIRTModels(bam2b.gpcm.rasch,  bamnotb.irt, gpcmconstraint="rasch", grmconstraint=NULL)
bam2b.gpcm.1PL.done <- testIRTModels(bam2b.gpcm.1PL, bamnotb.irt, gpcmconstraint="1PL", grmconstraint=NULL)
bam2b.gpcm.gpcm.done <- testIRTModels(bam2b.gpcm.gpcm, bamnotb.irt, gpcmconstraint="gpcm", grmconstraint=NULL)
bam2b.gpcm.modcomp <- rbind(bam2b.gpcm.rasch.done, bam2b.gpcm.1PL.done, bam2b.gpcm.gpcm.done)

@ 
<<bam2bgpcmmodcompprint, echo=FALSE, results=tex>>=
bam2b.gpcm.modcomp.xtab <- xtable(bam2b.gpcm.modcomp, caption="Performance of Beliefs About Medicine IRT Scale from Split B on Splits A, C and D", label="tab:bam2bpcmmodcomp")
print(bam2b.gpcm.modcomp.xtab)
@ 
As can be seen from Table \ref{tab:bam2bpcmmodcomp}, the Rasch PCM provided the best performance on unseen data.

Next, the same procedure was applied to the Graded Response Models. 

<<bam2bgrmtest, echo=FALSE, results=tex, cache=TRUE>>=
#bam2b.grm.1pl.done <- testIRTModels(bam2b.grm.1pl, bamnotb.irt, gpcmconstraint=NULL, grmconstraint=TRUE)
@


% figure out what to do with the different response patterns in grade response models 

Next, the beliefs about medicine questionnaire was examined in this split. 

<<bam2caisp, echo=FALSE, results=tex>>=
bam2c.aisp <- aisp(na.omit(bamall2b))
print(xtable(bam2c.aisp, label="tab:bam2caisp", caption="Item Selection Procedure, Beliefs About Medicine Questionnaire, Split C"))
@ 

As seen in previous splits, BAM1 and BAM2 were partitioned into their own scale, and many items did not fit any scale. As a two item scale is too small to examine effectively, all further analyses were carried out on the reduced scale (1). Table \ref{tab:bam2caisp} shows these results. In contrast to Split A, the scale had 9 items, and these were the same items as were selected by the scale splitting algorithm in Split B. 

<<bamscale2c,echo=FALSE, results=hide, cache=TRUE>>=
bamscale2c <- bamall2b[,c("BAM3","BAM4","BAM6","BAM9","BAM10","BAM11","BAM13","BAM14", "BAM17")]
@ 

The first assumption to be checked was the invariant item ordering assumption, and the results are shown in Table \ref{tab:bam2checkiio}. 

<<bam2ccheckiio, echo=FALSE, results=tex>>=
bam2c.iio <- check.iio(na.omit(bamscale2c))
print(xtable(bam2c.iio$violations, label="tab:bam2checkiio", caption="Item Ordering Assumption Check, Beliefs About Medicine Questionnaire, Split C"))
@ 

As can be seen from Table \ref{tab:bam2checkiio}, no items violated this assumption and therefore all of them were retained. 


<<bam2ccheckmono, echo=FALSE, results=tex>>=
bam2c.mono <- check.monotonicity(na.omit(bamscale2c))
print(xtable(summary(bam2c.mono), label="tab:bam2ccheckmono", caption="Monotonicity Check, Beliefs About Medicine Questionnaire, Split C"))
@ 

Following the check of the IIO assumption, the next step in assumption checking was a monotonicity check. The results of this check are shown in Table \ref{tab:bam2ccheckmono}. This shows that no items violated this assumption (though the ItemH coefficients are close to the cutoff of 0.3). 

\begin{figure}
<<bam2cguttman, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
bam2c.guttman <- check.errors(na.omit(bamscale2c))
bam2c.guttplot <- ggplot(as.data.frame(bam2c.guttman), aes(x=bam2c.guttman))+geom_histogram(binwidth=2)
print(bam2c.guttplot)
@   
  \caption{Plot of Guttman errors for Beliefs about Medicine Scale, Split C}
  \label{fig:bam2cguttmanplot}
\end{figure}

Next, the guttman errors in the split were examined and checked across this sample of items. Similiarly to the TCQ items in this split, the level of guttman errors was much higher, with a mode at approximately 10. This is worrying, and needs to be investigated further. 


<<bam2cgpcm, echo=FALSE, results=hide, cache=TRUE>>=
bam2c.gpcm.rasch <- gpcm(bamscale2c, constraint="rasch")
bam2c.gpcm.1PL <- gpcm(bamscale2c, constraint="1PL")
bam2c.gpcm.gpcm <- gpcm(bamscale2c, constraint="gpcm")
@ 

Firstly, three generalised partial credit models were fit (Rasch, one parameter and two parameter). The results are shown below. 


<<bam2cgpcmrasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.gpcm.rasch)), label="tab:bam2cgpcmrasch", caption="Beliefs About Medicine Questionnaire Split C, Rasch generalised partial credit model"))
@ 

Table \ref{tab:bam2cgpcmrasch} shows the coefficient estimates for the Rasch model fitted to the BAM scale. It can be seen that the estimated thresholds are in line with the ranges from the conventional items, while it might have been expected that they would be more along the lines of the alternative items (given the overlap between negativity towards conventional medicines and positivity towards alternative treatments). 
% % . Although the problems of non-monotonic coefficient estimates are less severe than in previous splits, they are still there (BAM9,11, 13, 14, 17). This indicates that the model does not do a good job on this scale. The same problems occurred for both the one parameter and two parameter models, and so these coefficient estimates are not reported.

Next, the fit of a one parameter PCM was examined on this scale.

<<bam2cpcm1plprint, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.gpcm.rasch)), label="tab:bam2cgpcmrasch", caption="Coefficient Estimates for BAM Scale, One Parameter PCM, Split C"))
@ 

Table \ref{tab:bam2cgpcmrasch} shows the estimated coefficients for this model. Interestingly enough, the discrimination parameter has lowered for all of the items. This suggests that these items are less good than would be expected at discriminating between high and low ability participants. 

Finally, the fit of the two parameter PCM was examined on this scale.

<<bam2cgpcmgpcmprint, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.gpcm.gpcm)), label="tab:bam2cgpcmgpcm", caption="Coefficient Estimates, BAM Scale, Two Parameter PCM, Split C"))
@ 

Table \ref{tab:bam2cgpcmgpcm} shows the estimated coefficients for the two parameter PCM. It can be seen that Q6, 14 and 17 are the most discrimination question, and that 3,4, 9 and 10 appear to have been the drivers of the discrimination parameter being below 1 in the one parameter model. 

Next, the fit of one and two parameter graded response models were examined. 

<<bam2cgrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2c.grm.1pl <- grm(bamscale2c, constrained=TRUE)
bam2c.grm.2pl <- grm(bamscale2c, constrained=FALSE)
@ 

<<bam2cgrm1sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.grm.1pl)), label="tab:bam2cgrm1sum", caption="Coefficients for Beliefs About Medicine Questionnaire, One Parameter Graded Response Model (Split C)"))
@ 

Table \ref{tab:bam2cgrm1sum} shows that there are no monotonicity problems with the one parameter GRM. The estimated discrimination parameter is 1.523, and BAM6 appears to be the most difficult item in the scale (as no participants gave the highest response category to it, across all of the splits).




<<bam2cgrm2sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.grm.2pl)), label="tab:bam2cgrm2sum", caption="Coefficients for Beliefs About Medicine Questionnaire, Split C, Two parameter Graded Response Model"))
@ 

Next, the fit of the two parameter  GRM was examined, and is displayed in Table \ref{tab:bam2cgrm2sum}. Note that BAM13 appears to be the most discriminating item, and that BAM3 is the most difficult item (with the exception of BAM6, as noted above). 

<<bam2canovagrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2cgrm.anova <- anova(bam2c.grm.1pl, bam2c.grm.2pl)
@ 

An anova was carried out between the two graded response models, and the LR test showed that the two parameter model was significanly ($p \le 0.001$) better fit than the one parameter model. However, this was contradicted by both the BIC and AIC, which indicated that the one parameter model provided a better fit to the data. 

Next the performance of the IRT models developed was assessed on unseen data. 

<<bam2cpcmtest, echo=FALSE, results=tex, cache=TRUE>>=
bamnotc.irt <- tcq2notc[,c("BAM3", "BAM4", "BAM6",  "BAM9",  "BAM10", "BAM11", "BAM13",  "BAM14", "BAM17")]
bam2c.gpcm.rasch.done <- testIRTModels(bam2c.gpcm.rasch, bamnotc.irt, gpcmconstraint="rasch", grmconstraint=NULL)
bam2c.gpcm.1pl.done <- testIRTModels(bam2c.gpcm.1PL, bamnotc.irt, gpcmconstraint="1PL", grmconstraint=NULL)
bam2c.gpcm.gpcm.done <- testIRTModels(bam2c.gpcm.gpcm, bamnotc.irt, gpcmconstraint="gpcm", grmconstraint=NULL)
bam2c.pcm.modcomp <- rbind(bam2c.gpcm.rasch.done, bam2c.gpcm.1pl.done, bam2c.gpcm.gpcm.done)
rownames(bam2c.pcm.modcomp) <- c("Rasch PCM", "One Parameter PCM", "Two Parameter PCM")

@ 
<<bam2cpcmmodcompprint, echo=FALSE, results=tex>>=
bam2c.gpcm.modcomp.xtab <- xtable(bam2c.pcm.modcomp, caption="Results of BAM Split C Partial Credit Models on Splits A, B and D", label="tab:bam2cpcmmodcomp")
print(bam2c.gpcm.modcomp.xtab)
@ 
As can be seen from Table \ref{tab:bam2cpcmmodcomp}, the Rasch model for the Beliefs About Medicine Questionnaire provided the best fit to unseen data. 

%% Next, we examine the performance of the Graded Response Models on unseen data. 

<<bam2cgrmtest, echo=FALSE, results=tex, eval=FALSE, cache=TRUE>>=
bam2c.grm.1pl.done <- testIRTModels(bam2c.grm.1pl, bamnotc.irt, gpcmconstraint=NULL, grmconstraint=TRUE)
@ 

Next, the assumptions underlying the use of IRT modelling were applied to the Beliefs About Medicine Questionnaire. 

<<bam2daisp, echo=FALSE, results=tex>>=
bam2d.aisp <- aisp(na.omit(bamall2d))
print(xtable(bam2d.aisp, label="tab:bam2daisp", caption="Item Selection Procedure, Beliefs About Medicine Questionnaire, Split D"))
@ 

It can be seen from Table \ref{tab:bam2daisp} that again BAM1 and BAM2 form their own scale, while some of the other items do not appear on any scale. In line with previous practice, the small scale was not analysed, and so all analyses from this point on were carried out on the reduced scale (consisting of the items on scale 1 in Table \ref{tab:bam2daisp}).


<<bamscale2d,echo=FALSE, results=hide, cache=TRUE>>=
bamscale2d <- bamall2d[,c("BAM3","BAM6","BAM7","BAM9","BAM10","BAM13","BAM14", "BAM17")]
@ 



<<bam2dcheckiio, echo=FALSE, results=tex>>=
bam2d.iio <- check.iio(na.omit(bamscale2d))
print(xtable(bam2d.iio$violations, label="tab:bam2dheckiio", caption="Item Ordering Assumption Check, Beliefs About Medicine Questionnaire, Split D"))
@ 

Firstly, the invariant item ordering assumption was checked, and the results are shown in Table \ref{tab:bam2dheckiio}. As can be seen from this Table, there were no violations or issues with the IIO assumption.



<<bam2dcheckmono, echo=FALSE, results=tex>>=
bam2d.mono <- check.monotonicity(na.omit(bamscale2d))
print(xtable(summary(bam2d.mono), label="tab:bam2dcheckmono", caption="Monotonicity Check, Beliefs About Medicine Questionnaire, Split D"))
@ 

Next, the assumption of monotonicity was tested. The results of this test are shown in Table \ref{tab:bam2dcheckmono}, and it can be seen that there were no violations of this assumption, but the ItemH coefficients are quite low, suggesting that this scale is not entirely unproblematic. 


\begin{figure}
<<bam2dguttman, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
bam2d.guttman <- check.errors(na.omit(bamscale2d))
bam2d.guttplot <- ggplot(as.data.frame(bam2d.guttman), aes(x=bam2d.guttman))+geom_histogram(binwidth=2)
print(bam2d.guttplot)
@   
  \caption{Plot of Guttman errors for Beliefs about Medicine Scale, Split D}
  \label{fig:bam2dguttmanplot}
\end{figure}

Next, the scales were checked for guttman errors, and these were plotted in a histogram, shown in Figure \ref{fig:bam2dguttmanplot}. It can be seen from this plot that there were some participants who had quite a few guttman errors, as the distribution has a mode of approximately 10. However, the maximum number of Guttman errors was much lower than in Split C, where one participant had over 200 scaling errors. Again, this feature of the dataset needs to be investigated, and this will be carried out when person and item fit are assessed below.  

<<bam2dgpcm, echo=FALSE, results=hide, cache=TRUE>>=
bam2d.gpcm.rasch <- gpcm(bamscale2d, constraint="rasch")
bam2d.gpcm.1PL <- gpcm(bamscale2d, constraint="1PL")
bam2d.gpcm.gpcm <- gpcm(bamscale2d, constraint="gpcm")
@ 

Next, three generalised partial credit models were fitted to the scale, and the results of the Rasch fit are shown below. 


<<bam2dgpcmrasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2d.gpcm.rasch)), label="tab:bam2dgpcmrasch", caption="Coefficients for Beliefs About Medicine Questionnaire (Split D), Rasch Generalised Partial Credit Model"))
@ 

As can be seen from Table \ref{tab:bam2dgpcmrasch}, it can be seen that the majority of the categories have relatively low thresholds, with the exception of category 4. 

Next, a one parameter PCM was fitted to this scale. 

<<bam2dpcm1plprint, echo=FALSE, results=tex>>=
print(xtable(coef(bam2d.gpcm.1PL), label="tab:bam2dpcm1pl", caption="Coefficient Estimates for BAM Scale, One Parameter PCM, Split D"))
@ 

Table \ref{tab:bam2dpcm1pl} shows the estimated coefficients for the one parameter model. It can be seen that similarly to the Split C scale, the discrimination parameters have lowered in this model, while the estimated thresholds have risen slightly. 

Finally, a two parameter PCM was fitted to this scale.

<<bam2dpcm2plprint, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2d.gpcm.gpcm)), label="tab:bam2dpcm2pl", caption="Coefficient Estimates for BAM Scale, Two Parameter PCM, Split D"))
@ 

As can be seen from Table \ref{tab:bam2dpcm2pl}, the same pattern as was seen in Split C gas emerged, with some of the questions having quite high discrimination parameters, while others have rather low discriminations. Note in particular Q3, which has the huighest estimated threshold along with very low discrimination. 

<<bam2dgrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2d.grm.1pl <- grm(bamscale2d, constrained=TRUE)
bam2d.grm.2pl <- grm(bamscale2d, constrained=FALSE)
@ 

Next, two graded response models (one and two parameter) were fit to the data. 
<<bam2dgrm1sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2d.grm.1pl)), label="tab:bam2dgrm1sum", caption="Coefficients for Beliefs About Medicine Questionnaire (Split D), One Parameter Graded Response Model"))
@ 

Table \ref{tab:bam2dgrm1sum} shows the estimated coefficients and (averaged) discrimination parameter for the one parameter graded response model. This model appears to not have any problems with non-monotonicity, and the estimated discrimination parameter and thresholds are quite similar to those in previous splits. Again, BAM3 has the highest estimated threshold (with the exception of BAM6, where no participant picked the highest response alternative). 

Next, the two parameter GRM was fit to the Beliefs About Medicine Questionnaire. The results are shown in Table \ref{tab:bam2dgrm2sum}. The two parameter model is quite similiar to the one parameter model, the tradeoff between the discrimination parameter and the difficulty estimates can clearly be seen, as BAM3 has a lower discrimination parameter in this fit, but a much higher threshold. Most of the items appear to have made the opposite trade-off, with lower threshold values but a much higher discrimination parameter. 

<<bam2dgrm2sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2d.grm.2pl)), label="tab:bam2dgrm2sum", caption="Coefficients for Beliefs About Medicine Questionnaire, (Split D), Two Parameter Graded Response Model"))
@ 

After this process, an ANOVA was fit to the two graded response models, to determine which of them fit the data better. The LR test indicated that the two parameter model fit the data significanly better ($p\le0.001$), but the AIC indicated that the one parameter model was a better fit. This will be examined by looking at each of the models\' performance on unseen data. 

<<bam2danovagrm, echo=FALSE, results=hide, cache=TRUE>>=
bam2dgrm.anova <- anova(bam2d.grm.1pl, bam2d.grm.2pl)
@

Next, the performance of each of these models on unseen data was assessed. 

<<bam2dpcmmodtest, echo=FALSE, results=tex, cache=TRUE>>=
bamnotd.irt <- tcq2notd[,c("BAM3","BAM6","BAM7","BAM9","BAM10","BAM13","BAM14", "BAM17")]
bam2d.gpcm.rasch.done <- testIRTModels(bam2d.gpcm.rasch, bamnotd.irt, gpcmconstraint="rasch", grmconstraint=NULL)
bam2d.gpcm.1PL.done <- testIRTModels(bam2d.gpcm.1PL, bamnotd.irt, gpcmconstraint="1PL", grmconstraint=NULL)
bam2d.gpcm.gpcm.done <- testIRTModels(bam2d.gpcm.gpcm, bamnotd.irt, gpcmconstraint="gpcm", grmconstraint=NULL)
bam2d.pcm.modcomp <- rbind(bam2d.gpcm.rasch.done, bam2d.gpcm.1PL.done, bam2d.gpcm.gpcm.done)

@ 
<<bam2dpcmmodcompprint, echo=FALSE, results=tex>>=
print(xtable(bam2d.pcm.modcomp, caption="Performance of Split D Beliefs About Medicine Scale on Splits A, B and C", label="tab:bam2dpcmmodcomp"))

@ 
As can be seen from Table \ref{tab:bam2dpcmmodcomp}, the one parameter Partial Credit Model performed best on the unseen data. 

Next, the perfomance of the graded response models on unseen data was assessed. 

<<bam2dgrmmodtest, echo=FALSE, results=tex, cache=TRUE>>=
bam2d.grm.1pl.done <- testIRTModels(bam2d.grm.1pl, bamnotd.irt, gpcmconstraint=NULL, grmconstraint=TRUE)
bam2d.grm.2pl.done <- testIRTModels(bam2d.grm.2pl, bamnotd.irt, gpcmconstraint=NULL, grmconstraint=TRUE)
bam2d.grm.modcomp <- rbind(bam2d.grm.1pl.done, bam2d.grm.2pl.done)

@ 
<<bam2dgrmmodcomp, echo=FALSE, results=tex>>=
print(xtable(bam2d.grm.modcomp, captio="Performance of Split D Beliefs About Medicine Scale (Graded Response Model) on Splits A, B and C", label="tab:bam2dgrmmodcomp"))
@ 

As can be seen from Table \ref{tab:bam2dgrmmodcomp}, the one parameter Graded Response Model performed best on the unseen data. 

\begin{figure}
<<splitApairs, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
tcq2.nota.tot <- tcq2nota[,71:77]
tcq2.nota.pairs <- pairs.panels(na.omit(tcq2.nota.tot))
@   
  \caption{Scatterplot Matrix for TCQ not A split. The upper diagonal has the correlations between the variables, the diagonal has a histogram of the values with density lines overlaid, and the lower diagonal has scatterplots for each pair of variables, with an overlaid locally weighted smoother regression line}
  \label{fig:splitApairs}
\end{figure}

Figure \ref{fig:splitApairs} shows the scatterplot matrix for the totals in Split A. It can clearly be seen that the conventional variables correlate well with one another, as do the alternative variables. Some evidence of convergent validity is also seen, as the Beliefs About Medicine Questionnaire correlates negatively with the conventional forms of treatment, and positively with the alternative forms of treatment, as predicted. 

Next, the relationships of the demographic variables with the totals were examined. 

<<tcq2notAdemo, echo=FALSE, results=hide, cache=TRUE>>=
tcq2.nota.demo <- tcq2nota[,2:16]
@ 

One examination of the data which was of interest was the relationship between the conventional and alternative scores and demographic variables. A mean was calculated for both the conventional and alternative items, and this was plotted against gender. The results are shown in Figure \ref{fig:convaltmeangender}. As can be seen, the patterns differ for men and women, though the effect is small and the error bars are quite large. For men, higher scores on the conventional forms of treatment tend to be associated with higher scores on the alternative forms of treatment, while for women, the opposite is true. 

\begin{figure}
<<convaltmeans, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE, eps=TRUE, pdf=TRUE, png=TRUE>>=
p <- ggplot(na.omit(tcq2nota), aes(x=ConvMean, y=AltMean, group=Gender))
p2 <- p+geom_smooth(method="lm")+facet_grid(.~Gender)
## p3 <- p2+facet_grid(.~Gender)
print(p2)
@   
  \caption{Regression line of Conventional treatment mean scores against Alternative treatment mean scores, stratified by Gender (regression line is a least squares fit)}
  \label{fig:convaltmeangender}
\end{figure}



\begin{figure}
<<ggplotconvaltcollege, echo=FALSE,fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
p <- ggplot(na.omit(tcq2nota), aes(x=ConvMean, y=AltMean))
p2 <- p+geom_smooth(method="lm")
p3 <- p2+facet_grid(.~College)
print(p3)
@   
  \caption{Conventional Means Regressed against Alternative treatment means, stratified based on College of study or work}
  \label{fig:convaltmeancollege}
\end{figure}


Figure \ref{fig:convaltmeancollege} shows a regression of alternative  treatment mean scores against conventional treatment mean scores, stratified based on college. It can be seen that for Arts, Science and Business and Law, increased scores on the alternative treatments were associated with increased scores on the conventional treatments, while for medicine and health, the reverse was true - which suggests that either these participants had a different relationship to these forms of treatment, or that their course of study had altered their perceptions. As can be seen from Figure \ref{fig:medhealthyear}, the second alternative appears to be the case, given that the relationship is positive in Year 1, but then turns sharply negative. 

\begin{figure}
<<medhealthyear, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
medhealth <- tcq2[with(tcq2, College=="Medicine and Health"),]
medyearplot <- ggplot(na.omit(medhealth), aes(x=ConvMean, y=AltMean))+geom_smooth(method="lm")+facet_grid(.~Year)
print(medyearplot)
@ 
  
  \caption{Relationship between Conventional and Alternative Treatment Scores in Medicine and Health Students}
  \label{fig:medhealthyear}
\end{figure}

\begin{figure}
<<ggplotpillincome, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
p <- ggplot(na.omit(tcq2nota), aes(x=ConvMean, y=AltMean))
p2 <- p+layer(geom="smooth", method="lm")
p3 <- p2+facet_grid(.~Health)
print(p3)
@   
  \caption{Regression of Alternative Treatment means against conventional treatment means, stratified by health status (where 1 is worst health and 5 is best health)}
  \label{fig:convaltmeanhealth}
\end{figure}

Figure \ref{fig:convaltmeanhealth} shows the regression of conventional treatment mean scores against alternative  treatment mean scores, stratified by Health status. It can be seen that for moderate levels of self rated health (2-4), higher scores on the conventional treatments were associated with higher scores on the alternative treatment. However, for participants who rated their health as ``Excellent'', the opposite pattern emerged. 



Next, summary scores for experience with conventional treatments and alternative treatments were calculated, and the relationships of these two variables to demographic variables were examined.

\begin{figure}
<<expconvaltgender, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
p <- ggplot(tcq2nota, aes(x=Expconv, y=Expalt))
p2 <- p+geom_smooth(method="lm")+facet_grid(.~Gender)
print(p2)
@   
  \caption{Experience with Alternative Treatments Regressed against Experience with Conventional Treatments, Stratified by Gender}
  \label{fig:expconvaltgender}
\end{figure}

\begin{figure}
<<expconvaltgender, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
p <- ggplot(tcq2nota, aes(x=Expconv, y=Expalt))
p2 <- p+layer(geom="smooth", method="lm")
p3 <- p2+facet_grid(.~College)
print(p3)
@ 
  \caption{Experience with Alternative Treatments Regressed against Experience with Conventional Treatments, Stratified by College}
  \label{fig:expconvaltgender}
\end{figure}


\begin{figure}
<<expconvaltgender, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
p <- ggplot(tcq2nota, aes(x=Expconv, y=Expalt))
p2 <- p+geom_smooth(method="lm")+facet_grid(.~Health)
print(p2)
@ 
  \caption{Experience with Alternative Treatments Regressed against Experience with Conventional Treatments, Stratified by College}
  \label{fig:expconvaltgender}
\end{figure}

Following on from the graphical exploration of the relationships between the variables, the next step was to fit a linear model on this data, eliminate variables based on the decrease in AIC, and test the model on the held out data. 

%% \subsubsection{Final Regression Models}
%% \label{sec:final-regr-models}

%% The next step in the data analysis procedure was to determine which of the models developed on each of the splits were the best fit to the data. As all of the data has been used in previous test and validation splits, the following approach was taken. Firstly, a random sample of 75 observations was drawn from each of the four splits, and then these samples were combined. The chosen models from each of the splits were then fitted to this new data set, and were compared using AIC and likelihood ratio tests. This approaches balances the advantages of cross-validation and avoids the problems of multiple comparison endemic to stepwise variable selection and repeated model fitting. 

%% <<tcq2new, echo=FALSE, results=hide>>=
%% set.seed(23)
%% ptcq2a.finalsamp <- tcq2nota.complete[sample(1:nrow(tcq2nota.complete), 75),]
%% tcq2b.finalsamp <- tcq2notb.complete[sample(1:nrow(tcq2nota.complete), 75),]
%% tcq2c.finalsamp <- tcq2notc.complete[sample(1:nrow(tcq2nota.complete), 75),]
%% tcq2d.finalsamp <- tcq2notd.complete[sample(1:nrow(tcq2nota.complete), 75),]
%% tcq2final <- as.data.frame(rbind(tcq2a.finalsamp,tcq2b.finalsamp,tcq2c.finalsamp,tcq2d.finalsamp))
%% @ 

%% <<pillfinalfits, echo=FALSE, results=hide>>=
%% pilltotlm.nota <- lm(Pilltot~Creamtot+Injtot+Homtot+Reitot, data=tcq2final)
%% pilltotnotb <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv, data=tcq2final)
%% pilltotnotc <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv, data=tcq2final)
%% pilltotnotd <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv+Gender, data=tcq2final)
%% pillaandbtest <- jtest(pilltotlm.nota, pilltotnotb)
%% pillcanddtest <- jtest(pilltotnotc, pilltotnotd)
%% pillaandctest <- jtest(pilltotlm.nota, pilltotnotc)
%% pillaanddtest <- jtest(pilltotlm.nota, pilltotnotd)
%% @ 

%% <<ABcompprint, echo=FALSE, results=tex>>=
%% print(xtable(pillaandbtest, label="tab:pillAandBtest", caption="Model Comparison between Pill Credibility Models, Splits A and B"))
%% @ 

%% <<ABcompprint, echo=FALSE, results=tex>>=
%% print(xtable(pillcanddtest, label="tab:pillCandDtest",caption="Model Comparison between Pill Credibility Models, Splits C and D"))
%% @ 

%% As shown in Tables \ref{tab:pillAandBtest} and \ref{tab:pillCandDtest}, the model developed on Split A appears to preovide the best fit on this resampled data. The model tested on split A was also significantly better than C and D, therefore we can regard this model as the best for the Pill credibility scores. The model was significant: $F(4,283)=68.81$, $p\le 0.0001$, and had an adjusted $R^2$ of 0.4859. 

%% Next, the models for cream credibility scores were assessed. 

%% <<creamfinal, echo=FALSE, results=hide>>=
%% creamtotlm.nota <- lm(Creamtot~Pilltot+Injtot+Acutot+Gender+Health, data=tcq2final)
%% creamtotlm.notb <- lm(Creamtot~Pilltot+Injtot+Acutot+Gender, data=tcq2final)
%% creamtotlm.notc <- lm(Creamtot~Injtot+Acutot+Expalt+Health, data=tcq2final)
%% creamtotlm.notd <- lm(Creamtot~Pilltot+Injtot+Acutot+Expconv+Expalt+Gender, data=tcq2final)
%% creamaandbtest <- jtest(creamtotlm.nota, creamtotlm.notb)
%% creamcanddtest <- jtest(creamtotlm.notc, creamtotlm.notd)
%% creamdanbctest <- jtest(creamtotlm.notd, creamtotlm.notc)
%% creamaanddtest <- jtest(creamtotlm.nota, creamtotlm.notd)
%% @ 

%% The results for this split were a little more ambiguous, as Models A and B were equivalent in terms of model testing. Model D was better than Model C, but Model A was better than Model D. Therefore we can regard Model D as the best fitting model for the Cream credibility scores. The model was significant: F(5,282)=43.51, $p\le 0.0001$, with an adjusted $R^2$ of 0.4255, which is acceptable. 

%% Next, the same procedure was repeated for the Injection credibility scores. 

%% <<injfinal, echo=FALSE, results=hide>>=
%% injtotnota.final <- lm(Injtot~Creamtot+Pilltot+Expconv+Health, data=tcq2final)
%% injtotnotb.final <- lm(Injtot~Pilltot+Creamtot+Acutot+Reitot+Expconv, data=tcq2final)
%% injtotnotc.final <- lm(Injtot~Creamtot+Pilltot+Expconv, data=tcq2final)
%% injtotnotd.final <- lm(Injtot~Pilltot+Creamtot+Acutot+Expconv+Reitot, data=tcq2final)
%% inj.aandb.test <- jtest(injtotnota.final, injtotnotb.final)
%% inj.candd.test <- jtest(injtotnotc.final, injtotnotd.final)
%% inj.bandd.test <- jtest(injtotnotb.final, injtotnotd.final)
%% @ 

%% <<modeldshow, echo=FALSE, results=tex>>=
%% print(xtable(summary(injtotnotd.final), label="tab:injnotdfinal", caption="Final Model for Injection Credibility Scores"))
%% @ 

%% Following repeated tests of the fit of the models, Model D appears to be the best fitting on this data. The model was significant: $F(5,282)=48.56$, $p\le 0.0001$ and the adjusted $R^2$ for the model was equal to 0.3955. The coefficients for the model are shown in Table \ref{tab:injnotdfinal}. 

%% Next, this procedure was repeated for the Acupuncture models. 

%% <<acufinaltest, echo=FALSE, results=hide>>=
%% acutotnota.final <- lm(Acutot~Creamtot+Homtot+Reitot, data=tcq2final)
%% acutotnotb.final <- lm(Acutot~Pilltot+Creamtot+Injtot+Reitot+Homtot, data=tcq2final)
%% acutotnotc.final <- lm(Acutot~Creamtot+Homtot+Reitot, data=tcq2final)
%% acutotnotd.final <- lm(Acutot~Pilltot+Creamtot+Injtot+Homtot+Reitot, data=tcq2final)
%% acu.aandb.test <- jtest(acutotnota.final, acutotnotb.final)
%% acu.candd.test <- jtest(acutotnotc.final, acutotnotd.final)
%% acu.aandc.test <- jtest(acutotnota.final, acutotnotc.final)
%% @ 
%% Following fitting of each of the four models to the final dataset, Models A and C emerged as the best fit to the data. This equivalence between them was not surprising, as they were exactly the same model. 

%% <<acutotfinalprint, echo=FALSE, results=tex>>=
%% print(xtable(summary(acutotnotc.final), label="tab:acutotfinal", caption="Final Model for Acupuncture Credibility Scores"))
%% @ 

%% The coefficients and p values for the individual terms in the model can be seen in Table \ref{tab:acutotfinal}. The model was significant: $F(3,284)=79.31$, $p\le 0.0001$, and had an adjusted $R^2$ of 0.4501. 

%% Next, this procedure was applied to the homeopathy models developed on each of the splits. 

%% <<hommodfinal, echo=FALSE, results=tex>>=
%% homtotnota.final <- lm(Homtot~Creamtot+Pilltot+Acutot+Reitot, data=tcq2final)
%% homtotnotb.final <- lm(Homtot~Pilltot+Creamtot++Reitot+Acutot, data=tcq2final)
%% homtotnotc.final <- lm(Homtot~Acutot+Reitot+Expalt, data=tcq2final)
%% homtotnotd.final <- lm(Homtot~Acutot+Reitot+Expalt, data=tcq2final)
%% hom.aandb.test <- jtest(homtotnota.final, homtotnotb.final)
%% hom.candd.test <- jtest(homtotnotc.final, homtotnotb.final)
%% hom.bandc.test <- jtest(homtotnotb.final, homtotnotc.final)
%% @ 

%% Following assessment of all four models, Model C was determined to be marginally the best.

%% <<homfinalshow, echo=FALSE, results=tex>>=
%% print(xtable(summary(homtotnotc.final), label="tab:homtotfinal", caption="Final Model for Homeopathy Credibility Scores"))
%% @ 

%% Table \ref{tab:homtotfinal} shows the estimated coefficients and p values for each of the predictors on the final dataset. The model was significant: $F(3,284)=177.7$, $p\le 0.0001$ and the adjusted $R^2$ for the model was equal to 0.6487. 

%% Next, the same procedure was applied to the Reiki credibility models. 

%% <<reikimodfinal, echo=FALSE, results=hide>>=
%% reitotnota.final <- lm(Reitot~Injtot+Expalt+Acutot, data=tcq2final)
%% reitotnotb.final <- lm(Reitot~Injtot+Acutot+Homtot, data=tcq2final)
%% reitotnotc.final <- lm(Reitot~Acutot+Injtot+Homtot, data=tcq2final)
%% reitotnotd.final <- lm(Reitot~Acutot+Homtot+Injtot, data=tcq2final)
%% rei.aandb.test <- jtest(reitotnota.final, reitotnotb.final)
%% rei.candd.test <- jtest(reitotnotc.final, reitotnotd.final)
%% rei.bandd.test <- jtest(reitotnotb.final, reitotnotd.final)
%% @ 

%% Following fitting and testing of the four models, Model D was determined to be the best fit to this new data. 

%% <<reifinalshow, echo=FALSE, results=tex>>=
%% print(xtable(summary(reitotnotd.final), label="tab:reitotfinal", caption="Final Model for Reiki Credibility Scores"))
%% @ 

%% Table \ref{tab:reitotfinal} shows the estimated coefficients for the Reiki credibility scores regression on the resampled data. The model was significant: $F(3,284)=167.7$, $p\le 0.0001$, with an adjusted $R^2$ of 0.6354, which is excellent. 

<<stepwiselm, echo=FALSE, results=hide, cache=TRUE>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
creamtotlm1.nota <- lm(Creamtot~Pilltot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
creamtot.step.nota <- stepAIC(object=creamtotlm1.nota, upper=creamtotlm1,lower=~1, direction="both", k=3)


@

<<creamstepa, echo=FALSE, results=tex>>=
print(xtable(summary(creamtot.step.nota), label="tab:creamtotlm1nota", caption="Coefficients for Cream Credibility Regression (Stepwise selection used (both forwards and backwards)"))
creamtot.pred <- predict(creamtotlm1.nota, newdata=tcq2a)
@ 

%% The results on the training sample are shown in Table \ref{tab:creamtotlm1nota}. The model was significant: $F(3,314)=34.24$, p-value of $p\le 0.001$. The adjusted $R^2$ for the model was 0.3861, which is extremely poor. Next the performance of the model on the held out data was assessed. 


<<lmonheldoutdatacream, echo=FALSE, results=tex>>=
creamtotlm.holdout <- lm(Creamtot~Pilltot+Injtot+Acutot+Gender+Health, data=tcq2a)
print(xtable(summary(creamtotlm.holdout), label="tab:creamlmholdoutnota", caption="Performance of Stepwise Selected Model on held out data, Cream credibility scores"))
@ 

<<cream2alasso, echo=FALSE, results=tex>>=
cream2a <- with(tcq2nota.complete, Creamtot)
predcream2a <- tcq2nota.complete[, c(71, 73:81)]
predcream2a.test <- na.omit(tcq2a[,c(71, 73:81)])
cream2a.test <- with(na.omit(tcq2a), Creamtot)
cream2a.lasso <- penalisedRegression(predcream2a, cream2a, testdata=predcream2a.test, newy=cream2a.test, alpha=1, type="coefficients")
print(xtable(as.matrix(cream2a.lasso), label="tab:tcq2acreamlasso", caption="Coefficient Estimates for Creamtotal Lasso regression, Split A"))
@ 

<<cream2aridge, echo=FALSE, results=tex>>=
cream2a.ridge <- penalisedRegression(predcream2a, cream2a, predcream2a.test, cream2a.test, alpha=0, type="coefficients")
print(xtable(as.matrix(cream2a.ridge), label="tab:tcq2acreamridge", caption="Coefficient Estimates for Ridge Regression on Cream Credibility, Split A"))
@ 

<<stepwiselm, echo=FALSE, results=hide>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
injtotlm1.nota <- lm(Injtot~Creamtot+Pilltot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
injtot.step.nota <- stepAIC(object=injtotlm1.nota, upper=injtotlm1.nota,lower=~1, direction="both", k=3)

injtot.pred <- predict(injtotlm1.nota, newdata=tcq2a)
@ 

<<injstepa, echo=FALSE, results=tex>>=

print(xtable(summary(injtot.step.nota), label="tab:injtotlm1nota", caption="Coefficients for Injection Credibility, Selected using forwards and backwards selection (Splits B, C and D)"))
@ 

<<lmonheldoutdatainj, echo=FALSE, results=tex>>=
injtotlm.holdout <- lm(Injtot~Creamtot+Pilltot+Expconv+Health, data=tcq2a)
print(xtable(summary(injtotlm.holdout), label="tab:injlmholdoutnota", caption="Coefficients for Injection Credibility Model on the Held Out Data (Split A)"))
@ 
Table \ref{tab:injlmholdoutnota} shows the results of the model on the hjeld out data. It can be seen that Cream credibility, Pill credibility and Health were all significant, while Experience with conventional treatments was almost significant. The model itself was significant: F(4,142)=21.4, with a p value of $p\le 0.001$, while the adjusted $R^2$ was equal to 0.3585, which is quite poor in comparison to some of the other results. 

<<inj2alasso, echo=FALSE, results=tex>>=
inj2a <- with(tcq2nota.complete, Injtot)
predinj2a <- tcq2nota.complete[, c(71:72, 74:77, 79:81)]
predinj2a.test <- na.omit(tcq2a[,c(71:72, 74:77, 79:81)])
inj2a.test <- with(na.omit(tcq2a), Injtot)
inj2a.lasso <- penalisedRegression(predinj2a, inj2a, testdata=predinj2a.test, newy=inj2a.test, alpha=1, type="coefficients")
print(xtable(as.matrix(inj2a.lasso), label="tab:tcq2ainjlasso", caption="Coefficient Estimates for Injtotal Lasso regression, Split A"))
@ 

Table \ref{tab:tcq2ainjlasso} shows the coefficient estimates for the lasso regression model. It can be seen that experience with conventional treatments had a small impact, and the two conventional treatments were retained by the model. Additionally, Reiki credibility was slightly negatively correlated. 

Next, a ridge model was fit to the same data. 

<<inj2aridge, echo=FALSE, results=tex>>=
inj2a.ridge <- penalisedRegression(predinj2a, inj2a, predinj2a.test, inj2a.test, alpha=0, type="coefficients")
print(xtable(as.matrix(inj2a.ridge), label="tab:inj2aridge", caption="Coefficient Estimates, Injection Credibility Ridge Regression Model, Split A"))
@ 

Table \ref{tab:inj2aridge} shows the estimated coefficients for the ridge regression model Injection credibility scores. It can be seen that the model is quite similar to that obtained from the lasso regression, even the coefficients are of similar magnitude. 

<<stepwiselmacunota, echo=FALSE, results=hide, cache=TRUE>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
acutotlm1.nota <- lm(Acutot~Creamtot+Pilltot+Injtot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
acutot.step.nota <- stepAIC(object=acutotlm1.nota, upper=acutotlm1.nota,lower=~1, direction="both", k=3)

acutot.pred <- predict(acutotlm1.nota, newdata=tcq2a)
@ 

<<acustepa, echo=FALSE, results=tex>>=
print(xtable(summary(acutot.step.nota), label="tab:acutotlm1nota", caption="Coefficients for Acupuncture Credibility selected using Stwpwise Forward and Back Selection"))
@ 

Table \ref{tab:acutotlm1nota} shows the estimated coefficients on the training sample. It can be seen that Cream credibility, Homeopathy credibility and Reiki credibility were the only variables retained by the procedure. The model was independently significant; F(3,314)=76.69, p=value $p\le 0.001$. The adjusted $R^2$ was equal to 0.4173. This model was then applied to the validation set.

<<lmonheldoutdataacu, echo=FALSE, results=tex>>=
Acutotlm.holdout <- lm(Acutot~Creamtot+Homtot+Reitot, data=tcq2a)
print(xtable(summary(Acutotlm.holdout), label="tab:aculmholdoutnota", caption="Coefficients for Acupuncture Credibility Scores on Held Out Data (Split A)"))
@ 

It can be seen from Table \ref{tab:aculmholdoutnota} that all of the variables remained significant in the validation set. The model was independently significant; $F(3,146)=23.89$, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.3154.


<<acu2alasso, echo=FALSE, results=tex>>=
acu2a <- with(tcq2nota.complete, Acutot)
predacu2a <- tcq2nota.complete[, c(71:73, 75:78, 80:81)]
predacu2a.test <- na.omit(tcq2a[,c(71:73, 75:78, 80:81)])
acu2a.test <- with(na.omit(tcq2a), Acutot)
acu2a.lasso <- penalisedRegression(predacu2a, acu2a, testdata=predacu2a.test, newy=acu2a.test, alpha=1, type="coefficients")
print(xtable(as.matrix(acu2a.lasso), label="tab:tcq2aaculasso", caption="Coefficient Estimates for Acutotal Lasso regression, Split A"))
@ 

Table \ref{tab:tcq2aaculasso} shows the coefficients estimated from the lasso regression procedure. It can be seen that all of the other alternative treatments had relatively large coefficients, along with Bam totals. Additionally, there was a small effect for experience with alternative treatments. 


<<acu2aridge, echo=FALSE, results=tex>>=
acu2a.ridge <- penalisedRegression(predacu2a, acu2a, predacu2a.test, acu2a.test, alpha=0, type="coefficients")
print(xtable(as.matrix(acu2a.ridge), label="tab:tcq2aacuridge", caption="Coefficient Estimates for Acupuncture Ridge Regression, Split A"))
@ 

As can be seen from Table \ref{tab:tcq2aacuridge}, the coefficient estimates for the ridge regression procedure are relatively similar to those obtained from the lasso solution, suggesting that this is a useful model. 

<<stepwiselm, echo=FALSE, results=hide>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
homtotlm1.nota <- lm(Homtot~Creamtot+Pilltot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
homtot.step.nota <- stepAIC(object=homtotlm1.nota, upper=homtotlm1.nota,lower=~1, direction="both", k=3)

acutot.pred <- predict(acutotlm1.nota, newdata=tcq2a)
@ 

<<homstepwise2aprint, echo=FALSE, results=tex>>=
print(xtable(summary(homtot.step.nota), label="tab:homtotlm1.nota", caption="Coefficients for Homeopathy Credibility Scores selected by Stepwise Selection (Splits B, C and D)"))
@ 

Table \ref{tab:homtotlm1nota} shows the estimated coefficients on the training set. It can be seen that Cream, Pill, Acupuncture and Reiki credibility scores were retained by the algorithm. The model was independently significant: $F(4,313)=138.4$, $p\le 0.001$. The adjusted $R^2$ for the model was equal to 0.6342. Next, the model was examined on the validation set. 

<<lmonheldoutdatacream, echo=FALSE, results=tex>>=
Homtotlm.holdout <- lm(Homtot~Creamtot+Pilltot+Acutot+Reitot, data=tcq2a)
print(xtable(summary(Homtotlm.holdout), label="tab:homlmholdoutnota", caption="Coefficients for Homeopathy Credibility on Heldout data (Splits B, C and D"))
@ 
Table \ref{tab:homlmholdoutnota} shows the performance of the model on the validation set. It can be seen that Pill and cream credibility scores are no longer significant, suggesting that their inclusion was an artifact of the selection algorithm. The model was significant: F(4,144)=29.09, $p\le 0.001$, and the adjusted $R^2$ was equal to 0.4316. 



<<hom2alasso, echo=FALSE, results=tex>>=
hom2a <- with(tcq2nota.complete, Homtot)
predhom2a <- tcq2nota.complete[, c(71:72, 76:78, 80:81)]
predhom2a.test <- na.omit(tcq2a[,c(71:74, 76:78, 80:81)])
hom2a.test <- with(na.omit(tcq2a), Homtot)
hom2a.lasso <- penalisedRegression(predhom2a, hom2a, testdata=predhom2a.test, newy=hom2a.test, alpha=1, type="coefficients")
print(xtable(as.matrix(hom2a.lasso), label="tab:tcq2ahomlasso", caption="Coefficient Estimates for Homtotal Lasso regression, Split A"))
@ 

Table \ref{tab:tcq2ahomlasso} shows the estimated coefficients derived from the lasso model. It can be seen that Reiki credibility and Bamtotal were related to the outcome, along with experience of alternative treatments.

Next, a ridge regression model was fit to the same dataset. 


<<hom2aridge, echo=FALSE, results=tex>>=
hom2a.ridge <- penalisedRegression(predhom2a, hom2a, predhom2a.test, hom2a.test, alpha=0, type="coefficients")
print(xtable(as.matrix(hom2a.ridge), label="tab:tcq2ahomridge", caption="Coefficient Estimates for Hompuncture Ridge Regression, Split A"))
@ 

Table \ref{tab:tcq2ahomridge} shows the estimated coefficients from the ridge model. It can be seen that these are extremely similar to those obtained from the lasso model, suggesting that these coefficients are associated with the response variable in this sample. 

<<stepwiselm, echo=FALSE, results=hide>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
reitotlm1.nota <- lm(Reitot~Creamtot+Pilltot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
reitot.step.nota <- stepAIC(object=reitotlm1.nota, upper=reitotlm1.nota,lower=~1, direction="both", k=3)

reitot.pred <- predict(reitotlm1.nota, newdata=tcq2a)
@ 

<<rei2astepwiseprint, echo=FALSE, results=tex>>=
print(xtable(summary(reitot.step.nota), label="tab:reitotlm1nota", caption="Coefficients for Reiki Credibility Selected using Stepwise Selection"))
@ 

Table \ref{tab:reitotlm1nota} shows the estimated coefficients on the training set. The algorithm retained Injection total, Acupuncture and the Experience with alternative treatments variables. The model was significant; F(3,314)=67.98, $p\le 0.001$. The adjusted $R^2$ for the model was equal to 0.388. Next, the performance of these  variables was examined on the validation set. 

<<lmonheldoutdatacream, echo=FALSE, results=tex>>=
Reitotlm.holdout <- lm(Reitot~Injtot+Expalt+Acutot, data=tcq2a)
print(xtable(summary(Reitotlm.holdout), label="tab:reilmholdoutnota", caption="Coefficients for Reiki Linear Regression on Heldout Data"))
@ 

Table \ref{tab:reilmholdoutnota} shows the estimated coefficients on the validation set. It can be seen that all variables remain significant. The model itself was significant:F(3,139)=17.71, $p\le 0.001$. The adjusted $R^2$ value for the model on the validation set was equal to 0.2609.

<<rei2alasso, echo=FALSE, results=tex>>=
rei2a <- with(tcq2nota.complete, Reitot)
predrei2a <- tcq2nota.complete[, c(71:75, 77:78, 80:81)]
predrei2a.test <- na.omit(tcq2a[,c(71:75, 77:78, 80:81)])
rei2a.test <- with(na.omit(tcq2a), Reitot)
rei2a.lasso <- penalisedRegression(predrei2a, rei2a, testdata=predrei2a.test, newy=rei2a.test, alpha=1, type="coefficients")
print(xtable(as.matrix(rei2a.lasso), label="tab:tcq2areilasso", caption="Coefficient Estimates for Reitotal Lasso regression, Split A"))
@ 

Table \ref{tab:tcq2areilasso} shows the estimated coefficients for the lasso model in this split. It can be seen that Homeopathy credibility totals have a large impact on the variable, while acupuncture totals are not related. No other variable has an major impact on the model. 

<<rei2aridge, echo=FALSE, results=tex>>=
rei2a.ridge <- penalisedRegression(predrei2a, rei2a, predrei2a.test, rei2a.test, alpha=0, type="coefficients")
print(xtable(as.matrix(rei2a.ridge), label="tab:tcq2areiridge", caption="Coefficient Estimates for Reipuncture Ridge Regression, Split A"))
@ 

Table \ref{tab:tcq2areiridge} shows the estimated coefficients obtained from the ridge regression model. It can be seen that they are relatively similiar in pattern to those obtained from the lasso regression method. 

Finally, the stepwise variable selection procedure was applied to the Beliefs about Medicine Total (long form).

<<stepwiselm, echo=FALSE, results=hide>>=
tcq2nota.full <- complete.cases(tcq2nota)
tcq2nota.complete <- tcq2nota[tcq2nota.full,]
## tcq2nota.complete$bamscale <- apply(bam2ascale, 1, mean, na.rm=TRUE)
## tcq2a$bamscale look at using reduced bam scale
bamtotlm1.nota <- lm(Bamtot~Creamtot+Pilltot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2nota.complete)
bamtot.step.nota <- stepAIC(object=bamtotlm1.nota, upper=bamtotlm1.nota,lower=~1, direction="both", k=3)

bamtot.pred <- predict(bamtotlm1.nota, newdata=tcq2a)
@ 
<<bamtot2aprint, echo=FALSE, results=tex>>=
print(xtable(summary(bamtot.step.nota), label="tab:bamtotlm1nota", caption="Coefficients for Beliefs About Medicine Totals Selected using Stepwise Selection"))
@ 
As can be seen from Table \ref{tab:bamtotlm1nota}, the algorithm kept six variables in the model. Of these conventional items have a negative loading, and the Acupuncture item has a positive loading. Interestingly enough, the experience with conventional treatments variable has a negative loading on the dependent variable also, as do income and Health. Next, the fit of the model on the held out data was examined. 

<<lmonheldoutdatabam, echo=FALSE, results=tex>>=
Bamtotlm.holdout <- lm(Bamtot~Creamtot+Pilltot+Expconv+Acutot+Income+Health, data=tcq2a)
print(xtable(summary(Bamtotlm.holdout), label="tab:Bamlmholdoutnota", caption="Coefficients for BAM totals on held out data (Splits B, C and D)"))
@ 

Of the six variables selected by the algorithm, only Cream total and Income remain significant, as can be seen from Table \ref{tab:Bamlmholdoutnota}. The model was not significant, $F(6,130)=1.887$, $p=0.0877$, while the adjusted $R^2$ was equal to 0.037. 

\subsubsection{Split B}
\label{sec:split-2}

Next, the same procedure was repeated for all totals using the data from Splits A,C and D, while holding out Split B as a validation set. 

<<pilltotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
pilltotlm1.notb <- lm(Pilltot~Creamtot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
pilltot.step.notb <- stepAIC(object=pilltotlm1.notb, upper=pilltotlm1.notb,lower=~1, direction="both", k=3)
pilltot.pred <- predict(pilltotlm1.notb, newdata=tcq2b)

@ 

<<pillstepb, echo=FALSE, results=tex>>=
print(xtable(summary(pilltot.step.notb), label="tab:pilltotnotbsteplm", caption="Coefficients for Pill Credibility Scores selected using Stepwise Selection on Splits A, C and D"))
@ 

Table \ref{tab:pilltotnotbsteplm} shows the performance of the stepwise algorithm on the training sample. It can be seen that with a penalisation factor of three for the parameters in the model (as opposed to the classic AIC penalty of two), only four variables (Creamtot, Injtot, Acutot, and Experience with conventional treatments) are retained by the algorithm. Both Acutot and Expconv have a negative sign, which would be expected for acupuncture scores, but the negative coefficient for the experience with conventional treatments is surprising. It may be that having more experience with conventional forms of painkilling treatments is linked to a history of problems with pain, as as pills tend to be the most readily available pain treatment, they may be regarded as less effective. The $R^2$ adjusted for parameters was equal to 0.4491, which is lower than the previous training set. The model was independently significant, with an $F(4,313)=65.61$, $p\le 0.0001$. Next, the performance of this model on the held out data was assessed. 

<<pilltotnotbheldout, echo=FALSE, results=tex>>=
pilltotnotb.heldout.lm <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv, data=tcq2b)
print(xtable(summary(pilltotnotb.heldout.lm), label="tab:pilltotnotbheldout", caption="Coefficients for Pill Credibility Scores, on held out data (Splits A, C and D)"))
@ 

It can be seen from Table \ref{tab:pilltotnotbheldout} that this model performs extremely well on the held out data, with a highly significant model - F(4,162)=65.79, $p\le 0.0001$, and an adjusted $R^2$ of .6096, indicating that 60\% of the variance in the Pilltotals can be explained by the predictor variables. Its worth noting that the sign of the Experience with conventional treatments variable has reversed, and is now in line with expectations. 

<<pill2blasso, echo=FALSE, results=tex>>=
pill2b <- with(tcq2notb.complete, Pilltot)
predpill2b <- tcq2notb.complete[, 72:77,79:81]
predpill2b.test <- na.omit(tcq2b[,72:77, 79:81])
pill2b.test <- with(na.omit(tcq2b), Pilltot)
pill2b.lasso <- penalisedRegression(predpill2b, pill2b, testdata=predpill2b.test, newy=pill2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(pill2b.lasso), label="tab:tcq2bpilllasso", caption="Coefficient Estimates for Lasso Regression using Pilltotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2bpilllasso} shows the estimated coefficients for this model. It can be seen that Cream and Injection credibility have a large impact on the outcome, and there are small negative coefficients for the BAM scale and the alternative credibility scores. 

Next, a ridge regression model was fit to the data. 

<<pill2bridge, echo=FALSE, results=tex>>=
pill2b.ridge <- penalisedRegression(predpill2b, pill2b, predpill2b.test, alpha=0, newy=pill2b.test, type="coefficients")
print(xtable(as.matrix(pill2b.ridge), label="tab:tcq2bpillridge", caption="Coefficient Estimates on Held Out Data for Pilltotal, Ridge Regression, Split B"))
@ 

Table \ref{tab:tcq2bpillridge} shows the estimated coefficients for the ridge regression model. It can be seen that they are mostly in line with the coefficients obtained from the lasso regression method. 

<<creamtotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
creamtotlm1.notb <- lm(Creamtot~Pilltot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
creamtot.step.notb <- stepAIC(object=creamtotlm1.notb, upper=creamtotlm1notb,lower=~1, direction="both", k=3)
creamtot.pred <- predict(creamtotlm1.notb, newdata=tcq2b)

@ 

<<creamstepb, echo=FALSE, results=tex>>=
print(xtable(summary(creamtot.step.notb), label="tab:creamtotnotbsteplm", caption="Coefficients for Cream Credibility selected by Stepwise cirtierion, Splits A, C and D"))
@ 

Table \ref{tab:creamtotnotbsteplm} shows the estimated coefficients for the regression of Creamtot on the other variables. Only four variables were retained. All other variables appear to relate in the expected fashion, as above in Split A with the exception of the coefficient on gender which suggest that being either male or female lowers levels of Cream credibility. Next, this model was tested on the validation set. 

<<creamtotnotbheldout, echo=FALSE, results=tex>>=
creamtotnotb.heldout.lm <- lm(Creamtot~Pilltot+Injtot+Acutot+Gender, data=tcq2b)
print(xtable(summary(creamtotnotb.heldout.lm), label="tab:creamtotnotbheldout", caption="Regression Coefficients for Cream Credibility Scores on held out data (Split B)"))
@ 


Table \ref{tab:creamtotnotbheldout} shows the performance of the model on the validation set. It can be seen that Pilltot and Acutot, along with Health, remain significant, but overall performance is worse than on the training set.  The model was significant; F(8,156)=13.02, $p\le 0.001$. The adjusted $R^2$ value was 0.3696.  

<<cream2blasso, echo=FALSE, results=tex>>=
cream2b <- with(tcq2notb.complete, Creamtot)
predcream2b <- tcq2notb.complete[, c(71,73:77,79:81)]
predcream2b.test <- na.omit(tcq2b[,c(71,73:77, 79:81)])
cream2b.test <- with(na.omit(tcq2b), Creamtot)
cream2b.lasso <- penalisedRegression(predcream2b, cream2b, testdata=predcream2b.test, newy=cream2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(cream2b.lasso), label="tab:tcq2bcreamlasso", caption="Coefficient Estimates for Lasso Regression using Creamtotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2bcreamlasso} shows the estimated coefficients for the lasso regression on the cream data in this split. It can be seen that not many variables got removed from the model, suggesting that all of them are associated with the response. 

Next, a ridge regression model was fit to this dataset. 

<<cream2bridge, echo=FALSE, results=tex>>=
cream2b.ridge <- penalisedRegression(predcream2b, cream2b, predcream2b.test, alpha=0, newy=cream2b.test, type="coefficients")
print(xtable(as.matrix(cream2b.ridge), label="tab:tcq2bcreamridge", caption="Coefficient Estimates on Held Out Data for Creamtotal, Ridge Regression, Split B"))
@ 

Table \ref{tab:tcq2bcreamridge} shows the estimated coefficients for the ridge regression model. It can be seen that they are mostly in line with those achieved from the lasso regression method. 

Next, the stepwise selection procedure was carried out for the Injection credibility total.

<<injtotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
injtotlm1.notb <- lm(Injtot~Pilltot+Creamtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
injtot.step.notb <- stepAIC(object=injtotlm1.notb, upper=injtotlm1notb,lower=~1, direction="both", k=3)
injtot.pred <- predict(injtotlm1.notb, newdata=tcq2b)

@ 
<<injtot2bstepwise, echo=FALSE, results=tex>>=
print(xtable(summary(injtot.step.notb), label="tab:injtotnotbsteplm", caption="Coefficients for Injection Credibility Scores using Stepwise Selection, Splits A, C and D"))
@ 
Table \ref{tab:injtotnotbsteplm} shows the performance of the model on the training data. It can be seen that Pill, Cream, Acupuncture and Reiki credibility totals are retained by the algorithm, along with experience with conventional treatments. This model's performance on the held out data was now assessed. 

<<injtotnotbheldout, echo=FALSE, results=tex>>=
injtotnotb.heldout.lm <- lm(Injtot~Pilltot+Creamtot+Acutot+Reitot+Expconv, data=tcq2b)
print(xtable(summary(injtotnotb.heldout.lm), label="tab:injtotnotbheldout", caption="Coefficients for Injection Credibility Scores on Held out data (Split B)"))
@ 

Table \ref{tab:injtotnotbheldout} shows the estimated coefficients on the held out data. It can be seen that only Pill credibility remains significant. The model is significant; F(5,159)=30.37, $p\le 0.0001$, and has an adjusted $R^2$ of .4724, which is excellent performance on the validation set. This is not really that surprising, as the Factor Analyses carried out earlier did reduce Pills and Injections to one factor in all of the five factor solutions to the TCQ. 

<<inj2blasso, echo=FALSE, results=tex>>=
inj2b <- with(tcq2notb.complete, Injtot)
predinj2b <- tcq2notb.complete[, c(71:72,74:77,79:81)]
predinj2b.test <- na.omit(tcq2b[,c(71:72,74:77, 79:81)])
inj2b.test <- with(na.omit(tcq2b), Injtot)
inj2b.lasso <- penalisedRegression(predinj2b, inj2b, testdata=predinj2b.test, newy=inj2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(inj2b.lasso), label="tab:tcq2binjlasso", caption="Coefficient Estimates for Lasso Regression using Injtotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2binjlasso} shows the estimated coefficients for the lasso model on injection credibility scores. It can be seen that the other two conventional treatments show a strong association with the outcome, while there is an effect of experience with conventional treatments and no real impact of the alternative credibility scores. 

<<inj2bridge, echo=FALSE, results=tex>>=
inj2b.ridge <- penalisedRegression(predinj2b, inj2b, predinj2b.test, alpha=0, newy=inj2b.test, type="coefficients")
print(xtable(as.matrix(inj2b.ridge), label="tab:tcq2binjridge", caption="Coefficient Estimates on Held Out Data for Injtotal, Ridge Regression, Split B"))
@ 

Table \ref{tab:tcq2binjridge} shows the estimated coefficients for the ridge regression model on injection totals. It can be seen that the coefficients are quite similar to those from the lasso regression shown above. 

Next, the stepwise selection and validation procedure was carried out on the Acupuncture total.

<<acutotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
acutotlm1.notb <- lm(Acutot~Pilltot+Creamtot+Injtot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
acutot.step.notb <- stepAIC(object=acutotlm1.notb, upper=acutotlm1notb,lower=~1, direction="both", k=3)
acutot.pred <- predict(acutotlm1.notb, newdata=tcq2b)

@ 

<<acustepb, echo=FALSE, results=tex>>=
print(xtable(summary(acutot.step.notb), label="tab:acutotnotbsteplm", caption="Coefficients for Acupuncture Credibility Scores, Selected using Stepwise criterion (k=3)"))
@ 

Table \ref{tab:acutotnotbsteplm} shows the retained coefficients following stepwise selection. Pills, Creams, Injections, Homeopathy and Reiki are left in the model by the algorithm. This model was then tested on the held out data. 

<<acutotnotbheldout, echo=FALSE, results=tex>>=
acutotnotb.heldout.lm <- lm(Acutot~Pilltot+Creamtot+Injtot+Reitot+Homtot, data=tcq2b)
print(xtable(summary(acutotnotb.heldout.lm), label="tab:acutotnotbheldout", caption="Coefficients for Stepwise Model on held out data (Split B)"))
@ 

Table \ref{tab:acutotnotbheldout} shows the estimated coefficients on the validation set. It can be seen that only the other alternative treatment variables have remained significant. The model was significant; $F(5,164)=27.91$, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.4433. 

<<acu2blasso, echo=FALSE, results=tex>>=
acu2b <- with(tcq2notb.complete, Acutot)
predacu2b <- tcq2notb.complete[, c(71:73,75:78,80:81)]
predacu2b.test <- na.omit(tcq2b[,c(71:73,75:78,80:81)])
acu2b.test <- with(na.omit(tcq2b), Acutot)
acu2b.lasso <- penalisedRegression(predacu2b, acu2b, testdata=predacu2b.test, newy=acu2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(acu2b.lasso), label="tab:tcq2baculasso", caption="Coefficient Estimates for Lasso Regression using Acutotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2baculasso} shows the coefficients for the lasso regression on the acupuncture credibility totals. It can be seen that the coefficients for the other alternative treatments are quite high, as is the coefficient for cream. This, along with some of the IRT analyses suggesting that cream is the least credible of the conventional treatments would seem to suggest that what is being measured here is the absence of faith in a treatment rather than its presence. 


<<acu2bridge, echo=FALSE, results=tex>>=
acu2b.ridge <- penalisedRegression(predacu2b, acu2b, predacu2b.test, alpha=0, newy=acu2b.test, type="coefficients")
print(xtable(as.matrix(acu2b.ridge), label="tab:tcq2bacuridge", caption="Coefficient Estimates on Held Out Data for Acutotal, Ridge Regression, Split B"))
@ 

It can be seen from Table \ref{tab:tcq2bacuridge} that the ridge regression is quite similar to the lasso fit. Interestingly enough, Pilltotal did not get shrunk as much in this model and shows a negative correlation with Acupuncture credibility (as would be expected). The strange positive correlation with Cream credibility remains.

Next, the Homeopathy total was regressed on the other predictors using stepwise selection and tested against the held out data.

<<homtotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
homtotlm1.notb <- lm(Homtot~Pilltot+Creamtot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
homtot.step.notb <- stepAIC(object=homtotlm1.notb, upper=homtotlm1notb,lower=~1, direction="both", k=3)
homtot.pred <- predict(homtotlm1.notb, newdata=tcq2b)

@ 

<<homstepb, echo=FALSE, results=tex>>=
print(xtable(summary(homtot.step.notb), label="tab:homtotnotbsteplm", caption="Coefficients for Homeopathy Credibility Scores, stepwise selection method"))
@ 

Table \ref{tab:homtotnotbsteplm} shows the estimates for the regression coefficients on the training set. It can be seen that again, Acupuncture and Reiki appear to be the best predictors, though the Cream total is strongly negatively associated with the response variable.

<<homtotnotbheldout, echo=FALSE, results=tex>>=
homtotnotb.heldout.lm <- lm(Homtot~Pilltot+Creamtot++Reitot+Acutot, data=tcq2b)
print(xtable(summary(homtotnotb.heldout.lm), label="tab:homtotnotbheldout", caption="Coefficients for Stepwise homeopathy credibility model on held out data"))
@ 

Table \ref{tab:homtotnotbheldout} shows the estimated coefficients on the validation set. It can be seen that the alternative treatments are the only ones which have remained significant. Note that the intercept is not significant, which suggests that the mean level of the response variable was not significantly different from 0 (conditional on the other variables in the model). The model itself was significant; F(4,165)=60.48, $p\le 0.0001$, and the adjusted $R^2$ of the model was equal to 0.5847. 

<<hom2blasso, echo=FALSE, results=tex>>=
hom2b <- with(tcq2notb.complete, Homtot)
predhom2b <- tcq2notb.complete[, c(71:74,76:78,80:81)]
predhom2b.test <- na.omit(tcq2b[,c(71:74,76:78,80:81)])
hom2b.test <- with(na.omit(tcq2b), Homtot)
hom2b.lasso <- penalisedRegression(predhom2b, hom2b, testdata=predhom2b.test, newy=hom2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(hom2b.lasso), label="tab:tcq2bhomlasso", caption="Coefficient Estimates for Lasso Regression using Homtotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2bhomlasso} shows the estimated coefficients for the lasso regression on homeopathy. Interestingly, the signs of Pill and Cream credibility have reversed in this mode. The largest coefficient is for Reiki, and the coefficient for Beliefs About Medicine is also quite large. 

Next, a ridge regression fit was carried out for this dataset. 

<<hom2bridge, echo=FALSE, results=tex>>=
hom2b.ridge <- penalisedRegression(predhom2b, hom2b, predhom2b.test, alpha=0, newy=hom2b.test, type="coefficients")
print(xtable(as.matrix(hom2b.ridge), label="tab:tcq2bhomridge", caption="Coefficient Estimates on Held Out Data for Homtotal, Ridge Regression, Split B"))
@ 

It can be seen from Table \ref{tab:tcq2bhomridge} that the ridge regression model gives almost the same coefficients as did the lasso fit above. 

Next, the same procedure was applied to the Reiki credibility score. 

<<reitotlmnotb, echo=FALSE, results=hide>>=
tcq2notb.full <- complete.cases(tcq2notb)
tcq2notb.complete <- tcq2notb[tcq2notb.full,]
reitotlm1.notb <- lm(Reitot~Creamtot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notb.complete)
reitot.step.notb <- stepAIC(object=reitotlm1.notb, upper=reitotlm1notb,lower=~1, direction="both", k=3)
reitot.pred <- predict(reitotlm1.notb, newdata=tcq2b)

@

<<reistepb, echo=FALSE, results=tex>>=
print(xtable(summary(reitot.step.notb), label="tab:reitotnotbsteplm", caption="Coefficients for Reiki Credibility Scores, stepwise selection method"))
@ 

Table \ref{tab:reitotnotbsteplm} shows the estimated best model from the training set. The model is smaller than usual, but all the coefficients have the expected sign. The performance of this model was then tested on heldout data. 

<<reitotnotbheldout, echo=FALSE, results=tex>>=
reitotnotb.heldout.lm <- lm(Reitot~Injtot+Acutot+Homtot, data=tcq2b)
print(xtable(summary(reitotnotb.heldout.lm), label="tab:reitotnotbheldout", caption="Regression Coefficients for Reiki Credibility Scores on Held out data (Split B)"))
@ 
Table \ref{tab:reitotnotbheldout} shows the model's performance on the held out data. All predictors remain significant, and the model was significant as a whole; $F(3,167)=78.23$, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.5768. 

<<rei2blasso, echo=FALSE, results=tex>>=
rei2b <- with(tcq2notb.complete, Reitot)
predrei2b <- tcq2notb.complete[, c(71:75,77:78,80:81)]
predrei2b.test <- na.omit(tcq2b[,c(71:75,77:78,80:81)])
rei2b.test <- with(na.omit(tcq2b), Reitot)
rei2b.lasso <- penalisedRegression(predrei2b, rei2b, testdata=predrei2b.test, newy=rei2b.test, alpha=1, type="coefficients")
print(xtable(as.matrix(rei2b.lasso), label="tab:tcq2breilasso", caption="Coefficient Estimates for Lasso Regression using Reitotal as a dependent variable, Split B"))
@ 

Table \ref{tab:tcq2breilasso} shows the estimated coefficients for this model. It can be seen that Homeopathy credibility has the largest coefficient, while almost all of the conventional credibility scores have been shrunken to zero (or almost, in the case of Injection credibility). 

Next, a ridge regression model was applied to this dataset. 

<<rei2bridge, echo=FALSE, results=tex>>=
rei2b.ridge <- penalisedRegression(predrei2b, rei2b, predrei2b.test, alpha=0, newy=rei2b.test, type="coefficients")
print(xtable(as.matrix(rei2b.ridge), label="tab:tcq2breiridge", caption="Coefficient Estimates on Held Out Data for Reitotal, Ridge Regression, Split B"))
@ 

Table \ref{tab:tcq2breiridge} shows the estimated  coefficients for a ridge regression on Reiki credibility. It can be seen that the coefficients are quite similar to those of the lasso model, further validating this solution. 



\subsubsection{Split C}
\label{sec:split-3}

Next, the same series of analyses was performed using the data from Splits A, B and D, and retaining Split C as a hold out sample. 

<<pilltotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
pilltotlm1.notc <- lm(Pilltot~Creamtot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
pilltot.step.notc <- stepAIC(object=pilltotlm1.notc, upper=pilltotlm1notc,lower=~1, direction="both", k=3)
#pilltot.pred <- predict(pilltotlm1.notc, newdata=tcq2c)


@ 

<<pillstepc, echo=FALSE, results=tex>>=
print(xtable(summary(pilltot.step.notc), label="tab:pilltotnotcsteplm", caption="Coefficients for Pill Credibility Scores, stepwise selection (Splits A, B and D)"))
@ 

The model shown in Table \ref{tab:pilltotnotcsteplm} contains almost the same four variables that were observed in Split 2 (with the inclusion of the Reiki total and the dropping of the Acupuncture total).  This suggests that these variables are likely to be truly related to Pill total credibility scores, as it is unlikely that random variation would account for the same set of four variables coming from the procedure twice in a row.  The $R^2$ for this model was equal to 0.4717, and the model was highly significant: F(4,299)=68.65, $p\le 0.0001$. These p values and test statistics are likely to be biased due to the automated inclusion and exclusion of variables for the model, and the true test is in the performance of the model on held-out data. 

<<pilltotnotbheldout, echo=FALSE, results=tex>>=
pilltotnotc.heldout.lm <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv, data=tcq2c)
print(xtable(summary(pilltotnotc.heldout.lm), label="tab:pilltotnotcheldout", caption="Performance of Stepwise Model on Held Out Data (split C)"))
@ 

This model did not fit quite as well as that in Split 2, but nonetheless, performance was acceptable. Table \ref{tab:pilltotnotcheldout} shows the estimated regression coefficients. While Cream and Injection credibility scores are still highly significant, Reiki and Experience with Conventional Treatments do not perform well on the held out data. The model itself is still highly significant; F(4,154)=34.53, $p\le 0.001$ and the adjusted $R^2$ is equal to 0.4591. 

<<pill2classo, echo=FALSE, results=tex>>=
pill2c <- with(tcq2notb.complete, Pilltot)
predpill2c <- tcq2notb.complete[, 72:77,79:81]
predpill2c.test <- na.omit(tcq2c[,72:77, 79:81])
pill2c.test <- with(na.omit(tcq2c), Pilltot)
pill2c.lasso <- penalisedRegression(predpill2c, pill2c, testdata=predpill2c.test, newy=pill2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(pill2c.lasso), label="tab:tcq2cpilllasso", caption="Coefficient Estimates for Lasso Regression using Pilltotal as a dependent variable, Split C"))
@ 



Table \ref{tab:tcq2cpilllasso} shows the estimated coefficients for the lasso model in this split. It can be seen that the other conventional treatments have quite high coefficients, while those of the alternative treatments have quite small negative coefficients, in line with expectations. 

Next, a ridge regression model was fit to this variable. 

<<pill2cridge, echo=FALSE, results=tex>>=
pill2c.ridge <- penalisedRegression(predpill2c, pill2c, predpill2c.test, alpha=0, newy=pill2c.test, type="coefficients")
print(xtable(as.matrix(pill2c.ridge), label="tab:tcq2cpillridge", caption="Coefficient Estimates on Held Out Data for Pilltotal, Ridge Regression, Split C"))
@ 

Table \ref{tab:tcq2cpillridge} shows the estimated coefficients for the ridge model, and there are quite similar to those of the lasso model. 


<<creamtotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
creamtotlm1.notc <- lm(Creamtot~Creamtot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
creamtot.step.notc <- stepAIC(object=creamtotlm1.notc, upper=creamtotlm1notc,lower=~1, direction="both", k=3)
#creamtot.pred <- predict(creamtotlm1.notc, newdata=tcq2c)

@ 

<<creamstepc, echo=FALSE, results=tex>>=
print(xtable(summary(creamtot.step.notc), label="tab:creamtotnotcsteplm", caption="Coefficients for Cream Credibility Stepwise Selection Method (Splits A, B and D)"))
@ 

Table \ref{tab:creamtotnotcsteplm} shows the estimated coefficients for the regression of cream total against the other predictor variables, using a forwards and backwards stepwise algorithm.  It can be seen that Injection, Acupuncture, Experience with Alternative Treatments and Health all appear to be good predictors on the basis of this model. Next, the model is tested against the validation set. 

<<creamtotnotbheldout, echo=FALSE, results=tex>>=
creamtotnotc.heldout.lm <- lm(Creamtot~Injtot+Acutot+Expalt+Health, data=tcq2c)
print(xtable(summary(creamtotnotc.heldout.lm), label="tab:creamtotnotcheldout", caption="Performance of Stepwise Model for Cream Credibility Scores on Held Out Data (Split C)"))
@ 

Table \ref{tab:creamtotnotcheldout} shows that only Injection total remains significant on the validation set. The model was significant; F(4,153)=18.22, $p\le 0.00001$. The adjusted $R^2$ for the model was equal to 0.3049. 

<<cream2classo, echo=FALSE, results=tex>>=
cream2c <- with(tcq2notb.complete, Creamtot)
predcream2c <- tcq2notb.complete[, c(71,73:77,79:81)]
predcream2c.test <- na.omit(tcq2c[,c(71,73:77,79:81)])
cream2c.test <- with(na.omit(tcq2c), Creamtot)
cream2c.lasso <- penalisedRegression(predcream2c, cream2c, testdata=predcream2c.test, newy=cream2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(cream2c.lasso), label="tab:tcq2ccreamlasso", caption="Coefficient Estimates for Lasso Regression using Creamtotal as a dependent variable, Split B"))
@ 


Table \ref{tab:tcq2ccreamlasso} shows the estimated coefficients for the lasso regression model in this split. It can be seen that the other conventional treatments appear to exert a strong impact on the scores, and there are some negative correlations between Cream credibility and and the alternative treatments, which is to be expected. 

<<cream2cridge, echo=FALSE, results=tex>>=
cream2c.ridge <- penalisedRegression(predcream2c, cream2c, predcream2c.test, alpha=0, newy=cream2c.test, type="coefficients")
print(xtable(as.matrix(cream2c.ridge), label="tab:tcq2ccreamridge", caption="Coefficient Estimates on Held Out Data for Creamtotal, Ridge Regression, Split C"))
@ 


Table \ref{tab:tcq2ccreamridge} shows the estimated coefficients from the ridge regression model. It can be seen that these are quite similar to the coefficients from the lasso regression. 

Next, the stepwise selection and validation procedure was applied to the Injection credibility scores.

<<injtotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
injtotlm1.notc <- lm(Injtot~Creamtot+Pilltot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
injtot.step.notc <- stepAIC(object=injtotlm1.notc, upper=injtotlm1notc,lower=~1, direction="both", k=3)
#injtot.pred <- predict(injtotlm1.notc, newdata=tcq2c)

@ 


<<injstepc, echo=FALSE, results=tex>>=
print(xtable(summary(injtot.step.notc), label="tab:injtotnotcsteplm", caption="Coefficients for Injection Credibility Scores, stepwise Selection, Splits A, B and D"))
@ 

Table \ref{tab:injtotnotcsteplm} shows that the algorithm retained three variables, Creamtotal, Pilltotal and Experience with conventional treatments, all with positive loadings as expected. Next, the fit of this model was examined on the validation data. 

<<injtotnotbheldout, echo=FALSE, results=tex>>=
injtotnotc.heldout.lm <- lm(Injtot~Creamtot+Pilltot+Expconv, data=tcq2c)
print(xtable(summary(injtotnotc.heldout.lm), label="tab:injtotnotcheldout", caption="Coefficients from Stepwise model, Injection Credibility on Held out data (Split C)"))
@ 

Table \ref{tab:injtotnotcheldout} shows that all three variables remained significant when tested on the validation set. The model was significant; $F(3,159)=46.77$, $p\le 0.0001$ and had an adjusted $R^2$ of 0.4587. 


<<inj2classo, echo=FALSE, results=tex>>=
inj2c <- with(tcq2notb.complete, Injtot)
predinj2c <- tcq2notb.complete[, c(71:72,74:77,79:81)]
predinj2c.test <- na.omit(tcq2c[,c(71:72,74:77,79:81)])
inj2c.test <- with(na.omit(tcq2c), Injtot)
inj2c.lasso <- penalisedRegression(predinj2c, inj2c, testdata=predinj2c.test, newy=inj2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(inj2c.lasso), label="tab:tcq2cinjlasso", caption="Coefficient Estimates for Lasso Regression using Injtotal as a dependent variable, Split C"))
@ 

Table \ref{tab:tcq2cinjlasso} shows the estimates for the injection credibility model. Ity can be seen that there are large coefficients for the othe two conventional treatments, while those for the alternative treatments have been sunk nearly to zero. 

Next a ridge regression model was applied to this dataset.

<<inj2cridge, echo=FALSE, results=tex>>=
inj2c.ridge <- penalisedRegression(predinj2c, inj2c, predinj2c.test, alpha=0, newy=inj2c.test, type="coefficients")
print(xtable(as.matrix(inj2c.ridge), label="tab:tcq2cinjridge", caption="Coefficient Estimates on Held Out Data for Injtotal, Ridge Regression, Split C"))
@ 

Table \ref{tab:tcq2cinjridge} shows the estimated coefficients for the ridge regression model. It can be seen that the estimated coefficients and patterns are quite similar to that seen with the lasso regression model. 
Note that experience with alternative treatments correlated negatively with the credibility scores for injections in both models, which is interesting. 

Next, this procedure was applied to the Acupuncture mean score in Split C. 

<<acutotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
acutotlm1.notc <- lm(Acutot~Creamtot+Pilltot+Injtot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
acutot.step.notc <- stepAIC(object=acutotlm1.notc, upper=acutotlm1notc,lower=~1, direction="both", k=3)
#acutot.pred <- predict(acutotlm1.notc, newdata=tcq2c)

@ 

<<acustepc, echo=FALSE, results=tex>>=
print(xtable(summary(acutot.step.notc), label="tab:acutotnotcsteplm", caption="Coefficients for Acupuncture Credibility Scores, Stepwise Selection (Splits A, B and D)"))
@ 

Table \ref{tab:acutotnotcsteplm} shows the best model as selected by the algorithm. It consists of three predictors, which will now be tested on the validation set. 

<<acutotnotbheldout, echo=FALSE, results=tex>>=
acutotnotc.heldout.lm <- lm(Acutot~Creamtot+Homtot+Reitot, data=tcq2c)
print(xtable(summary(acutotnotc.heldout.lm), label="tab:acutotnotcheldout", caption="Coefficients for Stepwise Model Acupuncture Credibility on Held out data (Split C)"))
@ 
As shown in Table \ref{tab:acutotnotcheldout}, the fit on the validation set was extremely similiar to that observed on the training set. The model was significant, $F(3,158)=35.94$, $p\le 0.0001$, and the model had an adjusted $R^2$ of 0.3943. 

<<acu2classo, echo=FALSE, results=tex>>=
acu2c <- with(tcq2notb.complete, Acutot)
predacu2c <- tcq2notb.complete[, c(71:73,75:78,80:81)]
predacu2c.test <- na.omit(tcq2c[,c(71:73,75:78,80:81)])
acu2c.test <- with(na.omit(tcq2c), Acutot)
acu2c.lasso <- penalisedRegression(predacu2c, acu2c, testdata=predacu2c.test, newy=acu2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(acu2c.lasso), label="tab:tcq2caculasso", caption="Coefficient Estimates for Lasso Regression using Acutotal as a dependent variable, Split C"))
@ 
Table \ref{tab:tcq2caculasso} shows the coefficient estimates for the lasso regression on Acupuncture credibility. Again, in common with previous splits, the cream credibility total has a positive correlation with the response variable. This coefficient is similar in magnitude to those of the alternative treatments, so it suggests that there is a pattern of similarity to how these treatments are perceived by participants. Again, like in previous splits, there is a negative coefficient for pill credibility on this outcome measure. 

Next a ridge regression model was applied to this split. 

<<acu2cridge, echo=FALSE, results=tex>>=
acu2c.ridge <- penalisedRegression(predacu2c, acu2c, predacu2c.test, alpha=0, newy=acu2c.test, type="coefficients")
print(xtable(as.matrix(acu2c.ridge), label="tab:tcq2cacuridge", caption="Coefficient Estimates on Held Out Data for Acutotal, Ridge Regression, Split C"))
@ 

Table \ref{tab:tcq2cacuridge} shows the estimated coefficients from the ridge regression model. It can be seen that the cream coefficient is still of similar magnitude as are the other coefficients. Experience with alternative treatments has a large coefficient, which is what would be expected. 

<<homtotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
homtotlm1.notc <- lm(Homtot~Creamtot+Pilltot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
homtot.step.notc <- stepAIC(object=homtotlm1.notc, upper=homtotlm1notc,lower=~1, direction="both", k=3)
## homtot.pred <- predict(homtotlm1.notc, newdata=tcq2c)

@ 

<<homstepc, echo=FALSE, results=tex>>=
print(xtable(summary(homtot.step.notc), label="tab:homtotnotcsteplm", caption="Coefficients for Homeopathy Credibility Scores, stepwise selection method (Splits A, B and D)"))
@ 

Table \ref{tab:homtotnotcsteplm} shows the selected model output from the stepwise procedure. This model was then fit to the validation set, and its fit examined. 

<<homtotnotbheldout, echo=FALSE, results=tex>>=
homtotnotc.heldout.lm <- lm(Homtot~Acutot+Reitot+Expalt, data=tcq2c)
print(xtable(summary(homtotnotc.heldout.lm), label="tab:homtotnotcheldout", caption="Performance of Stepwise Selected Model Acupuncture Credibility on Held out data (Split C)"))
@ 

Table \ref{tab:homtotnotcheldout} shows that all the variables remained significant on the validation set (with the exception of the intercept). The model was significant; $F(3,152)=57$, $p\le 0.0001$ and had an adjusted $R^2$ of 0.5201.

<<hom2classo, echo=FALSE, results=tex>>=
hom2c <- with(tcq2notb.complete, Homtot)
predhom2c <- tcq2notb.complete[, c(71:74,76:78,80:81)]
predhom2c.test <- na.omit(tcq2c[,c(71:74,76:78,80:81)])
hom2c.test <- with(na.omit(tcq2c), Homtot)
hom2c.lasso <- penalisedRegression(predhom2c, hom2c, testdata=predhom2c.test, newy=hom2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(hom2c.lasso), label="tab:tcq2chomlasso", caption="Coefficient Estimates for Lasso Regression using Homtotal as a dependent variable, Split C"))
@ 

Table \ref{tab:tcq2chomlasso} shows the estimated coefficients for the lasso model on acupuncture credibility in this split. It can be seen that, consistent with previous splits, cream credibility now has a negative coefficient while Pilltotal has a positive one. Again, however, the two other forms of alternative treatment make a much greater contribution to the model. 



<<hom2cridge, echo=FALSE, results=tex>>=
hom2c.ridge <- penalisedRegression(predhom2c, hom2c, predhom2c.test, alpha=0, newy=hom2c.test, type="coefficients")
print(xtable(as.matrix(hom2c.ridge), label="tab:tcq2chomridge", caption="Coefficient Estimates on Held Out Data for Homtotal, Ridge Regression, Split C"))
@ 

Table \ref{tab:tcq2chomridge} shows the estimated coefficients for the ridge regression model in this split. It can be seen that the major patterns from the lasso fit above remain unchanged. 


<<reitotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
reitotlm1.notc <- lm(Reitot~Creamtot+Pilltot+Injtot+Acutot+Homtot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
reitot.step.notc <- stepAIC(object=reitotlm1.notc, upper=reitotlm1.notc,lower=~1, direction="both", k=3)
## reitot.pred <- predict(reitot.step.notc, newdata=tcq2c)

@ 

<<reistepc, echo=FALSE, results=tex>>=
print(xtable(summary(reitot.step.notc), label="tab:reitotnotcsteplm", caption="Coefficients on Reiki Credibility Model, stepwise selection (Splits A, B and D"))
@ 

Table \ref{tab:reitotnotcsteplm} shows the selected model and the predictor's estimated coefficients. It can be seen that Injections, Homeopathy and Reiki were the only retained coefficients. Next, this model was tested on the validation set. 

<<reitotnotbheldout, echo=FALSE, results=tex>>=
reitotnotc.heldout.lm <- lm(Reitot~Acutot+Injtot+Homtot, data=tcq2c)
print(xtable(summary(reitotnotc.heldout.lm), label="tab:reitotnotcheldout", caption="Performance of Reiki Credibility Model on Held out data, Split C"))
@ 
As Table \ref{tab:reitotnotcheldout} shows, all of the coefficients selected on the training set remained significant on the validation set. The model was significant; F(3,158)=68.36, $p\le 0.0001$. The adjusted $R^2$ was equal to 0.5566.

<<rei2classo, echo=FALSE, results=tex>>=
rei2c <- with(tcq2notb.complete, Reitot)
predrei2c <- tcq2notb.complete[, c(71:75,77:78,80:81)]
predrei2c.test <- na.omit(tcq2c[,c(71:75,77:78,80:81)])
rei2c.test <- with(na.omit(tcq2c), Reitot)
rei2c.lasso <- penalisedRegression(predrei2c, rei2c, testdata=predrei2c.test, newy=rei2c.test, alpha=1, type="coefficients")
print(xtable(as.matrix(rei2c.lasso), label="tab:tcq2creilasso", caption="Coefficient Estimates for Lasso Regression using Reitotal as a dependent variable, Split C"))
@ 

Table \ref{tab:tcq2creilasso} shows the estimated coefficients for a lasso regression on Reiki credibility scores. Ity can be seen that, similarly to previous splits, homeopathy credibility scores have the largest coefficient, while Pills and Injections have small negative coefficients. Strangely, the beliefs about medicine totals are negatively associated with the response variable, which is unexpected. 

<<rei2cridge, echo=FALSE, results=tex>>=
rei2c.ridge <- penalisedRegression(predrei2c, rei2c, predrei2c.test, alpha=0, newy=rei2c.test, type="coefficients")
print(xtable(as.matrix(rei2c.ridge), label="tab:tcq2creiridge", caption="Coefficient Estimates on Held Out Data for Reitotal, Ridge Regression, Split C"))
@ 

Table \ref{tab:tcq2creiridge} that the two alternative treatments have large  positive coefficients, while the conventional treatments have small negative ones. The overall pattern is quite similar to the lasso fit shown above. 

<<bamtotlmnotc, echo=FALSE, results=hide>>=
tcq2notc.full <- complete.cases(tcq2notc)
tcq2notc.complete <- tcq2notc[tcq2notc.full,]
bamtotlm1.notc <- lm(Bamtot~Creamtot+Pilltot+Injtot+Acutot+Homtot+Expalt+Expconv+Gender+Income+Health, data=tcq2notc.complete)
bamtot.step.notc <- stepAIC(object=bamtotlm1.notc, upper=bamtotlm1notc,lower=~1, direction="both", k=3)
## bamtot.pred <- predict(bamtot.step.notc, newdata=tcq2c)

@ 
<<bam2cstepwiseprint, echo=FALSE, results=tex>>=
print(xtable(summary(bamtot.step.notc), label="tab:bamtotnotcsteplm", caption="Coefficients on Beliefs About Medicine Questionnaire Model, stepwise selection (Splits A, B and D)"))
@ 
Table \ref{tab:bamtotnotcsteplm} shows the estimated best model for the BAM total. This model's fit was then tested on the validation  set.

<<bamtotnotbheldout, echo=FALSE, results=tex>>=
bamtotnotc.heldout.lm <- lm(Bamtot~Creamtot+Pilltot+Homtot+Expconv+Income+Health, data=tcq2c)
print(xtable(summary(bamtotnotc.heldout.lm), label="tab:bamtotnotcheldout", caption="Performance of Beliefs About Medicine Model on Held out data, SplitC"))
@ 

Table \ref{tab:bamtotnotcheldout} shows the model's performance on the held out data. It can be seen that Homeopathy, experience with conventional treatments and Income are no longer significant. The model itself was significant; F(6,145)=7.059, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.194. 


\subsubsection{Split D}

\label{sec:split-4}

Finally, the same procedure was repeated on Split D, which uses Splits A, B and C as the training data, and Split D as the held out validation set. 

<<pilltotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
pilltotlm1.notd <- lm(Pilltot~Creamtot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
pilltot.step.notd <- stepAIC(object=pilltotlm1.notd, upper=pilltotlm1.notd,lower=~1, direction="both", k=3)
pilltot.pred <- predict(pilltotlm1.notd, newdata=tcq2d)

@ 

<<pillstepd, echo=FALSE, results=tex>>=
print(xtable(summary(pilltot.step.notd), label="tab:pilltotnotdsteplm",caption="Coefficients on Pill Credibility Model, stepwise selection (Splits A, B and C"))
@ 

Table \ref{tab:pilltotnotdsteplm} shows the estimated coefficients on the training data. The same core group of predictors are seen in the results, and Gender appears to be a useful predictor on this sub-sample of the data. This is the first appearance of a demographic variable in the final set, although the coefficients are quite small, as are the estimated t values. The model is significant: F(6,283)=48.4, with an adjusted $R^2$ of 0.496, which is line with results on previous splits.

Next, this model is tested on the held out data set. 

<<pilltotnotbheldout, echo=FALSE, results=tex>>=
pilltotnotd.heldout.lm <- lm(Pilltot~Creamtot+Injtot+Acutot+Expconv+Gender, data=tcq2d)
print(xtable(summary(pilltotnotd.heldout.lm), label="tab:pilltotnotdheldout", caption="Performance of Pill Credibility Model on Held out data, Split D"))
@ 
Table \ref{tab:pilltotnotdheldout} shows the results of fitting the trained model to the heldout data. It can be seen that Creams, Injections and Acupuncture are significant, while Experience and Gender are not. The adjusted $R^2$ value is equal to 0.3822, the lowest of all the splits, while the model is significant; F(6,201)=22.34, with a p-value of $p\le 0.001$. 

<<pill2dlasso, echo=FALSE, results=tex>>=
pill2d <- with(tcq2notb.complete, Pilltot)
predpill2d <- tcq2notb.complete[, 72:77,79:81]
predpill2d.test <- na.omit(tcq2d[,72:77, 79:81])
pill2d.test <- with(na.omit(tcq2d), Pilltot)
pill2d.lasso <- penalisedRegression(predpill2d, pill2d, testdata=predpill2d.test, newy=pill2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(pill2d.lasso), label="tab:tcq2dpilllasso", caption="Coefficient Estimates for Lasso Regression using Pilltotal as a dependent variable, Split D"))
@ 

Table \ref{tab:tcq2dpilllasso} shows the estimated coefficients for a lasso regession on pill credibility in this split. It can be seen that a similar pattern emerges as was seen in previous splits, with large positive coefficients from the other conventional treatments, and small negative ones for the alternative treatments. 


<<pill2dridge, echo=FALSE, results=tex>>=
pill2d.ridge <- penalisedRegression(predpill2d, pill2d, predpill2d.test, alpha=0, newy=pill2d.test, type="coefficients")
print(xtable(as.matrix(pill2d.ridge), label="tab:tcq2dpillridge", caption="Coefficient Estimates on Held Out Data for Pilltotal, Ridge Regression, Split D"))
@ 

Table \ref{tab:tcq2dpillridge} shows the estimates coefficients for the ridge regression model on Pill Credibility scores. It can be seen that the model is extremely similar to that of the lasso fit referenced earlier. 

<<creamtotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
creamtotlm1.notd <- lm(Creamtot~Pilltot+Injtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
creamtot.step.notd <- stepAIC(object=creamtotlm1.notd, upper=creamtotlm1.notd,lower=~1, direction="both", k=3)
creamtot.pred <- predict(creamtotlm1.notd, newdata=tcq2d)

@ 

<<creamstepd, echo=FALSE, results=tex>>=
print(xtable(summary(creamtot.step.notd), label="tab:creamtotnotdsteplm",caption="Coefficients on Cream Credibility Model, stepwise selection (Splits A, B and C)"))
@ 

Table \ref{tab:creamtotnotdsteplm} shows the estimated coefficients on the regression of Cream credibility scores on the training set. It can be seen that six predictors were retained, Pills, Injections, Acupcunture, Experience with alternative treatment, experience with conventional treatments and Gender. The next step was to examine the performance of the model on the held-out data.

<<creamtotnotbheldout, echo=FALSE, results=tex>>=
creamtotnotd.heldout.lm <- lm(Creamtot~Pilltot+Injtot+Acutot+Expconv+Expalt+Gender, data=tcq2d)
print(xtable(summary(creamtotnotd.heldout.lm), label="tab:creamtotnotdheldout", caption="Performance of Cream Credibility Model on Held out data, Split D"))
@ 

Table \ref{tab:creamtotnotdheldout} shows the performance of the model on the held out data. It can be seen that Injections, Acupuncture, Experience with Treatments are no longer significant, while Pill credibility still is.The model is significant; F(7,193)=12.49, $p\le 0.0001$ and has an adjusted $R^2$ value of 0.2868, which is quite poor. 

<<cream2dlasso, echo=FALSE, results=tex>>=
cream2d <- with(tcq2notb.complete, Creamtot)
predcream2d <- tcq2notb.complete[, c(71,73:77,79:81)]
predcream2d.test <- na.omit(tcq2d[,c(71,73:77, 79:81)])
cream2d.test <- with(na.omit(tcq2d), Creamtot)
cream2d.lasso <- penalisedRegression(predcream2d, cream2d, testdata=predcream2d.test, newy=cream2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(cream2d.lasso), label="tab:tcq2dcreamlasso", caption="Coefficient Estimates for Lasso Regression using Creamtotal as a dependent variable, Split D"))
@ 

Table \ref{tab:tcq2dcreamlasso} shows the estimated coefficients for the lasso fit on the cream credibility totals. It can be seen that the major contributions come from the other conventional treatments, along with acupuncture. There's quite a large negative coefficient for BAM totals, also. 

<<cream2dridge, echo=FALSE, results=tex>>=
cream2d.ridge <- penalisedRegression(predcream2d, cream2d, predcream2d.test, alpha=0, newy=cream2d.test, type="coefficients")
print(xtable(as.matrix(cream2d.ridge), label="tab:tcq2dcreamridge", caption="Coefficient Estimates on Held Out Data for Creamtotal, Ridge Regression, Split D"))
@ 

Table \ref{tab:tcq2dcreamridge} shows the estimated coefficients for the ridge regression model on this variable. It can be seen that the coefficients are extremely similar to those obtained from the lasso fit above. 

Next, the same procedure was applied to the Injection credibility totals for this split. 

<<injtotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
injtotlm1.notd <- lm(Injtot~Pilltot+Creamtot+Acutot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
injtot.step.notd <- stepAIC(object=injtotlm1.notd, upper=injtotlm1.notd,lower=~1, direction="both", k=3)
injtot.pred <- predict(injtotlm1.notd, newdata=tcq2d)

@ 

<<injstepd, echo=FALSE, results=tex>>=
print(xtable(summary(injtot.step.notd), label="tab:injtotnotdsteplm",caption="Coefficients on Injection Credibility Model, stepwise selection (Splits A, B and C)"))
@ 

It can be seen from Table \ref{tab:injtotnotdsteplm} that the algorithm retained five predictor variables, which is greater than has been seen in previous splits. Next, the performance of this model on the held out data was assessed. 

<<injtotnotbheldout, echo=FALSE, results=tex>>=
injtotnotd.heldout.lm <- lm(Injtot~Pilltot+Creamtot+Acutot+Expconv+Reitot, data=tcq2d)
print(xtable(summary(injtotnotd.heldout.lm), label="tab:injtotnotdheldout", caption="Performance of Injection Credibility Model on Held out data, Split D"))
@ 

Table \ref{tab:injtotnotdheldout} shows the estimated coefficients for this model on the held-out data. It can be seen that Pill credibility scores and Experience with conventional treatments are the only variables that remain significant. The model was significant: F(5,201)=13.46, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.2321, which is extremely poor. 

<<inj2dlasso, echo=FALSE, results=tex>>=
inj2d <- with(tcq2notb.complete, Injtot)
predinj2d <- tcq2notb.complete[, c(71:72,74:77,79:81)]
predinj2d.test <- na.omit(tcq2d[,c(71:72,74:77, 79:81)])
inj2d.test <- with(na.omit(tcq2d), Injtot)
inj2d.lasso <- penalisedRegression(predinj2d, inj2d, testdata=predinj2d.test, newy=inj2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(inj2d.lasso), label="tab:tcq2dinjlasso", caption="Coefficient Estimates for Lasso Regression using Injtotal as a dependent variable, Split D"))
@ 

As can be seen from Table \ref{tab:tcq2dinjlasso}, the conventional variables both had large coefficients, while those for the alternative treatments were shrunk almost entirely towards zero. Experience with conventional treatments also had a relatively large coefficient. 

<<inj2dridge, echo=FALSE, results=tex>>=
inj2d.ridge <- penalisedRegression(predinj2d, inj2d, predinj2d.test, alpha=0, newy=inj2d.test, type="coefficients")
print(xtable(as.matrix(inj2d.ridge), label="tab:tcq2dinjridge", caption="Coefficient Estimates on Held Out Data for Injtotal, Ridge Regression, Split D"))
@ 

As shown in Table \ref{tab:tcq2dinjridge}, the coefficients for the ridge fit were almost identical to those from the lasso fit, reinforcing our belief in the model. 

Next, a model was built and tested on the Acupuncture credibility scores. 

<<acutotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
acutotlm1.notd <- lm(Acutot~Pilltot+Creamtot+Injtot+Homtot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
acutot.step.notd <- stepAIC(object=acutotlm1.notd, upper=acutotlm1.notd,lower=~1, direction="both", k=3)
acutot.pred <- predict(acutotlm1.notd, newdata=tcq2d)

@ 


<<acustepd, echo=FALSE, results=tex>>=
print(xtable(summary(acutot.step.notd), label="tab:acutotnotdsteplm",caption="Coefficients on Acupuncture Credibility Model, stepwise selection (Splits A, B and C)"))
@ 

Table \ref{tab:acutotnotdsteplm} shows that the algorithm retained five predictors in this case. Their fit was then examined on the held out data.

<<acutotnotdheldout, echo=FALSE, results=tex>>=
acutotnotd.heldout.lm <- lm(Acutot~Pilltot+Creamtot+Injtot+Homtot+Reitot, data=tcq2d)
print(xtable(summary(acutotnotd.heldout.lm), label="tab:acutotnotdheldout", caption="Performance of Acupuncture Credibility Model on Held out data, Split D"))
@ 

Table \ref{tab:acutotnotdheldout} shows the performance of the model on the held out data. It can be seen that only Homeopathy and Reiki credibility scores remain significant on this data set. The model was significant: F(5,203)=18.78, $p\le 0.0001$, and the adjusted $R^2$ of the model was equal to 0.2995, which is quite poor. 

<<acu2dlasso, echo=FALSE, results=tex>>=
acu2d <- with(tcq2notb.complete, Acutot)
predacu2d <- tcq2notb.complete[, c(71:73,75:78,80:81)]
predacu2d.test <- na.omit(tcq2d[,c(71:73,75:78, 80:81)])
acu2d.test <- with(na.omit(tcq2d), Acutot)
acu2d.lasso <- penalisedRegression(predacu2d, acu2d, testdata=predacu2d.test, newy=acu2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(acu2d.lasso), label="tab:tcq2daculasso", caption="Coefficient Estimates for Lasso Regression using Acutotal as a dependent variable, Split D"))
@ 

Table \ref{tab:tcq2daculasso} shows the estimated coefficients for the lasso model on Acupuncture credibility scores. It can be seen that there is a positive coefficient for cream credibility again, along with a negative coefficient for Pill credibility. As per usual, the two other alternative treatments had positive coefficients. 

<<acu2dridge, echo=FALSE, results=tex>>=
acu2d.ridge <- penalisedRegression(predacu2d, acu2d, predacu2d.test, alpha=0, newy=acu2d.test, type="coefficients")
print(xtable(as.matrix(acu2d.ridge), label="tab:tcq2dacuridge", caption="Coefficient Estimates on Held Out Data for Acutotal, Ridge Regression, Split D"))
@ 

Table \ref{tab:tcq2dacuridge} shows the estimated coefficients for the ridge regression model on this dataset. It can be seen that the fit is quite similar to the lasso fit reported earlier, and consistent with what was seen in other splits. 

Next, the model development and validation procedure was applied to the Homeopathy credibility scores. 

<<homtotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
homtotlm1.notd <- lm(Homtot~Pilltot+Creamtot+Injtot+Acutot+Reitot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
homtot.step.notd <- stepAIC(object=homtotlm1.notd, upper=homtotlm1.notd,lower=~1, direction="both", k=3)
homtot.pred <- predict(homtotlm1.notd, newdata=tcq2d)

@ 

<<homstepd, echo=FALSE, results=tex>>=
print(xtable(summary(homtot.step.notd), label="tab:homtotnotdsteplm",caption="Coefficients on Homeopathy Credibility Model, stepwise selection (Splits A, B and C)"))
@ 

Table \ref{tab:homtotnotdsteplm} shows the retained predictors from the procedure for the Homeopathy credibility scores. It can be seen that only three were retained in this regression. Next, this model was fitted to the held out data.

<<homtotnotbheldout, echo=FALSE, results=tex>>=
homtotnotd.heldout.lm <- lm(Homtot~Acutot+Reitot+Expalt, data=tcq2d)
print(xtable(summary(homtotnotd.heldout.lm), label="tab:homtotnotdheldout", caption="Performance of Homeopathy Credibility Model on Held out data, Split D"))
@ 

Table \ref{tab:homtotnotdheldout} shows the performance of the model on the heldout data. It can be seen that both Acupuncture and Reiki remain extremely significant, but experience with alternative treatments does not. The model was significant: F(3,200)=75.17, $p\le 0.0001$, and the adjusted $R^2$ for the model was equal to 0.5229, which is extremely good performance. 

<<hom2dlasso, echo=FALSE, results=tex>>=
hom2d <- with(tcq2notb.complete, Homtot)
predhom2d <- tcq2notb.complete[, c(71:74,76:78,80:81)]
predhom2d.test <- na.omit(tcq2d[,c(71:74,76:78, 80:81)])
hom2d.test <- with(na.omit(tcq2d), Homtot)
hom2d.lasso <- penalisedRegression(predhom2d, hom2d, testdata=predhom2d.test, newy=hom2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(hom2d.lasso), label="tab:tcq2dhomlasso", caption="Coefficient Estimates for Lasso Regression using Homtotal as a dependent variable, Split D"))
@ 

Table \ref{tab:tcq2dhomlasso} shows the estimated coefficients for a lasso regression fit on the Homeopathy credibility scores in this split. It can be seen that the pattern with cream and pill scores has again replicated, suggesting that it is not due to random sampling. In fact, all of the coefficients are very similar to what was seen in the other splits. 

<<hom2dridge, echo=FALSE, results=tex>>=
hom2d.ridge <- penalisedRegression(predhom2d, hom2d, predhom2d.test, alpha=0, newy=hom2d.test, type="coefficients")
print(xtable(as.matrix(hom2d.ridge), label="tab:tcq2dhomridge", caption="Coefficient Estimates on Held Out Data for Homtotal, Ridge Regression, Split D"))
@ 

Table \ref{tab:tcq2dhomridge} shows the estimated coefficients for the ridge regression fit on the Homeopathy credibility scores. It can be seen that the same pattern as was seen with the lasso fit has emerged from this data. 

Next, the model selection and validation procedure was applied to the Reiki credibility scores. 

<<reitotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
reitotlm1.notd <- lm(Reitot~Pilltot+Creamtot+Injtot+Acutot+Homtot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
reitot.step.notd <- stepAIC(object=reitotlm1.notd, upper=reitotlm1.notd,lower=~1, direction="both", k=3)
reitot.pred <- predict(reitotlm1.notd, newdata=tcq2d)

@ 

<<reikinotd, echo=FALSE, results=tex>>=
print(xtable(summary(reitot.step.notd), label="tab:reitotnotdsteplm",caption="Coefficients on Reiki Credibility Model, stepwise selection (Splits A, B and C)"))
@ 

Table \ref{tab:reitotnotdsteplm} shows the retained coefficients for the Reiki credibility scores regression. The algorithm has only retained three predictors, which is a little lower than in previous splits. Next, the fit of these predictors was examined on the held out data. 

<<reitotnotdheldout, echo=FALSE, results=tex>>=
reitotnotd.heldout.lm <- lm(Reitot~Acutot+Homtot+Injtot, data=tcq2d)
print(xtable(summary(reitotnotd.heldout.lm), label="tab:reitotnotdheldout", caption="Performance of Reiki Credibility Model on Held out data, Split D"))
@ 

Table \ref{tab:reitotnotdheldout} shows the performance of these predictors on the heldout data. It can be seen that both acupuncture and homeopathy remain significant, but Injections does not. The model was significant: F(3,206)=75.43, $p\le 0.0001$, and the adjusted $R^2$ was equal to 0.5165, which is extremely good. 

<<rei2dlasso, echo=FALSE, results=tex>>=
rei2d <- with(tcq2notb.complete, Reitot)
predrei2d <- tcq2notb.complete[, c(71:75,77:78,80:81)]
predrei2d.test <- na.omit(tcq2d[,c(71:75,77:78, 80:81)])
rei2d.test <- with(na.omit(tcq2d), Reitot)
rei2d.lasso <- penalisedRegression(predrei2d, rei2d, testdata=predrei2d.test, newy=rei2d.test, alpha=1, type="coefficients")
print(xtable(as.matrix(rei2d.lasso), label="tab:tcq2dreilasso", caption="Coefficient Estimates for Lasso Regression using Reitotal as a dependent variable, Split D"))
@ 
Table \ref{tab:tcq2dreilasso} shows the estimated coefficients for the lasso fit on Reiki credibility scores. It can be seen that most of the conventional treatment scores have been removed from the model and that the only major predictors were the other alternative credibility scores, in contrast to previous splits. 

<<rei2dridge, echo=FALSE, results=tex>>=
rei2d.ridge <- penalisedRegression(predrei2d, rei2d, predrei2d.test, alpha=0, newy=rei2d.test, type="coefficients")
print(xtable(as.matrix(rei2d.ridge), label="tab:tcq2dreiridge", caption="Coefficient Estimates on Held Out Data for Reitotal, Ridge Regression, Split D"))
@ 

Table \ref{tab:tcq2dreiridge} shows the estimated coefficients for the ridge regression model, and as can be seen these are quite similar to those seen for the lasso fit above.


Finally, this model selection and validation procedure was applied to the Beliefs About Medicine Total. 

<<bamtotlmnotd, echo=FALSE, results=hide>>=
tcq2notd.full <- complete.cases(tcq2notd)
tcq2notd.complete <- tcq2notd[tcq2notd.full,]
bamtotlm1.notd <- lm(Bamtot~Pilltot+Creamtot+Injtot+Acutot+Homtot+Expalt+Expconv+Gender+Income+Health, data=tcq2notd.complete)
bamtot.step.notd <- stepAIC(object=bamtotlm1.notd, upper=bamtotlm1.notd,lower=~1, direction="both", k=3)
bamtot.pred <- predict(bamtotlm1.notd, newdata=tcq2d)

@ 

<<bamstepd, echo=FALSE, results=tex>>=
print(xtable(summary(bamtot.step.notd), label="tab:bamtotnotdsteplm",caption="Coefficients on Beliefs About Medicine Questionnaire Model, stepwise selection (Splits A, B and C)"))
@ 

Table \ref{tab:bamtotnotdsteplm} shows the retained predictors from the algorithm. It can be seen that seven predictors were retained. Next, the fit of these predictors was examined on the held out data.

<<bamtotnotbheldout, echo=FALSE, results=tex>>=
bamtotnotd.heldout.lm <- lm(Bamtot~Pilltot+Creamtot+Homtot+Expalt+Expconv+Income+Health, data=tcq2d)
print(xtable(summary(bamtotnotd.heldout.lm), label="tab:bamtotnotdheldout", caption="Performance of Beliefs About Medicine Questionnaire Model on Held out data, Split D"))
@ 

Table \ref{tab:bamtotnotdheldout} shows the performance of the model on the validation set. It can be seen that Pilltotal, Homeopathy total and Experience with conventional treatments remain significant, but the other variables do not. The model was significant: F(7,182)=5.448, $p\le 0.0001$, and the adjusted $R^2$ for the model was equal to 0.1414, which is extremely poor but in line with previous splits. 


%% \subsection{TCQ Version2 Split A}
%% \label{sec:tcq-version2-split}

%% <<scales2a, echo=FALSE, results=hide, cache=TRUE>>=
%% Pillall2a <- tcq2a[,grep("Pill[1-6]", x=names(tcq2a))]
%% Creamall2a <- tcq2a[,grep("Cream[1-6]", x=names(tcq2a))]
%% Injall2a <- tcq2a[,grep("Inj[1-6]", x=names(tcq2a))]
%% Acuall2a <- tcq2a[,grep("Acu[1-6]", x=names(tcq2a))]
%% Homall2a <- tcq2a[,grep("Hom[1-6]", x=names(tcq2a))]
%% Reiall2a <- tcq2a[,grep("Rei[1-6]", x=names(tcq2a))]
%% bamall2a <- tcq2a[,53:70]
%% tcqall2a <- as.data.frame(cbind(Pillall2a, Creamall2a, Injall2a, Acuall2a, Homall2a, Reiall2a))
%% @ 

%% Parallel analysis and the scree plot agree that six factors seems most optimal for this instrument. However, the MAP criterion disagrees, suggesting that seven factors might be more appropriate. To determine which of these criteria is correct, both the six and seven factor solutions will be examined for interpretability. 


%% <<tcq2afact6, echo=FALSE, results=tex>>=
%% tcq2a.fact.6 <- fa(na.omit(tcqall2a),  nfactors=6, rotate="oblimin", fm="pa")
%% print(FactorXtab(tcq2a.fact.6, names=c("Rei", "Hom", "Acu", "Cream", "Inj", "Pill"), label="tab:tcq2afact6", caption="Six factor Solution, TCQ 2, Oblimin Rotation"))
%% @ 


%% As can be seen from Table \ref{tab:tcq2afact6} , this factor structure fits the predicted one extremely well. The six factors map exactly to the six treatment modalities. PA5 equates to Reiki, PA1 to Homeopathy, PA4 to Acupuncture, PA3 to Cream, PA2 to Injections and PA6 equates to Pills. 

%% %% Below can be seen the correlations between factors, in Table \ref{tab:tcq2a6factorcor}.


%% <<tcq2afactorcor, echo=FALSE, results=hide>>=
%% print(FactorCor(tcq2a.fact.6, label="tab:tcq2a6factorcor", caption="Factor Correlations, Six Factor Solution TCQ 2"))
%% @ 




%% The proportion of variance explained by the six factor solution is equal to 82\% which is an extremely high amount, arguing for the usefulness of this solution. 

%% The correlations between factors are very similar to those between the total scores, which is perhaps unsurprising as both are linear combinations of the scores on each questions. Nonetheless, this gives supporting evidence in favour of the utility of this solution. 



%% <<tcq2afact7, echo=FALSE, results=tex>>=
%% tcq2a.fact.7 <- fa(na.omit(tcqall2a), nfactors=7, rotate="oblimin", fm="pa")
%% print(FactorXtab(tcq2a.fact.7, names=c("Reiki", "Hom", "Acu", "Cream", "Pill", "Inj", "Seven"), label="tab:tcq2afact7",caption="Seven Factor Solution, TCQ 2, Oblimin Rotation"))
%% @ 



%% Table \ref{tab:tcq2afact7} is enlightening in that it can be seen that factor 7 has only one question loading highly (Q13), which has a loading of one, which is unexpected. The structure from the previous sample does not replicate, which cannot be due to sample size (as these were approximately the same) but may represent ordinary sample variance. 
%% %% The correlations between the factors are reported in Table \ref{tab:tcq2a7factorcorr}.

%% <<tcq2a7factorcorr, echo=FALSE, results=hide>>=
%% print(FactorCor(tcq2a.fact.7, label="tab:tcq2a7factorcorr", caption="Correlations Between factors, TCQ 2A, Seven factor solution"))
%% @ 

%% <<tcq2afitindices, echo=FALSE, results=tex, cache=TRUE, eval=FALSE>>=
%% tcq2aFit6 <- FitIndices(tcq2a.fact.6)
%% tcq2aFit7 <- FitIndices(tcq2a.fact.7)
%% tcq2afit <- as.data.frame(cbind(tcq2aFit6, tcq2aFit7))
%% tcq2afit.m <- melt(tcq2afit)
%% names(tcq2afit)[1] <- "Fit Index"
%% print(xtable(tcq2afit.m,caption="Fit Indices, TCQ 2", label="tab:tcq2afit"))
%% #Fix this godawffully ugly table, possibily using cast
%% @ 

%% %% In Table \ref{tab:tcq2afit}, the fit indices for each of the solutions are shown.


%% %put in other 3 sem fits, although i suspect they won\'t converge. Look for debugging information online when you have internet. 

%% \subsection{Split A CFA}
%% \label{sec:split-cfa}



%% <<tcq6notaSem, echo=FALSE, results=hide>>=
%% Pill <- "Pill"
%% Cream <- "Cream"
%% Inj <- "Inj"
%% Acu <- "Acu"
%% Hom <- "Hom"
%% Rei <- "Rei"
%% creamitems.cols <- paste(Cream, 1:6, sep="")
%% pillitems.cols <- paste(Pill, 1:6, sep="")
%% Injitems.cols <- paste(Inj, 1:6, sep="")
%% Acuitems.cols <- paste(Acu, 1:6, sep="")
%% Homitems.cols <- paste(Hom, 1:6, sep="")
%% Reiitems.cols <- paste(Rei, 1:6, sep="")
%% manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
%% latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki")
%% pills <- paste(Pill, 1:6, sep="")
%% creams <- paste(Cream, 1:6, sep="")
%% inj <- paste(Inj, 1:6, sep="")
%% Acu <- paste(Acu, 1:6, sep="")
%% hom <- paste(Hom, 1:6, sep="")
%% rei <- paste(Rei, 1:6, sep="")
%% Tcq6modelnotA <- mxModel(name="TCQ6notA", 
%%                          type="RAM",
%%                          manifestVars=manifests,
%%                          latentVars=latents,
%%                          mxPath(from="Pills", to=pills), 
%%                          mxPath(from="Creams", to=creams),
%%                          mxPath(from="Injections", to=inj),
%%                          mxPath(from="Acupuncture", to=Acu),
%%                          mxPath(from="Homeopathy", to=hom),
%%                          mxPath(from="Reiki", to=rei),
%%                          mxPath(from=manifests, arrows=2),
%%                          mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
%%                          mxData(observed=cov(na.omit(tcqall2nota)), type="cov", numObs=460))
%% tcq6fit.notA <- mxRun(Tcq6modelnotA)
%% tcq6summ.notA <- summary(tcq6fit.notA)
%% @ 

%% <<tcq7notAsem, echo=FALSE, results=hide>>=
%% Pill <- "Pill"
%% Cream <- "Cream"
%% Inj <- "Inj"
%% Acu <- "Acu"
%% Hom <- "Hom"
%% Rei <- "Rei"
%% creamitems.cols <- paste(Cream, 1:6, sep="")
%% pillitems.cols <- paste(Pill, 1:6, sep="")
%% Injitems.cols <- paste(Inj, 1:6, sep="")
%% Acuitems.cols <- paste(Acu, 1:6, sep="")
%% Homitems.cols <- paste(Hom, 1:6, sep="")
%% Reiitems.cols <- paste(Rei, 1:6, sep="")
%% manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
%% latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Seven")
%% pills <- paste(Pill, 1:6, sep="")
%% creams <- paste(Cream, 1:6, sep="")
%% inj <- paste(Inj, 1:6, sep="")
%% Acu <- paste(Acu, 1:6, sep="")
%% hom <- paste(Hom, 1:6, sep="")
%% rei <- paste(Rei, 1:6, sep="")
%% seven <- c("Inj1", "Inj3")
%% Tcq7modelnotA <- mxModel(name="TCQ7notA", 
%%                          type="RAM",
%%                          manifestVars=manifests,
%%                          latentVars=latents,
%%                          mxPath(from="Pills", to=pills), 
%%                          mxPath(from="Creams", to=creams),
%%                          mxPath(from="Injections", to=inj),
%%                          mxPath(from="Acupuncture", to=Acu),
%%                          mxPath(from="Homeopathy", to=hom),
%%                          mxPath(from="Reiki", to=rei),
%%                          mxPath(from="Seven", to=seven),
%%                          mxPath(from=manifests, arrows=2),
%%                          mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
%%                          mxData(observed=cov(na.omit(tcqall2nota)), type="cov", numObs=460))
%% tcq7fit.notA <- mxRun(Tcq7modelnotA)
%% tcq7summ.notA <- summary(tcq7fit.notA)
%% @ 

%% <<tcq2notAsemcompare, echo=FALSE, results=tex>>=
%% tcq2.notA.semcompare <- mxCompare(tcq6fit.notA, tcq7fit.notA)
%% print(xtable(tcq2.notA.semcompare, label="tab:tcq2notAsemcompare", caption="Comparison of Factor Models built on Split A on Splits B, C and D"))
%% @ 

%% It can be seen from Table \ref{tab:tcq2notAsemcompare} that the seven factor model from Split A provided a better fit to the out of sample data than did the 6 factor model. 


%% <<tcq2aitemselection, echo=FALSE, results=hide>>=
%% tcq.aisp <- aisp(na.omit(tcqall2a))
%% print(xtable(tcq.aisp, label="tab:tcq2aitemselection", caption="Item selection procedure, TCQ 2 Split A"))
%% @ 

%% The TCQ divides neatly into two scales, one for the conventional items and another for the alternative items. 

%% After a checking of the IIO and monotonicity assumptions, Pill2 and Pill 4 were removed from the conventional scale, and no items were removed from the alternative scale. 

%% %% Pill4 and Pill6 violated the assumption of invariant item ordering. However, invariant item ordering is only necessary for restricted versions of the rating scale model and the graded response model, so this assumption is not as important in our case. That being said, the assumption was also investigated for the alternative items to allow for a minimal subset of items to be retained if restrictive models are to be fit later in the process. 

%% <<tcq2asplitscales, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.conv <- tcqall2a[,1:18]
%% tcq2a.alt <- tcqall2a[,19:36]
%% @ 

%% <<tcq2aconvcheckiio, echo=FALSE, results=hide>>=
%% tcq2aconv.iio <- check.iio(na.omit(tcq2a.conv))
%% print(xtable(tcq2aconv.iio$violations, label="tab:tcq2aconvcheckiio", caption="Check of Item Ordering Assumptions, TCQ 2 Conventional Split A"))
%% @ 



%% <<tcq2aaltitemord, echo=FALSE, results=hide>>=
%% tcq2aalt.iio <- check.iio(na.omit(tcq2a.alt))
%% print(xtable(tcq2aalt.iio$violations, label="tab:tcq2aaltcheckiio", caption="Item Ordering Assumption Check for TCQ Alternative, Split A"))
%% @ 
%% %% In contrast to the conventional items, there were no violations of the IIO assumption for the alternative items. 

%% %% Next, the assumption of monotonicity was assesed for both scales. 

%% <<tcq2aconvmonotonicity, echo=FALSE, results=hide>>=
%% tcq2aconv.mono <- check.monotonicity(na.omit(tcq2a.conv))
%% print(xtable(summary(tcq2aconv.mono), label="tab:tcq2aconvmonotonicity", caption="Monotonicity Check Results for TCQ 2 Conventional, Split A"))
%% @ 
%% There were no violations of monotonicity for the conventional items in this split (the vi column is the most important here). 

%% <<tcq2aaltmonotonicity, echo=FALSE, results=hide>>=
%% tcq2aalt.mono <- check.monotonicity(na.omit(tcq2a.alt))
%% print(xtable(summary(tcq2aalt.mono), label="tab:tcq2aaltmonotonicity"))
%% @ 

%% %% There were no violations of the monotonicity assumption for the alternative items in this split either. 



%% Guttman errors are interesting in that they can provide a quick measure of person fit. They have mostly been applied to dichotomous outcomes, but are examined in this work in order to check their adequacy as a measure of person fit. 

%% %%need to assess if these are useful. 



%% <<tcqconvguttmanplot, echo=FALSE, results=hide, cache=TRUE>>=
%% conv.guttman <- ggplot(as.data.frame(tcq2a.conv.errors), aes(x=tcq2a.conv.errors))+geom_histogram()

%% @   
%% \begin{figure}
  
%% <<tcqaltguttmanplot, echo=FALSE, fig=TRUE, pdf=TRUE, png=TRUE, eps=TRUE>>=
%% alt.guttman <- ggplot(as.data.frame(tcq2a.alt.errors), aes(x=tcq2a.alt.errors))+geom_histogram()
%% print(arrangeGrob(conv.guttman, alt.guttman))
%% @ 
%%   \caption{Guttman errors histogram for TCQ2A Conventional (top) and alternative (bottom) items}
%%   \label{fig:convaltguttman}
%% \end{figure}

%% As can be seen from Figure \ref{fig:convaltguttman}, the majority of participants had zero guttman errors, which indicates that they were responding to the scale in a coherent manner. 

%% The major assumptions of parametric IRT are satisfied for this split, and so the next step is the estimation of Rasch, One and Two parameter models. 

%% <<tcq2aconvgpcm, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.conv.gpcm.rasch <- gpcm(na.omit(tcq2a.conv), constraint="rasch")
%% tcq2a.conv.gpcm.1pl <- gpcm(na.omit(tcq2a.conv), constraint="1PL")
%% tcq2a.conv.gpcm.gpcm <- gpcm(na.omit(tcq2a.conv), constraint="gpcm")
%% @


%% <<tcq2aconvsum, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.conv.rasch.sum <- summary(tcq2a.conv.gpcm.rasch)
%% tcq2a.conv.1pl.sum <- summary(tcq2a.conv.gpcm.1pl)
%% tcq2a.conv.2pl.sum <- summary(tcq2a.conv.gpcm.gpcm)
%% @ 

%% <<tcq2acoefrasch, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.conv.gpcm.rasch), label="tab:tcq2acoefrasch", caption="Coefficients for TCQ 2 Alternative Scale, Two parameter Generalised Partial Credit Model"))
%% @ 

%% %% Table \ref{tab:tcq2acoefrasch} shows the estimated thresholds for these items under the Rasch model, which has all discrimination parameters fixed to one. %% Even a cursory inspection of this table shows that the model does not fit well. 
%% %% The Category 3 estimates are almost all below the catgory 1 and 2 estimates, suggesting that those who responded using this category (the middle one) had the lowest estimated abilities. %% which is a clear violation of the model\'s assumptions. 
%% %% This can occur in PCM's, as the model uses a local comparison between thresholds, and so this does not necessitate that the model should be abandoned. 
%% %% Next, a one parameter IRT model is examined. 

%% <<tcq2acoefpcm1pl, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.conv.gpcm.1pl), label="tab:tcq2aconvcoef1pl", caption="Coefficients for TCQ2 Conventional One Parameter Generalised Partial Credit Model"))
%% @ 

%% %% Table ~\ref{tab:tcq2aconvcoef1pl} shows that a similiar issue arises using the one parameter model, with an estimated discrimination parameter of 1.531. %% This suggests that the model will need to be further expanded to
%% %% allow for an acceptable fit. 

%% <<tcq2acoefgpcm, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.conv.gpcm.gpcm), label="tab:tcq2aconvcoef1pl", caption="Coefficients for TCQ2 (Split A), Conventional Scale, Two Parameter Generalised Partial Credit Model"))
%% @ 

%% %% Table ~\ref{tab:tcq2aconvcoef1pl} shows that even with a discrimination parameter estimated individually for each item, the generalised partial credit model still exhibits this behaviour with regards to Category C. It is possible that participants who tended to use this particular response category were using it as a default when they did not know how to answer. Next,  One and Two parameter Graded Response Models were fit to the same items.

<<tcq2convgrm, echo=FALSE, results=hide, cache=TRUE>>=
tcq2a.conv.grm.1pl <- grm(na.omit(tcq2a.conv), constrained=TRUE)
tcq2a.conv.grm.2pl <- grm(na.omit(tcq2a.conv), constrained=FALSE)
@ 

<<tcq2aconvgrm1plsumm, echo=FALSE, results=hide>>=
#print(xtable(coef(tcq2a.conv.grm.1pl), label="tab:tcq2aconvgrm1plsumm", caption="Coefficients for TCQ 2 (Split A) Conventional Scale, One parameter Graded Response Model"))
@ 

%% As can be seen from Table ~\ref{tab:tcq2aconvgrm1plsumm}, the graded response model provides a good fit to the data.  There are no obvious violations of the model assumptions, with an estimated discrimination parameter of 2.197. Note that the cream items are considered the most difficult, suggesting that this was the least credible form of conventional treatment.  The next model fit was a two parameter graded response model.  

%% <<tcq2aconvgrm1plsumm, echo=FALSE, results=tex>>=
%% print(xtable(coef(tcq2a.conv.grm.2pl), label="tab:tcq2aconvgrm1plsumm", caption="Coefficients for TCQ 2 Conventional (Split A), Two Parameter Graded Response Model"))
%% @ 

%% Again, it can be seen from Table \ref{tab:tcq2aconvgrm1plsumm} that the Cream items appear to be the most discriminating, and possess the highest difficulty levels (on average).  
%% Both the pill and injection items seem to be endorsed by a much large proportion of the sample. This suggests that Cream Items appear to be the least credible treatment for pain. 

%% %% \begin{figure}
%% <<tcq2aconvgrm1plPlot, echo=FALSE, pdf=TRUE, png=TRUE, eps=TRUE, pdf=TRUE, png=TRUE, eval=FALSE>>=
%% print(ggplotGRM(tcq2a.conv.grm.1pl)+geom_rug())
%% @   
%% %%   \caption{Item Parameter Plot for TCQ2 (Split A). The Threshold parameter indicates the ability point where the next response becomes most likely. If the thresholds are not in order, this indicates a failure of montonicity}
%% %%   \label{fig:tcqcov2agrm1pl}
%% %% \end{figure}

%% %% A plot showing the threshold parameters for each of the items in the conventional model can be seen in Figure \ref{fig:tcqcov2agrm1pl}.

%% %% The same plot for the two parameter model can be seen in Figure \ref{fig:tcq2aconvgrm2pl}. 


%% %% \begin{figure}
%% <<tcq2aconvgrm2plPlot, echo=FALSE, eval=FALSE, pdf=TRUE, png=TRUE, eps=TRUE>>=
%% print(ggplotGRM(tcq2a.conv.grm.2pl))
%% @   
%% %%   \caption{Item Parameter Plot for TCQ2 (Split A). The Threshold parameter indicates the ability point where the next response becomes most likely. If the thresholds are not in order, this indicates a failure of montonicity}
%% %%   \label{fig:tcq2aconvgrm2pl}
%% %% \end{figure}

%% %% Another item parameter plot for the two parameter model is shown in Figure ~\ref{fig:tcq2aconvgrm2pl}, which again shows no obvious problems with the model. 


%% A likelihood ratio test was carried out for the two models, and the two parameter model appeared a better fit in terms of likelihood($p<0.001$), AIC and BIC. That being said, given the tradeoff in degrees of freedom (17), a better test will be the models accuracy on unseen data.

%% For models built on Split A, Splits B, C and D were used as a test set. 

%% %% The first check was to examine the fit of each of the partial credit models. %% Although none of these models met the assumptions of the 
%% %% model, they may still be useful in a predictive sense. 

%% <<tcq2aconvpcmtest, echo=FALSE, results=hide>>=
%% tcq2nota.conv <- tcq2nota[,c(17:34)]
%% tcq2a.pcm.rasch.done <- testIRTModels(tcq2a.conv.gpcm.rasch, tcq2nota.conv, gpcmconstraint="rasch", grmconstraint=NULL)
%% tcq2a.pcm.1PL.done <- testIRTModels(tcq2a.conv.gpcm.1pl, tcq2nota.conv, gpcmconstraint="1PL", grmconstraint=NULL)
%% tcq2a.pcm.gpcm.done <- testIRTModels(tcq2a.conv.gpcm.gpcm, tcq2nota.conv, gpcmconstraint="gpcm", grmconstraint=NULL)
%% @ 

%% <<pcmtestprint, echo=FALSE, results=hide>>=
%% tcq2a.pcm.modcomp <- rbind(tcq2a.pcm.rasch.done, tcq2a.pcm.1PL.done, tcq2a.pcm.gpcm.done)
%% rownames(tcq2a.pcm.modcomp) <- c("Rasch PCM", "One Parameter PCM", "Two Parameter PCM")


%% @ 
%% <<tcq2apcmmodcomprint, echo=FALSE, results=hide>>=
%% pcm.modcomp2a <- xtable(tcq2a.pcm.modcomp, caption="Partial Credit Models from Split A tested on Splits B, C and D", label="tab:pcmmodcomp2a")
%% print(pcm.modcomp2a)
%% @ 
%% %% As can be seen from Table \ref{tab:pcmmodcomp2a}, the one parameter PCM appears to provide the best predictive accuracy on the heldout data. The measure of error approximation used is essentially the root mean differences between the abilities estimated directly from the new sample versus those estimated from the parameters of the new model.

%% %% Next, the two graded response models were assessed. 

%% <<grmtest2a, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.grm.1pl.done <- testIRTModels(tcq2a.conv.grm.1pl, tcq2nota.conv, gpcmconstraint=NULL, grmconstraint=TRUE)
%% tcq2a.grm.2pl.done <- testIRTModels(tcq2a.conv.grm.2pl, tcq2nota.conv,gpcmconstraint=NULL, grmconstraint=TRUE)
%% tcq2a.grm.done <- rbind(tcq2a.grm.1pl.done, tcq2a.grm.2pl.done)
%% rownames(tcq2a.grm.done) <- c("One Parameter GRM", "Two Parameter GRM")
%% @ 
%% <<tcq2agrmdone, echo=FALSE, results=tex>>=
%% tcq2a.grm.done.xtab <- xtable(tcq2a.grm.done, caption="Comparison of Split A Graded Response Models on Splits B, C and D", label="tab:grmdone2a")
%% print(tcq2a.grm.done.xtab)
%% @ 
%% Table \ref{tab:grmdone2a} shows that the one parameter model performed best on the unseen data, suggesting that the additional complexity of a two parameter model was not necessary in this sample. 


%% Next, the same process is repeated for the TCQ Alternative Scale for Split A. 

%% <<tcq2aaltpcm, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.alt.gpcm.rasch <- gpcm(tcq2a.alt, constraint="rasch")
%% tcq2a.alt.gpcm.1PL <- gpcm(tcq2a.alt, constraint="1PL")
%% tcq2a.alt.gpcm.gpcm <- gpcm(tcq2a.alt, constraint="gpcm")
%% @ 

%% <<tcq2aaltgpcmrasch, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.alt.gpcm.rasch), caption="Estimated Coefficients for Rasch Partial Credit Model, TCQ2, Split A, Alternative Scale", label="tab:tcq2aaltgpcmrasch"))
%% @ 

%% %% It can be seen from Table \ref{tab:tcq2aaltgpcmrasch} that the estimated difficulty coefficients for the alternative scale are much higher than those for the conventional scale, which makes sense given that these are both less familiar, and less accepted treatments for pain. However, it as also apparent that these high difficulties are more a factor of the difficulty of the highest category more than anything else. The estimated thresholds for the other three categories are in line with those of the conventional scale, at least for acupuncture. It is possible that these difficulty levels may be lowered when a more flexible one parameter model is fit. 


%% <<tcq2aaltgpcm1pl, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.alt.gpcm.1PL), caption="Coefficient Estimates for One Parameter Partial Credit Model, TCQ2, Split A, Alternative Scale", label="tab:tcq2aaltgpcm1pl"), table.placement="ht")
%% @ 


%% %% Table \ref{tab:tcq2aaltgpcm1pl} shows that this did occur, as the discrimination parameter has increased to 1.852, while the average difficulty of the top threshold has noticeably dropped. Finally, a two parameter model was fit to this scale. It would be exepected that the discrimination parameters of Q4 in each scale will increase, while those of the Acupuncture questions will fall. 

%% <<tcq2aaltgpcm1pl, echo=FALSE, results=hide>>=
%% print(xtable(coef(tcq2a.alt.gpcm.gpcm), caption="Coefficient Estimates for Two Parameter Partial Credit Model, TCQ2, Split A, Alternative Scale", label="tab:tcq2aaltgpcm2pl"), table.placement="ht")
%% @ 

%% %% As can be seen from Table \ref{tab:tcq2aaltgpcm2pl}, this prediction was partially fulfilled. While the discrimination parameter of the Acupuncture items lowered, the difficulty of the items rose to match. Additionally, the Reiki items now have extremely large discrimination parameters along with relatively high thresholds, suggesting that these are the items most predictive of high credibility. 



%% Next, one and two parameter Graded Response Models were applied to the TCQ Alternative for this split. 

%% <<tcq2aaltgrm, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2a.alt.grm.1pl <- grm(tcq2a.alt, constrained=TRUE)
%% tcq2a.alt.grm.2pl <- grm(tcq2a.alt, constrained=FALSE)
%% @

%% <<tcq2agrm1pl, echo=FALSE, results=tex>>=
%% print(xtable(coef(tcq2a.alt.grm.1pl), caption="Coefficients for TCQ Alternative (Split A) One Parameter Graded Response Model", label="tab:tcq2aaltgrm1pl"))
%% @ 

%% The coefficients for the one parameter graded response model for the alternative scale are shown in Table \ref{tab:tcq2aaltgrm1pl}. It can be seen that the estimated discrimination parameter is quite high, suggesting that all of these items are harder to endorse than those relating to conventional treatments. The Homeopathy and Reiki items tend to be harder to endorse than are the Acupuncture items. 


%% <<tcq2agrm2pl, echo=FALSE, results=tex>>=
%% print(xtable(coef(tcq2a.alt.grm.2pl), caption="Coefficients for TCQ Alternative (Split A) Two Parameter Graded Response Model", label="tab:tcq2aaltgrm2pl"))
%% @ 

%% Table \ref{tab:tcq2aaltgrm2pl} shows the corresponding coefficients for the two parameter GRM. It can be seen that the difficulties for the homeopathy and reiki items have lowered, but their discrimination parameters have increased. 

%% The next step was to assess the performance of each of these models on unseen data. 

%% <<tcq2aaltgrmtest, echo=FALSE, results=hide, cache=TRUE>>=
%% tcq2nota.alt <- tcq2nota[,35:52]
%% tcq2a.alt.grm.1pl.done <- testIRTModels(tcq2a.alt.grm.1pl, tcq2nota.alt, gpcmconstraint=NULL, grmconstraint=TRUE)
%% tcq2a.alt.grm.2pl.done <- testIRTModels(tcq2a.alt.grm.2pl, tcq2nota.alt, gpcmconstraint=NULL, grmconstraint=FALSE)
%% tcq2a.grm.modcomp <- rbind(tcq2a.alt.grm.1pl.done, tcq2a.alt.grm.2pl.done)
%% rownames(tcq2a.grm.modcomp) <- c("One Parameter GRM", "Two Parameter GRM")

%% @ 
%% <<tcqconv2agrmtestprint, echo=FALSE, results=tex>>=
%% print(xtable(tcq2a.grm.modcomp, caption="Performance of Split A Graded Response Models TCQ Alternative on Splits B, C and D", label="tab:tcq2aaltgrmmodcomp"))
%% @ 
%% As can be seen from Table \ref{tab:tcq2aaltgrmmodcomp}, the one parameter model performed significantly better on the unseen data. 

