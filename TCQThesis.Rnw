% -*- mode: noweb; noweb-default-code-mode: R-mode; -*-
\section{Introduction}

Expectancies are considered to be at the core of the placebo response \cite{Montgomery1997}. However, currently they are assessed using very simple methods which fail to capture the multidimensional nature and changes over time in these important constructs \cite{Stone2005}. While these methods work, they typically explain only 10\% of the variance in response to placebo, which is clearly not optimal \cite{Whalley2008}.  This paper reports on an adaptation of the Credibility/Expectancy Questionnaire \cite{devilly2000psychometric}  to measure pain expectancies in a student sample, and reports on its psychometric validation over two studies. 
While expectancies are considered the prime factor in response to placebo, there is some evidence that they are not the best predictors in all situations, and that there may be components of expectancies which are not tapped by current measures \cite{Hyland2007,Geers2005,Geers2005a}. The CEQ is useful in that it taps both cognitive and affective components of the expectancy construct, and this should lead to better predictions. This article reports on the development of the CEQ for pain measurements. It is important to note that current or former use of the treatments measured was not a requirement for the completion of the measure, but this should not be regarded as a flaw given that many if not most participants in placebo research do not have any experience of the treatments used (and indeed, such knowledge is often an exclusion criteria for the research) \cite{Kirsch1985,Kirsch1997}. The CEQ has been used in a family therpay setting for children with conduct disorder \cite{Nock2007}, in the assessment of relational therapy for Vietnam war veterans and their spouses \cite{Devilly2002} and in the treatment of PTSD \cite{Devilly2008}. It has not been used in any non-clinical samples, and this is its first adaptation for the study of both pain and treatment response expectancies. 

\section{Study One}

\subsection{Materials and Methods}

\subsubsection{Participants}

All participants in Study 1 were students at the University of the researchers. 299 began the survey, and 281 completed the analysis in full. These 281 participants are the those on whom the analyses reported here were based. Ages, Gender and other demographic variables about the participants can be found in the Results section, under the heading of Descriptive Statistics. 

\subsubsection{Measures}

The Treatment Credibility Questionnaire was adapted from the Devilly and Borkovec Credibility/Expectancy Questionnaire. This questionnaire consists of six questions, asking about the cognitive and affective responses to the therapy. Given that this research project concerns the use of placebo analgesia, the questionnaires were modified to make them refer to procedures for the relief of pain.
The general format is as follows: 
\begin{quotation}
You have been suffering pain for a number of weeks, you go to the doctor and he suggests that you try X for this pain. Answer the following questions below.   
\end{quotation}

In this case, X represents a pain killing treatment. In order, the ones utilised in this research were Pills, Creams, Injections and Acupuncture. 
There were six questions under each method, giving the scale 24 questions in all. Following the analysis of the results of Study 1, the instrument was modified to include six questions each on Homeopathy and Reiki, another two methods within the field of complementary and alternative medicine.  


 

The questions were as follows:


\begin{enumerate}
	\item How logical does the therapy offered to you seem?
	\item How successful do you think this treatment will be in reducing your symptoms?
 	\item How confident would you be in recommending this treatment to a friend2
	\item How much improvement in your symptoms do you think will occur?
	\item How much do you really \textit{feel} that therapy will help you to reduce your symptoms?
	\item How much improvement in your symptoms do you really \textit{feel} will occur?
\end{enumerate}

The CEQ has had alphas of between 0.75 and 0.86 in various research, and test-retest reliabilities average at about 0.75 \cite{devilly2000psychometric}. 

\subsubsection{Data Collection}

Data were collected online through the use of an online data collection tool. The email request for completion was sent through the moderator of the All Students list to a total of 4551 students. By the date alloted for collection of responses, 299 had been returned, giving a response rate of 6.3\%, which is extremely low. 

The following demographic variables were also assessed: Age, College of Study, Gender, and whether the respondent was an undergraduate or a postgraduate. 

\subsubsection{Data Analysis}

As this was a first draft of the survey, representativeness was not rated as important as other factors. The priority here was to assess the reliability and factor structure of the of instrument, to allow further validation in clinical and non-clinical groups over time.  All data analysis was conducted using R 2.11.0, an open source data analysis environment based on the commercial S Plus language\cite{RDevelopmentCoreTeam2010}. The pysch package was used for all factor and reliability analyses \cite{Revelle2010} while the eRm package was used for the IRT analyses and plots \cite{Mair2010} and the xtable package \cite{Dahl2009} to export R objects for LaTeX  along with the Sweave package to allow R code to processed through LaTeX editors, enabling reproducible research \cite{Leisch2002}. Structural Equation Modelling was carried out using the OpenMx package \cite{Bokerinpress}. All code and data are available from the first author upon request. 

Factor Analysis was carried out using a principal axis method, as normality could not be assumed.In this piece of research, Exploratory Factor Analysis was used, as the researcher had no prior hypotheses on the nature and structure of the underlying latent variables. 
Many researchers recommend utilising a number of different methods of data reduction, as the evidence suggests that a factor structure which remains invariant after multiple different reductions is the most likely solution that can be fitted to the data\cite{costello2005best,henson2006use}. This was the approach taken in this research report. Other research has shown that parallel analysis and the Minimum Average Partial criterion, along with the scree plot are two the most effective means of assessing the number of factors to retain, and both of these criteria were used in this research. Kruskal-Wallis tests were used for assessment of differences between groups, as normality was not assumed (and indeed was not found). 


\section{Results}

\subsection{Demographic Statistics}

Below in the table \ref{tab:tcq1.age} can be seen summary statistics for the age of the respondents. 
<<packagesanddata, echo=FALSE, results=hide>>=
require(ggplot2)
require(psych)
require(xtable)
require(mokken)
require(eRm)
require(ltm)
require(xtable)
require(OpenMx)
source("func.R")
tcq1<-read.csv("CSV TCQ030410updatedJan11.csv")
@ 

<<agesummary, echo=FALSE, results=tex>>=
sum.age<-summary(tcq1$Age) #$
sum.age.mat<-as.matrix(sum.age)
xtab.age<-xtable(sum.age.mat)
print(xtab.age)
@ 

\caption{Age Distribution of Sample, TCQ 1}
\label{tab:tcq1.age}



The College of study of the respondents was also assessed, and the results are shown in Table \ref{tab:tcq1.college} below. 

<<gendersummary, echo=FALSE, results=tex>>=
sum.gen<-summary(tcq1$Gender.) 
sum.gen.mat<-as.matrix(sum.age)
sum.gen.xtab<-xtable(sum.gen.mat)
print(sum.gen.xtab)
@ 

<<tcqcollege, echo=FALSE, results=tex>>=
sum.coll<-summary(tcq1$College.) 
sum.coll.mat<-as.matrix(sum.coll)
xtab.coll<-xtable(sum.coll.mat)
print(xtab.coll)
@ 


\caption{College of Respondents, TCQ 1}
\label{tab:tcq1college}


As we can see from Table \ref{tab:tcq1college}, again the breakdown roughly follows the distribution of students in the population. However, there are a few more Medicine and Health students than one would expect, presumably because this survey was somewhat more salient to them, given their field. 

The next demographic variable we will examine is the breakdown between undergraduates and postgraduates in the sample. The results can be seen in Table 3 below. 
<<upgsummary, echo=FALSE, results=tex>>=
sum.ugpg<-summary(tcq1$UGPG.) #$
ugpg.mat<-as.matrix(sum.ugpg)
xtab.ugpg<-xtable(ugpg.mat)
print(xtab.ugpg)
@ 


\caption{Distribution of Undergraduates and Postgraduate Respondents, TCQ 1}
\label{tab:tcq1ugpg}

As we can see from table \ref{tab:tcq1ugpg}, approximately 16\% of the sample are postgraduates, which fits reasonably well with the figures from the population. 

The next demographic variable examined is that of year of Study, and the results can be seen in Table below.

<<yearsummary, echo=FALSE, results=tex>>=
sum.year<-summary(tcq1$Year.) #$
mat.year<-as.matrix(sum.year)
xtab.year<-xtable(mat.year)
print(xtab.year)
@ 


\caption{Year of Study, TCQ 1}
\label{tab:tcq1year}


As one can see from Table \ref{tab:tcq1year} , the largest number of respondents came from first year, which argues against the representativeness of the sample. However, given that both first year undergraduates and first year postgraduates could have used this response, it may not be that much of a threat to representativeness. 

Now that all of the demographic variables have been assessed, we can look at the scores on the response variables regarding the different forms of treatment. 

Below, In Table \ref{tab:tcq1sumtotals} can be seen the summary statistics for the credibility scores for each of the four modalites.

<<totalscreate, echo=FALSE, results=hide>>=
totals <- tcq1[,c("PillTot", "CreamTot", "InjTot", "AcuTot")]
@


<<totalsummary, echo=FALSE, results=tex>>=
sum.totals<-summary(totals)
mat.totals<-as.matrix(sum.totals)
xtab.totals<-xtable(mat.totals)
print(xtab.totals)
@ 


\caption{Summary Statistics, Total Credibility Scores}
\label{tab:tcq1.sumtotals}

As can be seen,  none of these distributions are normally distributed, a point which is reinforced by Figure \ref{fig:tcqscatterplotmat} below, which shows both the correlations between the scale totals and their distribution. 
\begin{figure}
	\centering
<<scatterplotmat, echo=FALSE, fig=TRUE>>=
print(pairs.panels(totals))
@ 
\caption{Scatterplot Matrix, TCQ 1}
\label{fig:tcqscatterplotmat}
\end{figure}

Next, the differences in credibility totals between Genders will be examined. 
<<gendercred, echo=FALSE, fig=TRUE>>=
gendpill <- ggplot(tcq1, aes(x=PillTot, colour=Gender))+layer(geom="bar")
gendcream <- ggplot(tcq1, aes(x=CreamTot, colour=Gender))+layer(geom="bar")
gendinj <- ggplot(tcq1, aes(x=InjTot, colour=Gender))+layer(geom="bar")
gendacu <- ggplot(tcq1, aes(x=AcuTot, colour=Gender))+layer(geom="bar")
@ 
<<gendpill, echo=FALSE, fig=TRUE>>=
print(gendpill)
@ 

As can be seen from this Box plot (Figure \ref{fig:tcq 0.795-11}), there appear to be no significant differences in median Pill scores that can be attributed to the Gender of the respondents. It can be seen, however, that the variability is larger within the male responses. Again, we see a similar pattern to the scores for Pills, in that there appears to be no mean differences in the credibility totals. We can see a larger variability with the responses from men.  From Figure 9, we can observe that again, no significant differences are visible between the credibility totals.  We can observe that men tend to report much higher variability in their assessment of injections.However, the acupuncture figure shows a different pattern. We can see from a simple inspection of the graph that the mean credibility totals are very different for females and males. We performed a Kruskall Wallis test to examine whether this visual difference can be backed up with a rigorous analysis. The results tended towards significance (p=0.09).
As can be seen from this, the difference, although visible is not significant, although it probably would be if the sample were larger. Again, the pattern of larger variability in the responses of men is apparent.   
<<collegeplots, echo=FALSE, fig=TRUE>>=
collpill <- ggplot(tcq1, aes(x=PillTot, colour=College))+layer(geom="bar")
collcream <- ggplot(tcq1, aes(x=CreamTot, colour=College))+layer(geom="bar")
collinj <- ggplot(tcq1, aes(x=InjTot, colour=College))+layer(geom="bar")
collacu <- ggplot(tcq1, aes(x=AcuTot, colour=College))+layer(geom="bar")
@ 

<<collpill, echo=FALSE, fig=TRUE>>=
print(collpill)
@ 


<<collcream, echo=FALSE, fig=TRUE>>=
print(collcream)
@ 

<<collinj, echo=FALSE, fig=TRUE>>=
print(collinj)
@ 

<<collacu, echo=FALSE, fig=TRUE>>=
print(collacu)
@ 

\subsubsection{Reliability Analysis}

%Reliability is an extremely important part of any measurement instrument, given that if we cannot rely on the instrument giving us similar answers on different equations, it is of no use in our studies.
The reliability of this scale was assessed. The method used was Cronbach's alpha, which is the mean of all possible split half reliabilities, and is the most commonly used measure of reliability in psychological research. Of course, the extent to which people give the same responses at different time points also needs to be assessed, but that will be examined after the factor structure and other methodological issues have been assessed. 

This analysis was performed on the sample, and the mean alpha was equal to .9, which is well above the threshold used for survey research (.7) and would, on the basis of this sample, qualify as a clinical instrument, for which the threshold is 0.9. This reliability analysis (shown in Tables \ref{tab:reltcq1short} and \ref{tab:tcq1rel.long})  did not suggest that any of the items should be removed from the scale. 

<<scalemake, echo=FALSE, results=hide>>=
Pill.g <- grep("Pill[1-6]", x=names(tcq1))
Cream.g <- grep("Cream[1-6]", x=names(tcq1))
Inj.g <- grep("Inj[1-6]", x=names(tcq1))
Acu.g <- grep("Acu[1-6]", x=names(tcq1))
Pillall <- tcq1[,Pill.g]
Creamall <- tcq1[,Cream.g]
Injall <- tcq1[,Inj.g]
Acuall <- tcq1[,Acu.g]
tcqall <- as.data.frame(cbind(Pillall, Creamall, Injall, Acuall))
rel.tcq <- psych:::alpha(na.omit(tcqall))
@ 

\caption{Reliability Statistics for TCQ 1}
\label{tab:reltcq1short}
<<reltcq, echo=FALSE, fig=TRUE>>=
rel.xtab<-xtable(rel.tcq$total) 
print(rel.xtab)
@ 

<<reltcq2, echo=FALSE, results=tex>>=
print(xtable(rel.tcq$item.stats))
@ 

\label{tab:tcq1rel.long}



\subsubsection{Factor Analysis}

Factor Analysis is a method for examining inter-correlations between sets of variables in order to reduce the number of items required to model the instrument. It is commonly used in psychological research either to confirm a predicted structure (Confirmatory Factor Analysis) or to explore the factor structure of a new instrument (Exploratory Factor Analysis).




The first analysis carried out on the data was an assessment of the number of factors suggested by both the parallel analysis and MAP criterion. The results of the parallel analysis and scree plot are shown in the Figure \ref{fig:tcq 0.795-17}  below. The MAP criterion suggested that six factors should be extracted. Both of these factor solutions will be created and examined based on fit indices and interpretability below. 

\begin{figure}
	\centering
<<faparallel, echo=FALSE, fig=TRUE>>=
plot(fa.parallel(na.omit(tcqall)))
VSS(na.omit(tcqall))
@ 

	\caption{Scree Plot and Parallel Analysis, TCQ 1}
	\label{fig:faparallel}
\end{figure}

<<tcqfact4, echo=FALSE, results=tex>>=
tcq.fact.4<-fa(na.omit(tcqall), 4, rotate='oblimin', fm="pa")
print(FactorXtab(tcq.fact.4, label="tcqfact4"))
@ 

<<factorloadings4, echo=FALSE, results=verbatim>>=
print(ExtractLoadings(tcq.fact.4))
@ 

\caption{Four Factor Solution, TCQ 1 Oblimin rotation}
\label{tab:tcq1fourfactor}

<<factorcor4, echo=FALSE, results=tex>>=
print(FactorCor(tcq.fact.4, label="factorcor4"))
@ 

The scree plot seems to suggest that four factors should be retained, but the MAP criterion  suggests that the six factor solution is more appropriate.
As can be seen, the red lines (representing the random values) cut off the blue lines of the actual data somewhere at 4 factors, and the numerical output claims that a four factor solution is most optimal. 
Therefore, 4 factors were retained. The theoretical rationale for accepting this analysis is outlined below. 

As can be seen from Table \ref{tab:tcq1fourfactor}  this factor structure is extremely interpretable, with each group of six questions loading highly on its own factor. This fits with the expectations prior to the research. 

Below, in Table \ref{tab:tcq1fourfactor.corr} are shown the inter-correlations between these factors. 


\caption{Four Factor Solution Correlations between Factors}
\label{tab:tcq1fourfactor.corr}


This four factor solution explains 74\% of the variance, which is extremely high for a psychological self report scale. 

As can be seen from Table \ref{tab:tcq1fourfactor.corr} , the Acupuncture factor does not correlate highly with the other three factors, but they do correlate reasonably well with one another. This table makes clear that the distinction between the western and alternative treatment modalities was clear to the participants. 

Below, in Table \ref{tab:tcq1fivefactor} the five factor solution is examined.

<<tcqfact5, echo=FALSE, results=tex>>=
tcq.fact.5 <-fa(na.omit(tcqall), 6, rotate='oblimin', fm="pa")
print(FactorXtab(tcq.fact.5, label="tcqfact5"))
@ 
<<tcq5cor, echo=FALSE, results=tex>>=
print(FactorCor(tcq.fact.5, label="tcq5cor"))
@ 

\caption{Five Factor Solution, TCQ 1 Promax rotation}


Although in Table \ref{tab:tcq1fivefactor} the oblimin solution is shown, simplimax, varimax and promax rotations were attempted on the data specifying five factors. In no case did any of the items load highest on this factor, so this factor can be regarded as not adding anything to the model. 

Finally, the six factor solution was examined for interpretability, and the results are shown in Table \ref{tab:tcq1sixfactor}
<<tcqfact6, echo=FALSE, results=tex>>=
tcq.fact.6<-fa(na.omit(tcqall), 6, rotate='promax', fm="pa")
print(FactorXtab(tcq.fact.6, label="tcqfact6"))
@ 
<<tcq6cor, echo=FALSE, results=tex>>=
print(FactorCor(tcq.fact.6, label="tcq6cor"))
@ 

\caption{Six Factor Solution, TCQ 1, Oblimin Rotation}
\label{tab:tcq1sixfactor}


As can be seen in Table \ref{tab:tcq1sixfactor} the four factors from the original solution still have the highest loadings, but there are a number of lower loadings on the fifth and sixth factors. This suggests that a CFA using a maximum likelihood approach is needed to determine which of these solutions can reproduce the covariance matrix most accurately. 

<<fitindices,echo=FALSE, results=tex>>=
fit4 <- FitIndices(tcq.fact.4)
fit5 <- FitIndices(tcq.fact.5)
fit6 <- FitIndices(tcq.fact.6)
fit.tcq1 <- as.data.frame(cbind(fit4, fit5, fit6))
print(xtable(fit.tcq1))
@ 


\caption{Fit Indices, TCQ 1}
\label{tab:tcq1modelcomp}

It can be seen that the six factor solution has the best fit indices (BIC and TLI) and given these fit indices and the results of the CFA in Table \ref{tab:tcq1modelcomp}, this factor solution appears to be the one which replicates the covariance matrix best. 

@ 


% latex table generated in R 2.11.1 by xtable 1.5-6 package
% Wed Jan 12 13:19:15 2011
\begin{table}[ht]
\begin{center}
\caption{Model Comparison Statistics, TCQ 1}
\begin{tabular}{rllrrrrrrr}
  \hline
 & base & comparison & ep & minus2LL & df & AIC & diffLL & diffdf & p \\ 
  \hline
1 & TCQ14Factor &  &  48 & 1504.65 & 252.00 & 1158.27 &  &  &  \\ 
  2 & TCQ14Factor & TCQ16Factor &  57 & 1129.68 & 243.00 & 801.30 & -374.97 & -9.00 &  \\ 
   \hline
\end{tabular}
\label{tab:tcq1modelcomp}
\end{center}
\end{table}

As can be seen in Table \ref{tab:tcq1modelcomp}, the six factor model appears to fit the data much better, which is unexpected. Possible explanations are discussed below. 


\subsubsection{Confirmatory Factor Analyses}
\label{sec:conf-fact-analys}

<<tcq4sem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
Tcq4model <- mxModel(name="TCQ4", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcqall)), type="cov", numObs=264)
                      )
tcq4fit <- mxRun(Tcq4model)
tcq4summ <- summary(tcq4fit)
@ 


<<tcq5sem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Fifth")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
fifth <- c("Pill4", "Pill5", "Pill6", "Cream5", "Cream6", "Inj6")
Tcq5model <- mxModel(name="TCQ5", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                     mxPath(from="Fifth", to=fifth),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcqall)), type="cov", numObs=264))
tcq5fit <- mxRun(Tcq5model)
tcq5summ <- summary(tcq5fit)
@ 

<<tcq6sem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Fifth", "Sixth")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
fifth <- c("Pill1", "Pill3","Cream1", "Cream3","Inj1", "Inj3")
sixth <- c("Pill2", "Pill4","Inj2", "Inj4")
Tcq5model <- mxModel(name="TCQ5", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                     mxPath(from="Fifth", to=fifth),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcqall)), type="cov", numObs=264))
tcq5fit <- mxRun(Tcq5model)
tcq5summ <- summary(tcq5fit)
@ 

\subsection{Item Response Theory Analyses}


<<tcqcheckassumptions, echo=FALSE, results=hide>>=
tcq.scales <- aisp(na.omit(tcqall))
@ 

As can be seen from Table \ref{tab:tcqcheckassumptions}, the items appear to divide into two scales, one for the conventional items and another for the acupuncture items. Therefore, these two sets of items will be analysed seperately. 


<<tcqscales, echo=FALSE, results=tex>>=
print(xtable(tcq.scales))
convtcq <- as.data.frame(cbind(Pillall, Creamall, Injall))
tcqalt <- Acuall
@ 

<<tcqitemord, echo=FALSE, results=hide>>=
tcqconv.item.ord <- check.iio(na.omit(convtcq))
tcqalt.item.ord <- check.iio(na.omit(tcqalt))
tcqconv.monotonicity <- check.monotonicity(na.omit(convtcq))
tcqalt.monotonicity <- check.monotonicity(na.omit(tcqalt))
@ 

<<tcqconvitemord, echo=FALSE, results=tex>>=
print(xtable(tcqconv.item.ord$violations))
convtcq <- convtcq[,-2]
@ 

From Table \ref{tab:tcqconvitemord} it can be seen that Pill2 was the only item which did not meet the assumptions of the model in that it violated the item ordering assumption (assumption of monotonicity). Therefore, this item was removed from the scale before further analyses. 

Next, the assumptions of monotonicity were examined for the conventional items, and the results are shown in Table \ref{tab:convmonotonicity}. 

<<convmonotonicity, echo=FALSE, results=tex>>=
print(xtable(summary(tcqconv.monotonicity)))
@ 

<<tcqaltitemord, echo=FALSE, results=tex>>=
print(xtable(tcqalt.item.ord$violations))

@ 

Table \ref{tab:tcqaltitemord} demonstrates that there were no violations of the item ordering assumptions for the acupuncture items.

Next, the assumption of monotonicity was examined for the acupcunture items, and the results are shown in Table \ref{tab:altmonotonicity}. The results indicate that there are no violations of monotonicity for these items. 

<<altmonotonicity, echo=FALSE, results=tex>>=
print(xtable(summary(tcqalt.monotonicity)))
@ 

<<tcqconvpcm, echo=FALSE, results=tex>>=
tcqconv.pcm.rasch<-gpcm(convtcq, constraint="rasch")
tcqcoef <- coef(tcqconv.pcm.rasch)
print(xtable(tcqcoef))
@ 

Even a cursory glance at Table \ref{tab:tcqconvpcm} demonstrates that there are serious problems with this model, as the estimates are not monotonically increasing for each higher category. The model in Table \ref{tab:tcqconvpcm} is a rasch model, and the next model to be examined is a one parameter model, where the discrimination parameter is estimated from the data rather than being fixed at one. 

<<tcqconvpcm1pl, echo=FALSE, results=tex>>=
tcqconv.pcm.1pl <- gpcm(convtcq, constraint="1PL")
tcqconv1pl.coef <- coef(tcqconv.pcm.1pl)
print(xtable(tcqconv1pl.coef))
@ 

From Table \ref{tab:tcqconvpcm1pl} it can be seen that the model still has a number of problems with item ordering, especially in the Pill and Injection sections of the questionnaire. Indeed, it appears to be Category 3 which is causing the problems, which may suggest that participants were using this category as a base rather than actually considering the alternatives in a consistent manner. Next, a 2 parameter model will be fitted to assess if allowing individual discrimination parameters will prove to be a better approach. 

<<tcqconvpcm2pl, echo=FALSE, results=tex>>=
tcqconv.pcm.gpcm <- gpcm(convtcq, constraint="gpcm")
tcqconv.gpcm.coef <- coef(tcqconv.pcm.gpcm)
print(xtable(tcqconv.gpcm.coef))
@ 

Unfortunately, the approach of attempting to allow for a more flexible modelling approach in order to garner more coherent parameters for the model appears to have failed, in that Table \ref{tab:tcqconvpcm2pl} shows that the issues around item ordering have not been resolved by allowing for a two parameter model. 

Thus far, the generalised partial credit model has been shown to be entirely inappropriate for the analysis of the conventional scale items in this sample. The next step is to attempt to fit a more flexible model, the graded response model, and examine if this model can be fit accurately to the dataset at hand. 

<<tcqconvgrmconstrained, echo=FALSE, results=tex>>=
tcqconv.grm.1pl <- grm(convtcq, constrained=TRUE)
tcqconv.grm1.coef <- coef(tcqconv.grm.1pl)
print(xtable(tcqconv.grm1.coef))
@ 

It can be seen from Table \ref{tab:tcqconvgrmconstrained} that the fit is much better for this model, with no violations of monotonicity. The next step taken is to examine the fit of a more flexible model (with a discrimination parameter for each item), and assess whether or not this represents a significant enough improvement over the model above.

<<tcqconvgrm2, echo=FALSE, results=tex>>=
tcqconv.grm.2pl <- grm(convtcq, constrained=FALSE)
tcqconv.grm2.coef <- coef(tcqconv.grm.2pl)
print(xtable(tcqconv.grm2.coef))
@ 

<<tcqgrmcomp, echo=FALSE, results=tex>>=
grm.comp <- anova(tcqconv.grm.1pl, tcqconv.grm.2pl)
@ 
The result of this model comparison exercise showed that the 1 parameter model was a significantly better fit than the 2 parameter model ($p\le 0.001$). Next, the fit of the alternative tcq (i.e. the acupuncture items) was examined under both the partial credit model and the graded response model.  

<<tcqaltpcm, echo=FALSE, results=tex>>=
tcqalt.pcm.rasch <- gpcm(tcqalt, constraint="rasch")
tcqaltcoef <- coef(tcqalt.pcm.rasch)
print(xtable(tcqaltcoef))
@ 

Unlike the partial credit model formed from the conventional items, the scale composed of the acupuncture items shows no clear violations of monotonicity (Table \ref{tab:tcqaltpcm}), even when a simple Rasch model is fitted. Next, more complex versions of the partial credit model are fitted to examine if they add useful predictive power to the model. 

<<tcqaltpcm1pl, echo=FALSE, results=tex>>=
tcqalt.pcm.1pl <- gpcm(tcqalt, constraint="1PL")
tcqaltcoef.1pl <- coef(tcqalt.pcm.1pl)
print(xtable(tcqaltcoef.1pl))
@ 

The examination of the more complex model with a discrimination parameter estimated from the data (Table \ref{tab:tcqaltpcm1pl}) shows that the acupuncture items can perhaps be modelled best with a much higher discrimination rather than higher ability estimates. An anova confirms that the 1 parameter model is a significantly better fit than the Rasch model fitted before ($p\le 0.001$). 

Next, a two parameter model was fitted to this data. 

<<tcqaltpcm2pl, echo=FALSE, results=tex>>=
tcqalt.pcm.2pl <- gpcm(tcqalt, constraint="gpcm")
tcqaltcoef.2pl <- coef(tcqalt.pcm.2pl)
print(xtable(tcqaltcoef.2pl))
@ 
The two parameter model has some interesting features compared to the one parameter model. Firstly, the discrimanation parameter of Items 1 and 3 have significantly decreased compared to the one parameter model. The discrimination parameter for Acu 2 has lowered slightly. The discrimination of the other three items has icnreased substantially. An anova between the two models shows that the model is a significant improvement on the one parameter model ($p\le 0.001$). 

Next, two graded response models were fit to the the alternative tcq question-set. 

<<tcqaltgrm1, echo=FALSE, results=tex>>=
tcqalt.grm.constrained <- grm(tcqalt, constrained=TRUE)
tcqalt.grm1.coef <- coef(tcqalt.grm.constrained)
print(xtable(tcqalt.grm1.coef))
@ 

The model described in Table \ref{tab:tcqaltgrm1} is quite different from the one parameter model estimated under the partial credit model. Firstly, the discrimination parameter is estimated at a much lower level (3.88 as opposed to 5.20). In addition, the parameter estimates are much more closely distributed around zero, and the category 4 parameter estimates are much less extreme. 

<<tcqaltgrm2, echo=FALSE, results=tex>>=
tcqalt.grm2 <- grm(tcqalt)
tcqalt.grm2.coef <- coef(tcqalt.grm2)
print(xtable(tcqalt.grm2.coef))
@ 

Again, the model shown in Table \ref{tab:tcqaltgrm2} has a much lower estimate of the discrimination of the individual items, counterbalanced by higher ability estimates for all of the item difficulty parameters. 


\subsection{Regression Analyses}
\label{sec:regression-analyses}

In this section, the totals for each of the treatment modalities are examined to determine if any of the demographic variables can account for them. Firstly, a linear regression was run on the Pilltotal variable using the demographics as predictors.

<<pilltotreg1, echo=FALSE, results=tex>>=
pillLm1 <- lm((PillTot/5)~Gender+College+UGPG+Year, data=tcq1)
@ 

\section{Confirmatory Analyses}
\label{sec:conf-analys}
<<tcq2importandsplit, echo=FALSE, results=hide>>=
tcq2 <- read.csv("tcq2.csv")
@ 

<<scalemake2, echo=FALSE, results=hide>>=
Pillall <- tcq2[,grep("Pill[1-6]", x=names(tcq2))]
Creamall <- tcq2[,grep("Cream[1-6]", x=names(tcq2))]
Injall <- tcq2[,grep("Inj[1-6]", x=names(tcq2))]
Acuall <- tcq2[,grep("Acu[1-6]", x=names(tcq2))]
Homall <- tcq2[,grep("Hom[1-6]", x=names(tcq2))]
Reiall <- tcq2[,grep("Rei[1-6]", x=names(tcq2))]
Bamall <- tcq2[,grep("BAM[1-18]", x=names(tcq2))]
tcq2$Pilltot <- apply(Pillall, 1, mean, na.rm=TRUE)
tcq2$Creamtot <- apply(Creamall, 1, mean, na.rm=TRUE)
tcq2$Injtot <- apply(Injall, 1, mean, na.rm=TRUE)
tcq2$Acutot <- apply(Acuall, 1, mean, na.rm=TRUE)
tcq2$Homtot <- apply(Homall, 1, mean, na.rm=TRUE)
tcq2$Reitot <- apply(Reiall, 1, mean, na.rm=TRUE)
tcq2$Bamtot <- apply(Bamall, 1, mean, na.rm=TRUE)
tcqtotals <- with(tcq2, as.data.frame(cbind(Pilltot, Creamtot, Injtot, Acutot, Homtot, Reitot, Bamtot)))
@ 
<<subsamplestcq2, echo=FALSE, results=hide>>=
set.seed(52)
tcq2.ind <- sample(1:1329, 1329, replace=FALSE)
tcq2.ind.a <-tcq2.ind[1:310]
tcq2.ind.b <-tcq2.ind[311:620]
tcq2.ind.c <-tcq2.ind[621:930]
tcq2.ind.d <- tcq2.ind[931:length(tcq2.ind)]
tcq2a <- tcq2[tcq2.ind.a,]
tcq2b <- tcq2[tcq2.ind.b,]
tcq2c <- tcq2[tcq2.ind.c,]
tcq2d <- tcq2[tcq2.ind.d,]
Pill.g <- grep("Pill[1-6]", x=names(tcq2a))
Cream.g <- grep("Cream[1-6]", x=names(tcq2a))
Inj.g <- grep("Inj[1-6]", x=names(tcq2a))
Acu.g <- grep("Acu[1-6]", x=names(tcq2a))
Hom.g <- grep("Hom[1-6]", x=names(tcq2a))
Rei.g <- grep("Rei[1-6]", x=names(tcq2a))
Pillall.a <- tcq2a[,Pill.g]
Creamall.a <- tcq2a[,Cream.g]
Injall.a <- tcq2a[,Inj.g]
Acuall.a <- tcq2a[,Acu.g]
Homall.a <- tcq2a[,Hom.g]
Reiall.a <- tcq2a[,Rei.g]
Bamall.a <- tcq2a[,grep("BAM[1-18]", x=names(tcq2a))]
tcq2.1 <- as.data.frame(cbind(Pillall.a, Creamall.a, Injall.a, Acuall.a))
tcqfull.a <- as.data.frame(cbind(Pillall.a, Creamall.a, Injall.a,
 Acuall.a, Homall.a, Reiall.a))
@ 

As in previous analyses, the second sample was much larger than the first, and therefore was split into a number of equal parts. In this case, the second sample (consisting of student and staff responses) was split into four equal sub-samples(A-D). The first of these (hereafter denoted as A), was then  used as a test sample for the models developed on the data from Sample 1. 

\subsection{Confirmatory Factor Analysis}
\label{sec:conf-fact-analys-1}

<<tcq4sem2a, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
Tcq4model2 <- mxModel(name="TCQ42", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcq2.1)), type="cov", numObs=310)
                      )
tcq4fit2 <- mxRun(Tcq4model2)
tcq4summ2 <- summary(tcq4fit2)
@ 


<<tcq5sem2, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Fifth")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
fifth <- c("Pill4", "Pill5", "Pill6", "Cream5", "Cream6", "Inj6")
Tcq5model2 <- mxModel(name="TCQ52", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                     mxPath(from="Fifth", to=fifth),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcqall)), type="cov", numObs=310))
tcq5fit2 <- mxRun(Tcq5model2)
tcq5summ2 <- summary(tcq5fit2)
@ 

<<tcq6sem2, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Fifth", "Sixth")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
fifth <- c("Pill1", "Pill3","Cream1", "Cream3","Inj1", "Inj3")
sixth <- c("Pill2", "Pill4","Inj2", "Inj4")
Tcq6model2 <- mxModel(name="TCQ62", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Pills", to=pills), 
                      mxPath(from="Creams", to=creams),
                      mxPath(from="Injections", to=inj),
                      mxPath(from="Acupuncture", to=Acu),
                     mxPath(from="Fifth", to=fifth),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                      mxData(observed=cov(na.omit(tcq2.1)), type="cov", numObs=310))
tcq6fit2 <- mxRun(Tcq6model2)
tcq6summ2 <- summary(tcq6fit2)
@ 

<<tcq2testsemcomp, echo=FALSE, results=tex>>=
tcq2.1.comp <- mxCompare(tcq4fit2, comparison=c(tcq5fit2, tcq6fit2))
print(summary(xtable(tcq2.1.comp)))
@ 

As can be seen from Table \ref{tab:tcq2testsemcomp} the six factor model appears to fit the data best, even on this unseen data-set. This is somewhat unexpected, especially given the compelling reasons to believe in a four factor model. 

\section{Study Two}

Given the results of Study 1, this study added two more CAM methodologies to the questionnaire, to determine if a higher order factor structure could be found which represented conventional and complementary methodologies.
The hypotheses were as follows: 

1)The TCQ V2.0 will have six factors, one for each treatment modality
2)The BAM will have two factors 
3)The BAM will correlate negatively with the Pills, Cream and Injection totals, and positively with the Acupuncture, Homeopathy and Reiki totals. 
4)The TCQ will not fit an item response theory model well, and will need to be divided into TCQ Conventional (Pills, Creams, Injections) and a TCQ Alternative (Acupuncture, Homeopathy and Reiki) in order to meet the assumptions of the model. 
5)Income will correlate postively with experience of CAM methodologies
6)Experience with a particular treatment will be correlated with higher ratings of its credibility

% \subsection{Materials and Methods}

% \subsubsection{Measures}

% The instrument used for this research was the Treatment Credibility Questionnaire, Version 2. Version 2 differed from Version 1 in that it added two new sections to the instrument, following the same format as Study 1. These two sections concerned the credibility of Homeopathy and Reiki for pain. A number of demographic variables were also added to the survey. These asked for Income rated in units of 25K (i.e. 0-25K, 25-50K, 50-75K, 75-100K, 100K+). Self reported health was also measured on a five point scale, as were experience with each of the treatment modalities assessed in the questionnaire (i.e. Pills, Cream, Injections, Acupuncture, Homeopathy, Reiki). 

% In addition to this, the Beliefs about Medicine Questionnaire (BAM) was administered to all participants. This is an instrument developed to assess the beliefs of chronic pain patients regarding their medicines. This instrument was included in order to validate the TCQ by means of correlations with this similar measure. The BAM is an eight item measure which purports to have two factors. The eight items were those retained from a pool of 16 items which derived from interviews with chronic pain patients. All 16 items were administered to all participants, but only the final eight items are analysed here. 

% \subsubsection{Sample}

% The sample was collected from the University College Cork (UCC) staff and student population.. Data collection took place from the 3rd of April 2010 until the end of May 2010. 
% All of the sample responses were collected electronically using Survey Monkey. 

% \subsubsection{Statistical Analyses}

% The plan for statistical analysis was as follows. Data will first be visualised using graphical tools such as scatter plot matrices and conditioning plots.  Following this, demographic variables were to be summarised. Secondly, correlations between any of the scale totals and the demographics were analysed. Thirdly, the BAM and the TCQ will be subjected to confirmatory factor analysis, which will include assessing the factor structure of the data using parallel analysis techniques and the Minimum Average Partial Criterion (MAP). 

% Fourthly, an item response theory analysis will be carried out to determine how the items fit together. Finally, the ability estimates generated from the IRT methodology will be used as the dependent variable in a multiple regression to assess which, if any, of the demographic variables are useful in predictors. This procedure will also allow for the impact of Differential Item Functioning to be assessed.  

% Missing data will be ignored for the purposes of this analysis, and data may be imputed and re-analysed following the complete case analysis, in order to check the Missing completely at Random (MCAR) assumption inherent in the use of a complete case analysis (CCA). All statistical analysis was carried out using the R software for statistical computing Version 2.11.0.  



\subsection{Results}
\subsubsection{Descriptive Statistics}

The sample size collected was 1329, however, only 700 completed all questions. The analysis was carried out on those participants who had provided data for all questions. 

<<tcq2demo, echo=FALSE, results=tex>>=
tcq2.demo <- tcq2[,2:17]
tcq2.sum <- summary(tcq2.demo)
print(xtable(tcq2.sum))
@ 
\label{tab:tcq2demo}
\caption{Demographic Statistics, TCQ 2}

As can be seen from the second column of Table \ref{tab:tcq2demo} , many respondents stopped answering questions throughout the demographic variables. The reasons for this are unknown, but are probably not related to the design in any substantial way. The median age is 22, which shows that most of the sample was made up of students.
The Health variable is quite skewed, as most respondents rated their health as very good as good, as can be seen from the mean and the median. 
The mean level of experience with a particular treatment was highest for pills and steadily declined for all of the other treatments. 

The sample was 67.88\% female, and 29.12\% male, with 45 respondents not specifying their gender. 

The next step in the analysis is visualisation of data using scatterplot matrices and conditioning plots. Below, in Figure \ref{fig;tcq 0.795-42}, the correlations between the scale totals can be seen.
@ 

\begin{figure}
	\centering
<<tcq2pairs, echo=FALSE, fig=TRUE>>=
print(pairs.panels(tcqtotals))
@ 
	\caption{Scatterplot Matrix, TCQ 2}
	\label{fig:tcq2pairs}
\end{figure}
The variables are, in order: Pilltotal, Creamtotal, Injection total, Acupuncture Total, Homeopathy Total, Reiki Total and Beliefs about Medicine Total. 


As can be seen from Figure \ref{fig:tcq2pairs}, the predicted relationship appear to be apparent. The high inter-correlations between the first three sub-scales of the TCQ and the last three are immediately apparent, and there is no evidence of nonlinearity in any of the relationships which is useful given the intention to model some of these later in the analyses. 
Interestingly enough, it can be seen from Figure \ref{fig:tcq2pairs} that the Beliefs About Medicine Questionnaire totals seem normally distributed, which is unexpected (Micceri et al, 1989). The histograms for the alternative treatments are also quite interesting, given that they appear to have a number of peaks with very little in between. This may reflect the polarised nature of the attitudes towards these treatments. It may be (for example) that those involved with medicine tend to rate them very low, while those involved in the liberal arts tend to rate them quite highly. These kinds of differences will be teased apart in analyses below. 

The next step was to examine the interactions between total scores and various demographic variables. Given the underlying non-normality of the distributions of the variables involved (see Table \ref{tab:tcq2.normtests} , Kruskal Wallis tests were used for this purpose and the results can be seen in Tables 6 and 7 below. To assess whether the errors would be normally distributed, qqplots for the residuals were analysed. The data did not meet the assumptions, further justifying the use of non-parametric statistics.  

<<credgender, echo=FALSE, results=tex>>=
gendPill <- with(tcq2, tapply(Pilltot, Gender, mean, na.rm=TRUE))
gendCream <- with(tcq2, tapply(Creamtot, Gender, mean, na.rm=TRUE))
gendInj <- with(tcq2, tapply(Injtot, Gender, mean, na.rm=TRUE))
gendAcu <- with(tcq2, tapply(Acutot, Gender, mean, na.rm=TRUE))
gendHom <- with(tcq2, tapply(Homtot, Gender, mean, na.rm=TRUE))
gendRei <- with(tcq2, tapply(Reitot, Gender, mean, na.rm=TRUE))
gendBam <- with(tcq2, tapply(Bamtot, Gender, mean, na.rm=TRUE))
gendcred <- as.data.frame(cbind(gendPill, gendCream, gendInj, gendAcu, gendHom, gendRei, gendBam))
print(xtable(gendcred))
@ 
\caption{Credibility Differences by Gender}
\label{tab:tcq2.collegecred}


As can be seen from Table \ref{tab:tcq2.collegecred}, there were significant differences between the credibility totals in each college for the three conventional treatment modalities. This appears to be due to higher credibility totals amongst those respondents whose primary affiliation was with the College of Medicine and Health. The Beliefs about Medicine difference makes sense as the questions are quite negative towards medicines, and it would be expected that many Medicine and Health students would disagree with them, given their perspective.


<<credgender, echo=FALSE, results=tex>>=
collPill <- with(tcq2, tapply(Pilltot, College, mean, na.rm=TRUE))
collCream <- with(tcq2, tapply(Creamtot, College, mean, na.rm=TRUE))
collInj <- with(tcq2, tapply(Injtot, College, mean, na.rm=TRUE))
collAcu <- with(tcq2, tapply(Acutot, College, mean, na.rm=TRUE))
collHom <- with(tcq2, tapply(Homtot, College, mean, na.rm=TRUE))
collRei <- with(tcq2, tapply(Reitot, College, mean, na.rm=TRUE))
collBam <- with(tcq2, tapply(Bamtot, College, mean, na.rm=TRUE))
collcred <- as.data.frame(cbind(collPill, collCream, collInj, collAcu, collHom, collRei, collBam))
print(xtable(collcred))
@ 

\caption{Credibility Differences by College}
\label{tab:tcq2.collegecred}


As can be seen from Table \ref{tab:tcq2.gendercred}, the sample scores showed some significant differences attributable to Gender. The cream, acupuncture, homeopathy and reiki totals were significantly different in the sample, as was the Beliefs About Medicine scale total. The usual caveats regarding multiple comparisons do of course apply to this finding. 

Following these investigations of the descriptive qualities of the data, the next stage of the analysis is to examine the inter-correlations and latent structure behind the data through the use of factor analysis. 


\subsubsection{Factor Analysis}


% Factor Analysis is a complicated technique, in which there are many wrong ways and no clear right way. Much of the confusion stems from the lack of an objective metric to determine the number of factors to extract from the data. However, there are a number of criteria which can be of help in this endeavour, and experts recommend that multiple approaches be utilised. Therefore, for this study, 3 methods were used. These three methods are Parallel Analysis, the Minimum Average Partial criterion and visual inspection of the scree plot. Oblimin rotations were used in the first instance, as orthogonal structure can be determined from obliquely rotated data but not vice versa. Principal Acis factoring methods were used, given the non-normality of the data. 

\subsubsection{Treatment Credibility Questionnaire, Version 2}

\subsubsection{TCQ Version2 Split A}
\label{sec:tcq-version2-split}

<<scales2a, echo=FALSE, results=hide>>=
Pillall2a <- tcq2a[,grep("Pill[1-6]", x=names(tcq2a))]
Creamall2a <- tcq2a[,grep("Cream[1-6]", x=names(tcq2a))]
Injall2a <- tcq2a[,grep("Inj[1-6]", x=names(tcq2a))]
Acuall2a <- tcq2a[,grep("Acu[1-6]", x=names(tcq2a))]
Homall2a <- tcq2a[,grep("Hom[1-6]", x=names(tcq2a))]
Reiall2a <- tcq2a[,grep("Rei[1-6]", x=names(tcq2a))]
bamall2a <- tcq2a[,53:70]
tcqall2a <- as.data.frame(cbind(Pillall2a, Creamall2a, Injall2a, Acuall2a, Homall2a, Reiall2a))
@ 

The results of factor analysis on the Treatment credibility Questionnaire can be seen in Figure \ref{fig:tcq2aparallel}, below. 

\begin{figure}
	\centering
<<tcq2aparallel, echo=FALSE, fig=TRUE>>=
tcq2a.para <- fa.parallel(na.omit(tcqall2a))
tcq2a.vss <- VSS(na.omit(tcqall2a))
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2}
	\label{fig:tcq2aparallel}
\end{figure}

As can be seen from Figure \ref{fig:tcq2aparallel}, both the parallel analysis and the scree plot agree that six factors seems most optimal for this instrument. However, the MAP criterion disagrees, suggesting that seven factors might be more appropriate. To determine which of these criteria is correct, both the six and seven factor solutions will be examined for interpretability. 
<<tcq2afact6, echo=FALSE, results=tex>>=
tcq2a.fact.6 <- fa(na.omit(tcqall2a), nfactors=6, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2a.fact.6, label="tcq2afact6"))
@ 
\caption{Six factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2afact6}

As can be seen from Table \ref{tab:tcq2.sixfactor} , this factor structure fits the predicted one extremely well. The six factors map exactly to the six treatment modalities. PA5 equates to Reiki, PA1 to Homeopathy, PA4 to Acupuncture, PA3 to Cream, PA2 to Injections and PA6 equates to Pills. 

Below can be seen the correlations between factors, in Table \ref{tab:tcq2.sixfactorcorr} 
<<tcq2afactorcor, echo=FALSE, results=tex>>=
print(FactorCor(tcq2a.fact.6, label="tcq2afactorcor"))
@ 


\caption{Factor Correlations, Six Factor Solution TCQ 2}
\label{tab:tcq2.sixfactorcorr}


The proportion of variance explained by the six factor solution is equal to 82\% which is an extremely high amount, arguing for the usefulness of this solution. 

As can be seen from Table \ref{tab:tcq2.sixfactorcorr}, the correlations between factors are very similar to those between the total scores, which is perhaps unsurprising as both are linear combinations of the scores on each questions. Nonetheless, this gives supporting evidence in favour of the utility of this solution. 

<<tcq2afact7, echo=FALSE, results=tex>>=
tcq2a.fact.7 <- fa(na.omit(tcqall2a), nfactors=7, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2a.fact.7, label="tcq2afact7"))
@ 

\caption{Seven Factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2sevenfactor}

Table \ref{tab:tcq2sevenfactor} is enlightening in that it can be seen that factor 7 has no questions loading highest on it. Therefore, we can probably use the six factor structure on the basis of this data. 
The correlations between the factors are reported in Table \ref{tab:tcq2a7factorcorr}.

<<tcq2a7factorcorr, echo=FALSE, results=tex>>=
print(FactorCor(tcq2a.fact.7, label="tcq2a7factorcorr"))
@ 

<<tcq2afitindices, echo=FALSE, results=tex>>=
tcq2aFit6 <- FitIndices(tcq2a.fact.6)
tcq2aFit7 <- FitIndices(tcq2a.fact.7)
tcq2afit <- as.data.frame(cbind(tcq2aFit6, tcq2aFit7))
print(xtable(tcq2afit))
@ 
\caption{Fit Indices, TCQ 2}
\label{tab:tcq2.fit}


Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 
This questionnaire was developed for use with chronic pain patients. It appears to be the standard in the field, however, it was only analysed using a principal components method and Varimax rotation, neither of which are appropriate for an instrument of this kind. 
The first step is to examine the criteria for the retention of factors. As above, parallel analysis and the minimum average partial criterion were used for this purpose. 

<<bamparallel, echo=FALSE, fig=TRUE>>=
bam.para <- fa.parallel(na.omit(bamall2a))
bam.vss <- VSS(na.omit(bamall2a))
@ 

The parallel analysis suggests that there are four factors, while the MAP criterion suggests that only one is useful. In line with previous practice, all four factor solutions will be examined for interpretability and fit indices before being tested on another of the data splits. 

<<bam2afact1, echo=FALSE, results=tex>>=
bam2a.fact1 <- fa(na.omit(bamall2a), 1, fm="pa")
print(FactorXtab(bam2a.fact1, label="bam2afact1"))
@ 

As can be seen from Table \ref{tab:bam2afact1}, the one factor solution is extremely poor. Only 11 of the 18 items have loadings above 0.3, which is typically used as a cutoff for the assigning of items to the factor. In addition, the communalities for all of the items are extremely low, all below 0.5 which indicates that the common variance of this solution is quite low. This one factor solution only explains 17\% of the variance and so is somewhat inadequate in all senses. 

<<bam2afact2, echo=FALSE, results=tex>>=
bam2a.fact2 <- fa(na.omit(bamall2a), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact2, label="bam2afact2"))
@ 
Again, the communalities in this factor solution are very low, and the amount of variance explained is 23\%, which is again quite poor. In addition, six items have no loadings above 0.3 on either of the factors. 

PA1: "BAM1"  "BAM6"  "BAM7"  "BAM9"  "BAM12" "BAM13" "BAM14" "BAM17" "BAM18".  All of these items appear to relate to the avoidance of medicines (the items which are positive towards medicines have negative loadings), so this factor can be termed Medicine Avoidance. 

PA2: "BAM2"  "BAM7"  "BAM10" "BAM11". These items all appear to relate to natural remedies in constrast to medicines and so this factor can be termed Natural Remedies.

Although there appears to be an interpretable factor structure emerging from this solution, it should be noted that the large number of items not loading on any solution and the low proportion of variance explained caution against over-interpretation of this solution. 


<<bam2afact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact2,label="bam2afact2cor"))
@ 

As can be seen from Table \ref{tab:bam2afact2cor}, the two factors are moderately correlated, supporting the decision to use oblimin rotation. 

<<bam2afact3, echo=FALSE, results=tex>>=
bam2a.fact3 <- fa(na.omit(bamall2a), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact3, label="bam2afact3"))
@ 
Again, the communalities for this solution are extremely low, with almost all of them (16) below 0.5. This solution explained 29\% of the variance. The factors are described below. 

PA1: "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM12" "BAM13" "BAM14" "BAM17" "BAM18". This factor again relates to less use of medicines, and as above can be termed medicine avoidance. 

PA3: "BAM1"  "BAM3"  "BAM4"  "BAM10". All of these items appear to relate to cutting down or taking a break from medicine (with the exception of Question 1 which has a negative loading). Therefore, this factor will be termed safer use of medicines. 

PA2: "BAM1"  "BAM2"  "BAM7"  "BAM10" "BAM11". These items relate to the  responsible use of medicines, and this is what the factor will be termed. 



<<bam2afact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact3,label="bam2afact3cor"))
@ 

Again, Table \ref{tab:bam2afact3cor} shows that the factors are somewhat correlated, although the correlations of factor 3 are much smaller. 

<<bam2afact4, echo=FALSE, results=tex>>=
bam2a.fact4 <- fa(na.omit(bamall2a), 4, rotate="oblimin", fm="pa")
print(FactorXtab(bam2a.fact4, label="bam2afact4"))
@ 

This solution explained 33\% of the variance, but again only 3 of the 18 items had communalities which were greater than 0.5, indicating that there is a large amount of unexplained variance in this item set. 

PA1: "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM12" "BAM13" "BAM14" "BAM17" "BAM18". Again, this factor has emerged from the rotations, and again it can be termed medicine avoidance. 

PA3: "BAM1"  "BAM3"  "BAM4"  "BAM10". All of these items appear to relate to the effectiveness of medicines, and this factor can then be termed Medicine effectiveness. 
PA2: "BAM1"  "BAM2"  "BAM7"  "BAM10" "BAM11" "BAM16" "BAM18". These items all appear to relate to differences between different forms of medicine, and so this factor will be termed Differences Between Medicines.

PA4: "BAM5". This factor is almost certainly spurious, given that it only has one item on it. This item relates to regular taking of medicines, and so it can be termed Regular Taking of Medicines. 


<<bam2afact4cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2a.fact4,label="bam2afact4cor"))
@ 

As before, Table \ref{tab:bam2afact4cor} shows large correlations between factors 1 and 2, but quite small correlations between factors 3 and 4. 

@ 

%put in other 3 sem fits, although i suspect they won't converge. Look for debugging information online when you have internet. 

\subsection{Split B}
\label{sec:split-b}

Next, the same process of analysis will be repeated on the second of four splits of the data. 

<<tcq2bscalesplit, echo=FALSE, results=hide>>=
tcqall2b <- tcq2b[,17:52]
bamall2b <- tcq2b[,53:70]
@ 

\begin{figure}
	\centering
<<tcq2aparallel, echo=FALSE, fig=TRUE>>=
tcq2b.para <- fa.parallel(na.omit(tcqall2b))
tcq2b.vss <- VSS(na.omit(tcqall2b))
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split B)}
	\label{fig:tcq2aparallel}
\end{figure}

As can be seen from Figure \ref{fig:tcq2aparallel}, both the parallel analysis and the scree plot suggest that five factors seems most optimal for this instrument. However, the MAP criterion disagrees, suggesting that seven factors might be more appropriate. To determine which of these criteria is correct, the five,  six and seven factor solutions will be examined for interpretability and then subjected to CFA on the other splits of the data.

<<tcq2afact5, echo=FALSE, results=tex>>=
tcq2b.fact.5 <- fa(na.omit(tcqall2b), nfactors=5, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2b.fact.5, label="tcq2afact5"))
@ 
\caption{Five factor Solution, TCQ 2 (Split B), Oblimin Rotation}
\label{tab:tcq2bfivefactor}

The five factor solution broke down as follows:
It explained 81\% of the variance, and all the communalities were greater than 0.5. 

PA2: "Pill1" "Pill2" "Pill3" "Pill4" "Pill5" "Pill6" "Inj1"  "Inj2"  "Inj3"  "Inj4"  "Inj5"  "Inj6". This factor appears to consist of the Pill and Injection questions, and so can be termed Pills \& Injections.

PA3:"Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". This factor consists of the Cream questions and can thus be termed Creams. 

PA5: "Rei1"  "Rei2"  "Rei3"  "Rei4"  "Rei5"  "Rei6". There was a small negative loading on Pill1 for this factor, but given its strong loadings on other factors, this was ignored. This left this factor consisting solely of the Reiki items, and so this factor was termed Reiki. 

PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6". This factor consisted solely of the homeopathy items, and thus was termed Homeopathy.

PA4: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This factor consisted solely of the Acupuncture items and thus was termed acupuncture. 


Below can be seen the correlations between factors, in  Table\ref{tab:tcq2bfactorcor5}. 

<<tcq2bfactorcor5, echo=FALSE, results=tex>>=
print(FactorCor(tcq2b.fact.5,label="tcq2bfactorcor5"))
@ 


<<tcq2bfact6, echo=FALSE, results=tex>>=
tcq2b.fact.6 <- fa(na.omit(tcqall2b), nfactors=6, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2b.fact.6,label="tcq2bfact6"))
@ 
\caption{Six factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2.sixfactor}

As can be seen from Table \ref{tab:tcq2.sixfactor} , this factor structure fits the predicted one extremely well. The six factors map exactly to the six treatment modalities. PA5 equates to Reiki, PA1 to Homeopathy, PA4 to Acupuncture, PA3 to Cream, PA2 to Injections and PA6 equates to Pills. One small exception to this was that Pill1 loaded slightly onto the Reiki factor. However, in light of its strong loading on other factors, this was disregarded.  

Below can be seen the correlations between factors, in Table \ref{tab:tcq2.sixfactorcorr} 
<<tcq2afactorcor, echo=FALSE, results=tex>>=
print(FactorCor(tcq2a.fact.6,label="tcq2afactorcor"))
@ 


\caption{Factor Correlations, Six Factor Solution TCQ 2}
\label{tab:tcq2.sixfactorcorr}


The proportion of variance explained by the six factor solution is equal to 84\% which is an extremely high amount, arguing for the usefulness of this solution. 

As can be seen from Table \ref{tab:tcq2.sixfactorcorr}, the correlations between factors are very similar to those between the total scores, which is perhaps unsurprising as both are linear combinations of the scores on each questions. Nonetheless, this gives supporting evidence in favour of the utility of this solution. 

<<tcq2afact7, echo=FALSE, results=tex>>=
tcq2b.fact.7 <- fa(na.omit(tcqall2b), nfactors=7, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2b.fact.7, label="tcq2afact7"))
@ 

\caption{Seven Factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2sevenfactor}

This solution explained 86\% of the variance in the sample, and the items were assigned to factors as follows.
PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6". This factor clearly maps to the Homeopathy questions, and is therefore termed as Homeoapathy.

PA5: "Pill1" "Rei1"  "Rei2"  "Rei3"  "Rei4"  "Rei5"  "Rei6". Again, apart from a small loading of Pill1 on this factor, it maps exactly to the Reiki questions, and thus will be termed Reiki. 

PA4: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This factor maps exactly to the Acupuncture questions, and will be termed thusly.

PA3: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". Again, this factor is an exact map to the Cream questions and thus is termed Creams.

PA2: "Inj1" "Inj2" "Inj3" "Inj4" "Inj5" "Inj6". These items are all Injection items, and so this factor gets that name. 

PA6: "Pill1" "Pill2" "Pill3" "Pill4" "Pill5" "Pill6". This factor maps to all of the pill items. 

PA7: "Pill3"  "Cream3" "Inj1"   "Inj3" . This factor is a little strange, as it only takes some of the questions from the conventional factors. It does take the confidence question from all three conventional methodologies, and thus can be termed confidence in conventional treatments. 


The correlations between the factors are reported in Table \ref{tab:tcq2b7factorcorr}.

<<tcq2b7factorcorr, echo=FALSE, results=tex>>=
print(FactorCor(tcq2b.fact.7,label="tcq2b7factorcorr"))
@ 

<<tcq2afitindices, echo=FALSE, results=tex>>=
tcq2bFit5 <- FitIndices(tcq.fact.5)
tcq2bFit6 <- FitIndices(tcq2b.fact.6)
tcq2bFit7 <- FitIndices(tcq2b.fact.7)
tcq2bfit <- as.data.frame(cbind(tcq2bFit5, tcq2bFit6, tcq2bFit7))
print(xtable(tcq2bfit))
@ 
\caption{Fit Indices, TCQ 2 (Split B)}
\label{tab:tcq2bfit}


Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 
The first step is to examine the criteria for the retention of factors. As above, parallel analysis and the minimum average partial criterion were used for this purpose. 

<<bamparallel, echo=FALSE, fig=TRUE>>=
bam.para <- fa.parallel(na.omit(bamall2b))
bam.vss <- VSS(na.omit(bamall2b))
@ 

The parallel analysis suggests that there are five factors, while the MAP criterion suggests that only one is useful. In line with previous practice, all five factor solutions will be examined for interpretability and fit indices before being tested on another of the data splits. 

<<bam2afact1, echo=FALSE, results=tex>>=
bam2b.fact1 <- fa(na.omit(bamall2b), 1, fm="pa")
print(FactorXtab(bam2b.fact1, label="bam2afact1"))
@ 

As can be seen from Table \ref{tab:bam2bfact1}, the one factor solution is extremely poor. That being said, it performs somewhat better than did the one factor solution on Split A. The loadings are higher across the board, but the communalities are still extremely low.It does explain 22\% of the variance, which is again higher than Split A.  

<<bam2bfact2, echo=FALSE, results=tex>>=
bam2b.fact2 <- fa(na.omit(bamall2b), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact2, label="bam2bfact2"))
@ 
Again, the communalities in this factor solution are very low, and the amount of variance explained is 30\%, which is again quite poor. In addition, two items have no loadings above 0.3 on either of the factors. It is however, a much better fit than the two factor solution was on Split A. 

PA1: "BAM3"  "BAM4"  "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM10" "BAM11" "BAM12" "BAM13" "BAM14" "BAM17" "BAM18". This factor, which consists of most of the scale, can be termed Medicine Avoidance.

PA2: "BAM1"  "BAM2"  "BAM11" "BAM16" "BAM18". These items relate to the responsible use of medicines, and thus this factor gets that name. 


<<bam2bfact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact2,label="bam2bfact2cor"))
@ 

As can be seen from Table \ref{tab:bam2bfact2cor}, the two factors are almost entirely uncorrelated, which is quite different from what is shown in Table \ref{tab:bam2afact2cor}. 

<<bam2bfact3, echo=FALSE, results=tex>>=
bam2b.fact3 <- fa(na.omit(bamall2b), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact3,label="bam2bfact3"))
@ 
This solution explained 34\% of the variance in the data. The factors broke down as follows:

PA1: "BAM3"  "BAM4"  "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM10" "BAM11" "BAM13" "BAM18". This factor was apparent in the two factor solution earlier, and again can be termed Medicine Avoidance. 

PA3: "BAM13" "BAM14" "BAM17". This factor can perhaps best be termed Medicine Trust. 

PA2: "BAM1"  "BAM2"  "BAM11" "BAM16" "BAM18". Again, this factor can best be termed responsible use of medicines. 


<<bam2bfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact3,label="bam2bfact3cor"))
@ 

Again, Table \ref{tab:bam2bfact3cor} shows that two of the factors are somewhat correlated, but the third is not. . 

<<bam2bfact4, echo=FALSE, results=tex>>=
bam2b.fact4 <- fa(na.omit(bamall2b), 4, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact4,label="bam2bfact4"))
@ 

PA3: "BAM12" "BAM13" "BAM14" "BAM17". These items almost all relate to doctors and medicine, and so this factor is termed Doctors and Medicine. 

PA4: "BAM3"  "BAM4"  "BAM6"  "BAM7"  "BAM10" "BAM11" "BAM15". These items have clustered together in almost all the solutions, and again are termed 
Avoidance of Medicines.

PA2: "BAM1"  "BAM2"  "BAM5"  "BAM16" "BAM18". Again, these items have tended to cluster together, and can best be termed as Responsible Use of Medicines. 

PA1: "BAM6"  "BAM8"  "BAM9"  "BAM18". These items all relate to safety or danger of medicines, and thus this factor will be termed Medicine Safety.



<<bam2bfact4cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact4,label="bam2bfact4cor"))
@ 

As before, Table \ref{tab:bam2afact4cor} shows large correlations between factors all of the factors save 3, which appears to be relatively uncorrelated with all of the other factors. 


<<bam2bfact5, echo=FALSE, results=tex>>=
bam2b.fact5 <- fa(na.omit(bamall2b), 5, rotate="oblimin", fm="pa")
print(FactorXtab(bam2b.fact5,label="bam2bfact5"))
@ 


PA3: "BAM13" "BAM14" "BAM17". Again, these items can best be subsumed as a factor called Doctors and Medicines. 

PA4: "BAM3"  "BAM4"  "BAM6"  "BAM7"  "BAM10" "BAM11" "BAM15". Again, this factor can best be termed Medicine Avoidance. 

PA2:"BAM2" "BAM5". These items relate to the best way in which to take medicines, and can thus be termed Effective Medicine Usage.

PA1: "BAM6"  "BAM11" "BAM18". These items all relate to the safety of medicines and thus this factor can be termed Safety and Medicines. 

PA5: "BAM8"  "BAM9"  "BAM15". These items relate to the dangers associated with medicines, and thus the factor can best be termed Danger and Medicines. 

<<bam2bfact5cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2b.fact5,label="bam2bfact5cor"))
@ 

As can be seen from Table \ref{tab:bam2bfact5cor}, all of the factors are moderately correlated with one another. 


\subsection{Split C}
\label{sec:split-c}

<<tcq2cscalesplit, echo=FALSE, results=hide>>=
tcqall2c <- tcq2c[,17:52]
bamall2c <- tcq2c[,53:70]
@ 

\begin{figure}
	\centering
<<tcq2cparallel, echo=FALSE, fig=TRUE>>=
par(mfrow=c(1,2))
tcq2c.para <- fa.parallel(na.omit(tcqall2c))
tcq2c.vss <- VSS(na.omit(tcqall2c))
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split B)}
	\label{fig:tcq2cparallel}
\end{figure}


<<tcq2cfact5, echo=FALSE, results=tex>>=
tcq2c.fact.5 <- fa(na.omit(tcqall2c), nfactors=5, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2c.fact.5,label="tcq2cfact5"))
@ 
\caption{Five factor Solution, TCQ 2 (Split B), Oblimin Rotation}
\label{tab:tcq2cfivefactor}

This solution explained 79\% of the variance, and all of the communalities were extremely high. 

PA2: "Pill1" "Pill2" "Pill3" "Pill4" "Pill5" "Pill6" "Inj1"  "Inj2"  "Inj3" "Inj4"  "Inj5"  "Inj6". This factor consists of the Pill and Injection items, and can therefore best be termed Pills and Injections.

PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6". This factor maps exactly to the Homeopathy items, and is therefore given that name.

PA5: "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". Again, this factor maps exactly to the Reiki items and is named after them.

PA4: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". PA4 maps to the Cream items and so retains that name. 

PA3: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". PA3 maps to the acupuncture items and so is termed Acupuncture. 

% PA2:"Pill1"  "Pill2"  "Pill3"  "Pill4"  "Pill5"  "Pill6"  "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6" "Inj1"   "Inj2"   "Inj3"   "Inj4"   "Inj5"   "Inj6". This factor consists of extremely high loadings on the Pill and Injection items, and moderate ($0.3-0.4$) loadings on the Cream items. It can therefore best be referred to as the Conventional treatments factors.

% PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6" "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". This factor appears to have small loadings on all of the alternative items, pointing towards this factor representing variance all these items had in common. This factor is therefore termed Alternative Treatments. 

% PA5: "Hom1" "Hom3" "Hom4" "Hom5" "Hom6" "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". This factor consists of moderate loadings on Homeopathy and large loadings on Reiki. This factor can probably best be termed Reiki and Alterntative Treatments. 

% PA3: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This factor maps exactly to the Acupuncture items and so retains that name. 

% PA4: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". This factor again maps exactly to the Creams items, and is therefore termed Cream. This factor solution was from a varimax rotation, note the interesting differences between it and the others. 


Table\ref{tab:tcq2cfactorcor5}. 

<<tcq2cfactorcor5, echo=FALSE, results=tex>>=
print(FactorCor(tcq2c.fact.5,label="tcq2cfactorcor5"))
@ 

Table \ref{tab:tcq2cfactorcor5} shows that the Pills/Injections factor correlated highly with the Cream factor (as would be expected), while the Alternative factors correlate quite well with one another also. Of particular note is Acupuncture, which appears to occupy a middle ground between the other alternative methods and the conventional ones, as least as evinced by this correlation structure. 


<<tcq2cfact6, echo=FALSE, results=tex>>=
tcq2c.fact.6 <- fa(na.omit(tcqall2c), nfactors=6, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2c.fact.6,label="tcq2cfact6"))
@ 
\caption{Six factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2.sixfactor}

Again, as can be seen in Table \ref{tab:tcq2cfact6} the six factors map exactly to the six forms of treatment, rendering an interpretation of the resulting factor solution rather superflous. 


<<tcq2cfactorcor, echo=FALSE, results=tex>>=
print(FactorCor(tcq2c.fact.6,label="tcq2cfactorcor"))
@ 
\caption{Factor Correlations, Six Factor Solution TCQ 2}
\label{tab:tcq2.sixfactorcorr}
Again (Table \ref{tab:tcq2.sixfactorcorr} ) shows that Acupuncture again shows correlations with the conventional factors, but homeopathy does also in this particular solution. This solution explained 83\% of the variance, which is consistent with the other splits and factor solutions examined so far. 







<<tcq2cfact7, echo=FALSE, results=tex>>=
tcq2c.fact.7 <- fa(na.omit(tcqall2c), nfactors=7, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2c.fact.7,label="tcq2cfact7"))
@ 



\caption{Seven Factor Solution, TCQ 2, Oblimin Rotation}
\label{tab:tcq2sevenfactor}

Again, the factors mostly break down into the six forms of treatment.

PA1: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6". This factor represents the homeopathy items and retains that name. 

PA5: "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". This is the Reiki items factor. 

PA3: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This is the Acupuncture items factor. 

PA4: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". This is the Cream factor. 

PA2:"Inj1" "Inj2" "Inj3" "Inj4" "Inj5" "Inj6". This is the Injections factor. 

PA6:"Pill1" "Pill2" "Pill3" "Pill4" "Pill5" "Pill6". This is the Pills factor. 

PA7: "Pill3" "Inj1"  "Inj3" . This factor has supplementary loadings for some of the Pill and Injection items, most notably the confidence in the treatment items, so this can best be termed Confidence in Treatment Factor. 

The correlations between the factors are reported in Table \ref{tab:tcq2c7factorcorr}.

<<tcq2c7factorcorr, echo=FALSE, results=tex>>=
print(FactorCor(tcq2c.fact.7,label="tcq2c7factorcorr"))
@ 

The seven factor solution shows high intercorrelations between each of the conventional forms of treatment and each of the alternative forms of treatment but does not show any real correlations between them (except for Acupuncture). 

<<tcq2cfitindices, echo=FALSE, results=tex>>=
tcq2cFit5 <- FitIndices(tcq2c.fact.5)
tcq2cFit6 <- FitIndices(tcq2c.fact.6)
tcq2cFit7 <- FitIndices(tcq2c.fact.7)
tcq2cfit <- as.data.frame(cbind(tcq2cFit5, tcq2cFit6, tcq2cFit7))
print(xtable(tcq2cfit))
@ 
\caption{Fit Indices, TCQ 2 (Split C)}
\label{tab:tcq2cfit}

It can be seen from Table \ref{tab:tcq2cfit} that the NNFI increases across all factor solutions, but is still quite low for an acceptable factor structure. The BIC performs likewise, reaching its lowest value for the seven factor solution. The RMSEA are uniformly poor, but again appear to be best for the seven factor solution. 

Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 

<<bam2cparallel, echo=FALSE, fig=TRUE>>=
bam2c.para <- fa.parallel(na.omit(bamall2c))
bam2c.vss <- VSS(na.omit(bamall2c))
@ 

The parallel analysis criterion suggests three factors here, while the MAP criterion suggests one, previous practice will be followed and the solutions with one, two and three factors will be extracted and examined. 

<<bam2cfact1, echo=FALSE, results=tex>>=
bam2c.fact1 <- fa(na.omit(bamall2c), 1, fm="pa")
print(FactorXtab(bam2c.fact1,label="bam2cfact1"))
@ 

The loadings and communalities are uniformly low for this solution, and ther proportion of variance explained was 20\%. 


<<bam2cfact2, echo=FALSE, results=tex>>=
bam2c.fact2 <- fa(na.omit(bamall2c), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2c.fact2,label="bam2cfact2"))
@ 
As can be seen from the listings of items which loaded on factors below, some of the items did not load on any factor, which is normally an indicator of a poor factor solution. 
PA1: "BAM2"  "BAM6"  "BAM8"  "BAM9"  "BAM10" "BAM13" "BAM14" "BAM17" "BAM18". All of these items appear to relate to the problems with medications, suggesting that this factor should be termed Medication Avoidance. 

PA2: "BAM2"  "BAM3"  "BAM7"  "BAM10" "BAM11" "BAM16". These items all appear to relate to the safe use of medicines, and so this factor is termed Safe Use of Medicines. 

<<bam2cfact2cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2c.fact2,label="bam2cfact2cor"))
@ 

As can be seen from Table \ref{tab:bam2cfact2cor}, the two factors are moderately correlated, in contrast to Split B ( Table \ref{tab:bam2bfact2cor}), but like Split A (Table \ref{tab:bam2afact2cor}). 

<<bam2cfact3, echo=FALSE, results=tex>>=
bam2c.fact3 <- fa(na.omit(bamall2c), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2c.fact3,label="bam2cfact3"))
@ 


PA1: "BAM13" "BAM14" "BAM17". All of these items relate to doctors and so this factor can best be termed Doctors and Medicines. 

PA3: "BAM3"  "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM10" "BAM18". All these items appear to relate to the safety of medicines, and so this factor is named thusly. 

PA2: "BAM2"  "BAM3"  "BAM11" "BAM16". These items refer to different types of medicines, and so this factor is termed Specific Use of Medicines. 

<<bam2cfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2c.fact3,label="bam2cfact3cor"))
@ 

The correlations shown in Table \ref{tab:bam2cfact3cor} are quite similiar to those found in the other three factor solutions, with two of the factors having moderate correlations while a third is not really correlated with this pair. 




\subsection{Split D}
\label{sec:split-d}

<<tcq2dscalesplit, echo=FALSE, results=hide>>=
tcqall2d <- tcq2d[,17:52]
bamall2d <- tcq2d[,53:70]
@ 

\begin{figure}
	\centering
<<tcq2dparallel, echo=FALSE, fig=TRUE>>=
par(mfrow=c(1,2))
tcq2d.para <- fa.parallel(na.omit(tcqall2d))
tcq2d.vss <- VSS(na.omit(tcqall2d))
@ 
	\caption{Parallel Analysis and Scree Plot TCQ 2 (Split D)}
	\label{fig:tcq2dparallel}
\end{figure}

In this Split, the parallel analysis criterion suggested six factors while the MAP criterion suggested seven. Following previous practice, these two solutions were reported and examined for adequacy of fit and interpretability. 


<<tcq2dfact6, echo=FALSE, results=tex>>=
tcq2d.fact.6 <- fa(na.omit(tcqall2d), nfactors=6, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2d.fact.6,label="tcq2dfact6"))
@ 
\caption{Six factor Solution, TCQ 2(Split D), Oblimin Rotation}
\label{tab:tcq2d.sixfactor}

As per all previous splits, the six factor solution mapped all six treatment modalities to the six factors, as is clearly shown in Table \ref{tab:tcq2dfact6}. This solution explained 81\% of the variance. 


<<tcq2dfactorcor, echo=FALSE, results=tex>>=
print(FactorCor(tcq2d.fact.6,label="tcq2dfactorcor"))
@ 
\caption{Factor Correlations, Six Factor Solution TCQ 2 (Split D)}
\label{tab:tcq2d.sixfactorcorr}

Similiarly to the results in other splits, the three conventional treatment factors and the three alternative factors correlated with each other but tended not to correlate highly with the factors of the opposite modality. Details of the correlations between factors are shown in Table \ref{tab:tcq2d.sixfactorcorr}. 



<<tcq2dfact7, echo=FALSE, results=tex>>=
tcq2d.fact.7 <- fa(na.omit(tcqall2d), nfactors=7, rotate="oblimin", fm="pa")
print(FactorXtab(tcq2d.fact.7,label="tcq2dfact7"))
@ 
\caption{Seven Factor Solution, TCQ 2, Oblimin Rotation (Split D)}
\label{tab:tcq2dsevenfactor}


This solution explained 84\% of the variance, an amount which was in line with that observed in other splits. 

PA1: "Rei1" "Rei2" "Rei3" "Rei4" "Rei5" "Rei6". These items map exactly to the Reiki questions, and so this factor will be termed Reiki. 

PA5: "Hom1" "Hom2" "Hom3" "Hom4" "Hom5" "Hom6". This factor will be termed Homeopathy. 

PA4: "Acu1" "Acu2" "Acu3" "Acu4" "Acu5" "Acu6". This factor will be termed Acupuncture. 

PA2: "Cream1" "Cream2" "Cream3" "Cream4" "Cream5" "Cream6". This factor will be termed Creams.

PA3: "Inj1" "Inj2" "Inj3" "Inj4" "Inj5" "Inj6". This factor will be termed Injections.

PA6: "Pill1" "Pill2" "Pill3" "Pill4" "Pill5" "Pill6". This factor will be termed Pills. 

PA7: "Pill3"  "Cream3" "Inj3" This factor has emerged in the other splits also, and again will be termed Confidence in Conventional Treatment.


\ref{tab:tcq2d7factorcorr}.

<<tcq2d7factorcorr, echo=FALSE, results=tex>>=
print(FactorCor(tcq2d.fact.7,label="tcq2d7factorcorr"))
@ 


<<tcq2dfitindices, echo=FALSE, results=tex>>=
tcq2dFit6 <- FitIndices(tcq2d.fact.6)
tcq2dFit7 <- FitIndices(tcq2d.fact.7)
tcq2dfit <- as.data.frame(cbind( tcq2dFit6, tcq2dFit7))
print(xtable(tcq2dfit))
@ 
\caption{Fit Indices, TCQ 2 (Split D)}
\label{tab:tcq2dfit}

Again as has been seen in previous splits, the NNFI increases, the BIC decreases along with the RMSEA. 

\ref{tab:tcq2dfit} 

Next, the beliefs about medicine questionnaire will be examined in terms of factor analysis. 

<<bam2dparallel, echo=FALSE, fig=TRUE>>=
bam2d.para <- fa.parallel(na.omit(bamall2d))
bam2d.vss <- VSS(na.omit(bamall2d))
@ 

The parallel analysis criterion suggests three factors here, while the MAP criterion suggests one, previous practice will be followed and the solutions with one, two and three factors will be extracted and examined. 

<<bam2dfact1, echo=FALSE, results=tex>>=
bam2d.fact1 <- fa(na.omit(bamall2d), 1, fm="pa")
print(FactorXtab(bam2d.fact1,label="bam2dfact1"))
@ 

As can be seen from Table \ref{tab:bam2dfact1}, the factor solution has a number of items (5, 11, 12, 15 \& 16) which do not load on it. This solution explained about 21\% of the variance which is quite poor, though in line with what we have seen in other splits for a one factor solution.  



<<bam2dfact2, echo=FALSE, results=tex>>=
bam2d.fact2 <- fa(na.omit(bamall2d), 2, rotate="oblimin", fm="pa")
print(FactorXtab(bam2d.fact2,label="bam2dfact2"))
@ 

PA2: "BAM3"  "BAM4"  "BAM6"  "BAM7"  "BAM8"  "BAM9"  "BAM10" "BAM11" "BAM18". These items all relate to the dangers surrounding medicines, and reasons to avoid using them, and so this factor can best be termed Safe use of Medicines. 

PA1: "BAM2"  "BAM6"  "BAM13" "BAM14" "BAM17". Most of these items relate to doctors and their use of medicines, and so this factor can best be termed Doctors and Medicines. 

<<bam2dfact2dcor, echo=FALSE, results=tex>>=
print(FactorCor(bam2d.fact2, label="bam2dfact2dcor"))
@ 

It can be seen from Table \ref{bam2dfact2dcor} that the two factors are moderately correlated, similarly to the previous splits. 





<<bam2dfact3, echo=FALSE, results=tex>>=
bam2d.fact3 <- fa(na.omit(bamall2d), 3, rotate="oblimin", fm="pa")
print(FactorXtab(bam2d.fact3,label="bam2dfact3"))
@ 

PA1: "BAM2"  "BAM13" "BAM14" "BAM17". Most of these items relate to doctors, and so this factor can best be termed Doctors and Medicines. 

PA3: "BAM1"  "BAM3"  "BAM6"  "BAM8"  "BAM18". These items all relate to the dangers surrounding medicines, and so this factor can best be termed Dangers of Medicines. 

PA2: "BAM7"  "BAM9"  "BAM10" "BAM11". These items all appear to relate to the dangers and avoidance of medicines, and so this factor can best be termed avoidance of medicines. 


<<bam2dfact3cor, echo=FALSE, results=tex>>=
print(FactorCor(bam2d.fact3, label="bam2dfact3cor"))
@ 

It can be seen from Table \ref{bam3dfact3cor} that all of the factors correlate moderately with one another, supporting the use of oblique rotations for this split. 

\subsection{Structural Equation Modelling}

Normally, cross-validation of particular models involves the setting aside of a small portion of the data for testing of the model. However, SEM and factor analytic requirements for relatively large sample sizes meant that this approach was not practicable. Therefore a different strategy was followed. In essence, a boosting strategy was attempted. This is where many models are fit on smaller subsets of the data, and then they are tested on a larger subset of the data (all of the data save those that they were trained on. So, for Split A models, they will be tested on all the data that was not included in Split A. This approach was taken in order to take advantage of the random variability in the smaller samples while maintaining a rigorous test on a large sample to ensure that only the best models survive. 

<<semsplits, echo=FALSE, results=hide>>=
tcq2nota <- tcq2[-tcq2.ind.a,]
tcq2notb <- tcq2[-tcq2.ind.b,]
tcq2notc <- tcq2[-tcq2.ind.c,]
tcq2notd <- tcq2[-tcq2.ind.d,]
tcqall2nota <- tcq2nota[,17:52]
tcqall2notb <- tcq2notb[,17:52]
tcqall2notc <- tcq2notc[,17:52]
tcqall2notd <- tcq2notd[,17:52]
bamnotA <- tcq2nota[,53:70]
bamnotB <- tcq2notb[,53:70]
bamnotC <- tcq2notc[,53:70]
bamnotD <- tcq2notd[,53:70]
@ 

\subsection{Split A CFA}
\label{sec:split-cfa}



<<tcq6notaSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq6modelnotA <- mxModel(name="TCQ6notA", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2nota)), type="cov", numObs=460))
tcq6fit.notA <- mxRun(Tcq6modelnotA)
tcq6summ.notA <- summary(tcq6fit.notA)
@ 

<<tcq7notAsem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Seven")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
seven <- c("Inj1", "Inj3")
Tcq7modelnotA <- mxModel(name="TCQ7notA", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Seven", to=seven),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2nota)), type="cov", numObs=460))
tcq7fit.notA <- mxRun(Tcq7modelnotA)
tcq7summ.notA <- summary(tcq7fit.notA)
@ 

<<tcq2notAsemcompare, echo=FALSE, results=tex>>=
tcq2.notA.semcompare <- mxCompare(tcq6fit.notA, tcq7fit.notA)
print(xtable(tcq2.notA.semcompare, label="tab:tcq2notAsemcompare"))
@ 

It can be seen from Table \ref{tab:tcq2notAsemcompare} that the seven factor model from Split A provided a better fit to the out of sample data than did the 6 factor model. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split A will be tested on the out of sample data. 

<<bam1notAsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,9,10,12,13,14,17), sep="")
bamnoload <- paste(Bam, c(1,2,5,8,11,15,16, 18), sep="")
Bam1modelnotA<- mxModel(name="Bam1notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam1fitnotA <- mxRun(Bam1modelnotA)
Bam2asumm1 <- summary(Bam1fitnotA)
@ 

<<bam2notAsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Natural Remedies" )
medavoid <- paste(Bam, c(1,6,7,9,12,13,14,17,18), sep="")
natrem <- paste(Bam, c(2,7,10,11), sep="")
bamnoload <- paste(Bam, c(3,4,5,8,15,16), sep="")
Bam2modelnotA<- mxModel(name="Bam2notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Natural Remedies", to=natrem),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam2fitnotA <- mxRun(Bam2modelnotA)
Bam2asummnotA <- summary(Bam2fitnotA)
@ 


<<bam3notAsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safer Medicines","Responsible Use of Medicines"  )
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
safemed <- paste(Bam, c(1,3,4,10), sep="")
respmed <- paste(Bam, c(1,2,7,10,11), sep="")
bamnoload <- paste(Bam, c(5,15,16), sep="")
Bam3modelnotA<- mxModel(name="Bam3notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam3fitnotA <- mxRun(Bam3modelnotA)
Bam3asummnotA <- summary(Bam3fitnotA)
@ 


<<bam4notAsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotA<- mxModel(name="Bam4notA", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotA)), type="cov", numObs=524))
Bam4fitnotA <- mxRun(Bam4modelnotA)
Bam4asummnotA <- summary(Bam4fitnotA)
@ 

<<bamnotAsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notA <- mxCompare(Bam1fitnotA, c(Bam2fitnotA, Bam3fitnotA, Bam4fitnotA))
print(xtable(bamsemcompare.notA, label="tab:bamnotAsemcompare"))
@ 

As can be seen from Table \ref{tab:bamnotAsemcompare}, the four factor solution appears to replicate best on the out of sample data. 

\subsection{Split B CFA}
\label{sec:split-b-cfa}

<<tcq5notbSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
pillinj.cols <- c(pillitems.cols, Injitems.cols)
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills & Injections", "Creams", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
pillinj <- c(pills, inj)
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq5modelnotB <- mxModel(name="TCQ5notB", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills & Injections", to=pillinj), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notb)), type="cov", numObs=450))
tcq5fit.notB <- mxRun(Tcq5modelnotB)
tcq5summ.notB <- summary(tcq5fit.notB)
@ 


<<tcq6notbSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq6modelnotB <- mxModel(name="TCQ6notB", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notb)), type="cov", numObs=460))
tcq6fit.notB <- mxRun(Tcq6modelnotB)
tcq6summ.notB <- summary(tcq6fit.notB)
@ 

<<tcq7notBsem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Cream3", "Inj1", "Inj3")
Tcq7modelnotB <- mxModel(name="TCQ7notB", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notb)), type="cov", numObs=460))
tcq7fit.notB <- mxRun(Tcq7modelnotB)
tcq7summ.notB <- summary(tcq7fit.notB)
@ 

<<tcq2notBsemcompare, echo=FALSE, results=tex>>=
tcq2.notB.semcompare <- mxCompare(tcq5fit.notB,c(tcq6fit.notB, tcq7fit.notB))
print(xtable(tcq2.notB.semcompare, label="tab:tcq2notBsemcompare"))
@ 

It can be seen from Table \ref{tab:tcq2notBsemcompare} that the seven factor model from Split B provided a better fit to the out of sample data than did the 6 factor model. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split B will be tested on the out of sample data (that is, Splits A, C and D). 

<<bam1notBsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotB<- mxModel(name="Bam1notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=512))
Bam1fitnotB <- mxRun(Bam1modelnotB)
Bam1asumm.notB <- summary(Bam1fitnotB)
@ 

<<bam2notBsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Responsible Use of Medicines")
medavoid <- paste(Bam, c(3,4,6,7,8,9,10,11,12,13,14,17,18), sep="")
respmed <- paste(Bam, c(1,2,11,16,18), sep="")
bamnoload <- paste(Bam, c(5,15), sep="")
Bam2modelnotB <- mxModel(name="Bam2notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=512))
Bam2fitnotB <- mxRun(Bam2modelnotB)
Bam2asummnotB <- summary(Bam2fitnotB)
@ 


<<bam3notBsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safer Medicines","Responsible Use of Medicines"  )
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
safemed <- paste(Bam, c(1,3,4,10), sep="")
respmed <- paste(Bam, c(1,2,7,10,11), sep="")
bamnoload <- paste(Bam, c(5,15,16), sep="")
Bam3modelnotB<- mxModel(name="Bam3notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=524))
Bam3fitnotB <- mxRun(Bam3modelnotB)
Bam3asummnotB <- summary(Bam3fitnotB)
@ 


<<bam4notBsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotB<- mxModel(name="Bam4notB", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotB)), type="cov", numObs=524))
Bam4fitnotB <- mxRun(Bam4modelnotB)
Bam4asummnotB <- summary(Bam4fitnotB)
@ 

<<bamnotBsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notB <- mxCompare(Bam1fitnotB, c(Bam2fitnotB, Bam3fitnotB, Bam4fitnotB))
print(xtable(bamsemcompare.notB, label="tab:bamnotBsemcompare"))
@ 

It can be seen from Table \ref{tab:bamnotBsemcompare} that the two factor model provided the best fit to the out-of-sample data in  this case. 
\subsection{Split C CFA}
\label{sec:split-c-cfa}

Next, the fit of the models developed on Split C will be tested on Splits A, B and D. Firstly, the TCQ factor structures will be compared. 

<<tcq5notcSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
pillinj.cols <- c(pillitems.cols, Injitems.cols)
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills & Injections", "Creams", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
pillinj <- c(pills, inj)
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq5modelnotC <- mxModel(name="TCQ5notC", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills & Injections", to=pillinj), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notc)), type="cov", numObs=452))
tcq5fit.notC <- mxRun(Tcq5modelnotC)
tcq5summ.notC <- summary(tcq5fit.notC)
@ 


<<tcq6notcSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq6modelnotC <- mxModel(name="TCQ6notC", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notc)), type="cov", numObs=460))
tcq6fit.notC <- mxRun(Tcq6modelnotC)
tcq6summ.notC <- summary(tcq6fit.notC)
@ 

<<tcq7notCsem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Inj1", "Inj3")
Tcq7modelnotC <- mxModel(name="TCQ7notC", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notc)), type="cov", numObs=460))
tcq7fit.notC <- mxRun(Tcq7modelnotC)
tcq7summ.notC <- summary(tcq7fit.notC)
@ 

<<tcq2notCsemcompare, echo=FALSE, results=tex>>=
tcq2.notC.semcompare <- mxCompare(tcq5fit.notC,c(tcq6fit.notC, tcq7fit.notC))
print(xtable(tcq2.notC.semcompare, label="tab:tcq2notCsemcompare"))
@ 

It can be seen from Table \ref{tab:tcq2notCsemcompare} that the seven factor model from Split C provided a better fit to the out of sample data than did the 5 or 6 factor model. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split B will be tested on the out of sample data (that is, Splits A, C and D). 

<<bam1notCsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotC<- mxModel(name="Bam1notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=512))
Bam1fitnotC <- mxRun(Bam1modelnotC)
Bam1asumm.notC <- summary(Bam1fitnotC)
@ 

<<bam2notCsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Safe Use of Medicines")
medavoid <- paste(Bam, c(2,6,8,9,10,13,14,17,18), sep="")
safemed <- paste(Bam, c(2,3,7,10,11,16), sep="")
bamnoload <- paste(Bam, c(1,4,5,12,15), sep="")
Bam2modelnotC <- mxModel(name="Bam2notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Safe Use of Medicines", to=safemed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=512))
Bam2fitnotC <- mxRun(Bam2modelnotC)
Bam2asummnotC <- summary(Bam2fitnotC)
@ 


<<bam3notCsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Safer Medicines","Specific Use of Medicines")
docmed <- paste(Bam, c(13,14,17), sep="")
safemed <- paste(Bam, c(3,6,7,8,9,10,18), sep="")
specmed <- paste(Bam, c(2,3,11,16), sep="")
bamnoload <- paste(Bam, c(1,4,5,12,15), sep="")
Bam3modelnotC<- mxModel(name="Bam3notC", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=docmed),
                      mxPath(from="Safer Medicines", to=safemed),
                        mxPath(from="Specific Use of Medicines", to=specmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotC)), type="cov", numObs=524))
Bam3fitnotC <- mxRun(Bam3modelnotC)
Bam3asummnotC <- summary(Bam3fitnotC)
@ 


<<bamnotCsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notC <- mxCompare(Bam1fitnotC, c(Bam2fitnotC, Bam3fitnotC))
print(xtable(bamsemcompare.notC, label="tab:bamnotCsemcompare"))
@ 

It can be seen from Table \ref{tab:bamnotCsemcompare} that the one factor solution fits the out of sample data best in this case. 

\subsection{Split D CFA}
\label{sec:split-d-cfa}


Next, the fit of the models developed on Split C will be tested on Splits A, B and D. Firstly, the TCQ factor structures will be compared. 



<<tcq6notdSem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
Tcq6modelnotD <- mxModel(name="TCQ6notD", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notd)), type="cov", numObs=460))
tcq6fit.notD <- mxRun(Tcq6modelnotD)
tcq6summ.notD <- summary(tcq6fit.notD)
@ 

<<tcq7notDsem, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Cream3", "Inj3")
Tcq7modelnotD <- mxModel(name="TCQ7notD", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2notd)), type="cov", numObs=460))
tcq7fit.notD <- mxRun(Tcq7modelnotD)
tcq7summ.notD <- summary(tcq7fit.notD)
@ 

<<tcq2notDsemcompare, echo=FALSE, results=tex>>=
tcq2.notD.semcompare <- mxCompare(tcq6fit.notD, tcq7fit.notD)
print(xtable(tcq2.notD.semcompare, label="tab:tcq2notDsemcompare"))
@ 

It can be seen from Table \ref{tab:tcq2notDsemcompare} that the seven factor model from Split D provided a better fit to the out of sample data than did the 6 factor model. 

Next, the fits of the Beliefs about Medicine Questionnaire from Split D will be tested on the out of sample data (that is, Splits A, B and C). 

<<bam1notDsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(1,2,3,4,6,7,8,9,10,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(5,11,12,15,16), sep="")
Bam1modelnotD<- mxModel(name="Bam1notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=512))
Bam1fitnotD <- mxRun(Bam1modelnotD)
Bam1asumm.notD <- summary(Bam1fitnotD)
@ 

<<bam2notDsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Safe Use of Medicines")
safemed <- paste(Bam, c(3,4,6,8,9,10,11), sep="")
docmed <- paste(Bam, c(2,6,13,14,17), sep="")
bamnoload <- paste(Bam, c(1,5,7,12,15,16), sep="")
Bam2modelnotD <- mxModel(name="Bam2notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=medavoid),
                      mxPath(from="Safe Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=512))
Bam2fitnotD <- mxRun(Bam2modelnotD)
Bam2asummnotD <- summary(Bam2fitnotD)
@ 


<<bam3notDsem, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Doctors and Medicines", "NoLoad", "Dangers of Medicines","Avoidance of Medicines")
docmed <- paste(Bam, c(2,13,14,17), sep="")
dangermed <- paste(Bam, c(1,3,6,8,18), sep="")
medavoid <- paste(Bam, c(7,9,10,11), sep="")
bamnoload <- paste(Bam, c(4,5,7,12,15,16), sep="")
Bam3modelnotD<- mxModel(name="Bam3notD", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Doctors and Medicines", to=docmed),
                      mxPath(from="Dangers of Medicines", to=dangermed),
                        mxPath(from="Avoidance of Medicines", to=medavoid),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=524))
Bam3fitnotD <- mxRun(Bam3modelnotD)
Bam3asummnotD <- summary(Bam3fitnotD)
@ 


<<bamnotDsemcompare, echo=FALSE, results=tex>>=
bamsemcompare.notD <- mxCompare(Bam1fitnotD, c(Bam2fitnotD, Bam3fitnotD))
print(xtable(bamsemcompare.notD, label="tab:bamnotDsemcompare"))
@ 

It can be seen from Table \ref{tab:bamnotDsemcompare} that the one factor solution fits the out of sample data best in the case of the Split D models tested on the out of sample data. 

The next stage in  our analysis is to take the best of these models from each split and test them on the entire dataset. While this is, in a sense, analysing the data twice, it is the most practicable way in which to determine the best model for the entire sample. 

The best fitting models on the out of sample data were as follows:
\begin{itemize}
\item  Split A: Bam4, TCQ7

\item Split B: Bam2, TCQ7

\item Split C: Bam1, TCQ7

\item Split D: Bam1, TCQ7
\end{itemize}

Each of these models will be run on the full dataset, and the results assessed. The model which fits best on this sample will be used to predict factor scores for the experimental data. 

<<fullscales2, echo=FALSE, results=hide>>=
tcqall2 <- tcq2[,17:52]
bamall2 <- tcq2[,53:70]
@ 

<<tcq7notAsemAll, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Seven")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
seven <- c("Inj1", "Inj3")
Tcq7modelnotA.all <- mxModel(name="TCQ7notAAll", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Seven", to=seven),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2)), type="cov", numObs=594))
tcq7fit.notA.all <- mxRun(Tcq7modelnotA.all)
tcq7summ.notA.all <- summary(tcq7fit.notA.all)
@ 

<<bam4notAsemAll, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Medicine Effectiveness","Differences between Medicines", "Regular Taking of Medicines")
medavoid <- paste(Bam, c(6,7,8,9,12,13,14,17,18), sep="")
medeffect <- paste(Bam, c(1,3,4,10), sep="")
diffmed <- paste(Bam, c(1,2,7,10,11,16, 18), sep="")
regmed <- paste(Bam, 5, sep="")
bamnoload <- paste(Bam, 15, sep="")
Bam4modelnotA.all<- mxModel(name="Bam4notAAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Medicine Effectiveness", to=medeffect),
                        mxPath(from="Differences between Medicines", to=diffmed),
                        mxPath(from="Regular Taking of Medicines", to=regmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam4fitnotA.all <- mxRun(Bam4modelnotA.all)
Bam4asummnotA.all <- summary(Bam4fitnotA.all)
@ 


<<tcq7notBsemAll, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Cream3", "Inj1", "Inj3")
Tcq7modelnotB.all <- mxModel(name="TCQ7notBAll", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2)), type="cov", numObs=594))
tcq7fit.notB.all <- mxRun(Tcq7modelnotB.all)
tcq7summ.notB.all <- summary(tcq7fit.notB.all)
@ 

<<bam2notBsemAll, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- bamitems.cols
latents <- c("Medicine Avoidance", "NoLoad", "Responsible Use of Medicines")
medavoid <- paste(Bam, c(3,4,6,7,8,9,10,11,12,13,14,17,18), sep="")
respmed <- paste(Bam, c(1,2,11,16,18), sep="")
bamnoload <- paste(Bam, c(5,15), sep="")
Bam2modelnotB.all <- mxModel(name="Bam2notBAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Medicine Avoidance", to=medavoid),
                      mxPath(from="Responsible Use of Medicines", to=respmed),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam2fitnotB.all <- mxRun(Bam2modelnotB.all)
Bam2asummnotB.all <- summary(Bam2fitnotB.all)
@ 

<<tcq7notCsemAll, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Inj1", "Inj3")
Tcq7modelnotC.all <- mxModel(name="TCQ7notCAll", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2)), type="cov", numObs=594))
tcq7fit.notC.all <- mxRun(Tcq7modelnotC.all)
tcq7summ.notC.all <- summary(tcq7fit.notC.all)
@ 

<<bam1notCsemAll, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(3,4,6,7,8,9,10,12,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(1,2,5,11,15,16), sep="")
Bam1modelnotC.all<- mxModel(name="Bam1notCAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamall2)), type="cov", numObs=671))
Bam1fitnotC.all <- mxRun(Bam1modelnotC.all)
Bam1asumm.notC.all <- summary(Bam1fitnotC.all)
@ 

<<tcq7notDAllsemAll, echo=FALSE, results=hide>>=
Pill <- "Pill"
Cream <- "Cream"
Inj <- "Inj"
Acu <- "Acu"
Hom <- "Hom"
Rei <- "Rei"
creamitems.cols <- paste(Cream, 1:6, sep="")
pillitems.cols <- paste(Pill, 1:6, sep="")
Injitems.cols <- paste(Inj, 1:6, sep="")
Acuitems.cols <- paste(Acu, 1:6, sep="")
Homitems.cols <- paste(Hom, 1:6, sep="")
Reiitems.cols <- paste(Rei, 1:6, sep="")
manifests <- c(pillitems.cols, creamitems.cols, Injitems.cols, Acuitems.cols, Homitems.cols, Reiitems.cols)
latents <- c("Pills", "Creams", "Injections", "Acupuncture", "Homeopathy", "Reiki", "Confidence in Conventional Treatments")
pills <- paste(Pill, 1:6, sep="")
creams <- paste(Cream, 1:6, sep="")
inj <- paste(Inj, 1:6, sep="")
Acu <- paste(Acu, 1:6, sep="")
hom <- paste(Hom, 1:6, sep="")
rei <- paste(Rei, 1:6, sep="")
confconv <- c("Pill3", "Cream3", "Inj3")
Tcq7modelnotD.all <- mxModel(name="TCQ7notDAll", 
                         type="RAM",
                         manifestVars=manifests,
                         latentVars=latents,
                         mxPath(from="Pills", to=pills), 
                         mxPath(from="Creams", to=creams),
                         mxPath(from="Injections", to=inj),
                         mxPath(from="Acupuncture", to=Acu),
                         mxPath(from="Homeopathy", to=hom),
                         mxPath(from="Reiki", to=rei),
                         mxPath(from="Confidence in Conventional Treatments", to=confconv),
                         mxPath(from=manifests, arrows=2),
                         mxPath(from=latents, arrows=2, free=FALSE, values=0.5),
                         mxData(observed=cov(na.omit(tcqall2)), type="cov", numObs=594))
tcq7fit.notD.all <- mxRun(Tcq7modelnotD.all)
tcq7summ.notD.all <- summary(tcq7fit.notD.all)
@ 

<<bam1notDsemAll, echo=FALSE, results=hide>>=
Bam <- "BAM"
bamitems.cols <- paste(Bam, 1:18, sep="")
manifests <- c(bamitems.cols)
latents <- c("Beliefs About Medicine", "NoLoad")
Bamq <- paste(Bam, c(1,2,3,4,6,7,8,9,10,13,14,17, 18), sep="")
bamnoload <- paste(Bam, c(5,11,12,15,16), sep="")
Bam1modelnotD.all<- mxModel(name="Bam1notDAll", 
                      type="RAM",
                      manifestVars=manifests,
                      latentVars=latents,
                      mxPath(from="Beliefs About Medicine", to=Bamq),
                      mxPath(from="NoLoad", to=bamnoload, free=FALSE, values=0.0),
                      mxPath(from=manifests, arrows=2),
                      mxPath(from=latents, arrows=2, free=FALSE, values=0.4),
mxData(observed=cov(na.omit(bamnotD)), type="cov", numObs=671))
Bam1fitnotD.all <- mxRun(Bam1modelnotD.all)
Bam1asumm.notD.all <- summary(Bam1fitnotD.all)
@

<<bamallsemcompare, echo=FALSE, results=tex>>=
bamall.semcompare <- mxCompare(Bam4fitnotA.all, c(Bam2fitnotB.all, Bam1fitnotC.all, Bam1fitnotD.all))
print(xtable(bamall.semcompare, label="tab:bamallsemcompare"))
@ 

As can be seen from Table \ref{tab:bamallsemcompare}, the two factor model from Split B provided the best fit to all of the data, striking a balance between the complexity of the four factor model and the over simplicity of the one factor model. 

<<tcqall2semcompare, echo=FALSE, results=tex>>=
tcqall2.semcompare <- mxCompare(tcq7fit.notA.all, c(tcq7fit.notB.all, tcq7fit.notC.all, tcq7fit.notD.all))
print(xtable(tcqall2.semcompare, label="tab:tcqall2semcompare"))
@ 

As can be seen from Table \ref{tab:tcqall2semcompare}, models B, C and D were identical and they appear to provide the best fit on all of the data. 

\subsection{IRT Analyses}
\label{sec:irt-analyses}

\subsubsection{Treatment Credibility Questionnaire}
\label{sec:treatm-cred-quest}

The next step in the analysis procedure was to examine the treatment credibility questionnaire in terms of item response theory. The same approach as taken for the factor analytic procedures was taken, such that seperate models were fitted on subsets of the data, and then tested against the out-of-sample data, before being finalised on the entire set of data. First, non-parametric IRT (or Mokken analysis) was applied to test the assumptions required for the parametric models. The analysis proper then began with the simplest of IRT models, the Rasch model, followed by a one parameter model with an estimated discrimination, followed by a two parameter model. 

<<tcq2aitemselection, echo=FALSE, results=tex>>=
tcq.aisp <- aisp(na.omit(tcqall2a))
print(xtable(tcq.aisp, label="tab:tcq2aitemselection"))
@ 

As can be seen from Table \ref{tab:tcq2aitemselection}, the TCQ divides neatly into two scales, one for the conventional items and another for the alternative items. 

The next assumption to check was that of invariant item ordering, and the results are shown below.

<<tcq2asplitscales, echo=FALSE, results=hide>>=
tcq2a.conv <- tcqall2a[,1:18]
tcq2a.alt <- tcqall2a[,19:36]
@ 

<<tcq2aconvcheckiio, echo=FALSE, results=tex>>=
tcq2aconv.iio <- check.iio(na.omit(tcq2a.conv))
print(xtable(tcq2aconv.iio$violations, label="tab:tcq2aconvcheckiio"))
@ 

It can be seen from Table \ref{tab:tcq2aconvcheckiio} that Pill4 and Pill6 violated the assumption of invariant item ordering. However, invariant item ordering is only necessary for restricted versions of the rating scale model and the graded response model, so this assumption is not as important in our case. That being said, the assumption was also investigated for the alternative items to allow for a minimal subset of items to be retained if restrictive models are to be fit later in the process. 

<<tcq2aaltitemord, echo=FALSE, results=tex>>=
tcq2aalt.iio <- check.iio(na.omit(tcq2a.alt))
print(xtable(tcq2aalt.iio$violations, label="tab:tcq2aaltcheckiio"))
@ 
Table \ref{tab:tcq2aaltcheckiio} shows that in contrast to the conventional items, there were no violations of the IIO assumption for the alternative items. 

Next, the assumption of monotonicity was assesed for both scales. 

<<tcq2aconvmonotonicity, echo=FALSE, results=tex>>=
tcq2aconv.mono <- check.monotonicity(na.omit(tcq2a.conv))
print(xtable(summary(tcq2aconv.mono), label="tab:tcq2aconvmonotonicity"))
@ 
As can be seen from Table \ref{tab:tcq2aconvmonotonicity}, there were no violations of monotonicity for the conventional items in this split (the vi column is the most important here). 

<<tcq2aaltmonotonicity, echo=FALSE, results=tex>>=
tcq2aalt.mono <- check.monotonicity(na.omit(tcq2a.alt))
print(xtable(summary(tcq2aalt.mono), label="tab:tcq2aaltmonotonicity"))
@ 

As shown in Table \ref{tab:tcq2aaltmonotonicity}, there were no violations of the monotonicity assumption for the alternative items in this split either. 

<<tcq2aguttmanerrors, echo=FALSE, results=hide>>=
tcq2a.conv.errors <- check.errors(na.omit(tcq2a.conv))
tcq2a.alt.errors <- check.errors(na.omit(tcq2a.alt))
@ 

Guttman errors are interesting, provide a quick measure of person fit. They have mostly been applied to dichotomous outcomes, but are examined in this work in order to check their adequacy as a measure of person fit. 


\begin{figure}
  <<tcqconvguttmanplot, echo=FALSE, fig=TRUE>>=
conv.guttman <- ggplot(as.data.frame(tcq2a.conv.errors), aes(x=tcq2a.conv.errors))+layer(geom="bar")
print(conv.guttman)
@   
  \caption{Guttman Errors Histogram for TCQ 2A conventional items}
  \label{fig:convguttman}
\end{figure}
\begin{figure}
<<tcqaltguttmanplot, echo=FALSE, fig=TRUE>>=
alt.guttman <- ggplot(as.data.frame(tcq2a.alt.errors), aes(x=tcq2a.alt.errors))+layer(geom="bar")
print(alt.guttman)
@ 
  \caption{Guttman errors histogram for TCQ2A alternative items}
  \label{fig:altguttman}
\end{figure}

As can be seen from Figures \ref{fig:convguttman} and \ref{fig:altguttman}, the majority of participants had 0 guttman errors, which indicates that they were responding to the scale in a coherent manner. 

The major assumptions of parametric IRT are satisfied for this split, and so the next step is the estimation of rasch, one and two parameter models. 

<<tcq2aconvgpcm, echo=FALSE, results=hide>>=
tcq2a.conv.gpcm.rasch <- gpcm(na.omit(tcq2a.conv), constraint="rasch")
tcq2a.conv.gpcm.1pl <- gpcm(na.omit(tcq2a.conv), constraint="1PL")
tcq2a.conv.gpcm.gpcm <- gpcm(na.omit(tcq2a.conv), constraint="gpcm")
@ 
<<tcq2aconvsum, echo=FALSE, results=hide>>=
tcq2a.conv.rasch.sum <- summary(tcq2a.conv.gpcm.rasch)
tcq2a.conv.1pl.sum <- summary(tcq2a.conv.gpcm.1pl)
tcq2a.conv.2pl.sum <- summary(tcq2a.conv.gpcm.gpcm)
@ 

<<tcq2acoefrasch, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2a.conv.gpcm.rasch), label="tab:tcq2acoefrasch"))
@ 

Table \ref{tab:tcq2acoefrasch} shows the estimated thresholds for these items under the Rasch model, which has all discrimination parameters fixed to one. Even a cursory inspection of this table shows that the model does not fit well. The Category 3 estimates are almost all below the catgory 1 and 2 estimates, suggesting that those who responded using this category (the middle one) had the lowest estimated abilities, which is a clear violation of the model's assumptions. Next, a one parameter IRT model is examined. 

<<tcq2acoefrasch, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2a.conv.gpcm.1pl), label="tab:tcq2aconvcoef1pl"))
@ 

Table ~\ref{tab:tcq2aconvcoef1pl} shows that a similiar problem arises using the one parameter model, with an estimated discrimination parameter of 1.531. This suggests that the model will need to be further expanded to allow for an acceptable fit. 

<<tcq2acoefrasch, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2a.conv.gpcm.gpcm), label="tab:tcq2aconvcoef1pl"))
@ 

Table ~\ref{tab:tcq2aconvcoef1pl} shows that even with a discrimination parameter estimated individually for each item, the generalised partial credit models do not provide an acceptable fit to the data. Next, the one and two parameter graded response models were fit to the same items.

<<tcq2convgrm, echo=FALSE, results=hide>>=
tcq2a.conv.grm.1pl <- grm(na.omit(tcq2a.conv), constrained=TRUE)
tcq2a.conv.grm.2pl <- grm(na.omit(tcq2a.conv), constrained=FALSE)
@ 

<<tcq2aconvgrm1plsumm, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2a.conv.grm.1pl), label="tab:tcq2aconvgrm1plsumm"))
@ 

As can be seen from Table ~\ref{tab:tcq2aconvgrm1plsumm}, the graded response model provides a much better fit to the data.  There are no obvious violations of the model assumptions, with an estimated discrimination parameter of 2.197. Note that the cream items are considered the most difficult, suggesting that this was the least credible form of conventional treatment.  The next model fit was a two parameter graded response model.  

<<tcq2aconvgrm1plsumm, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2a.conv.grm.2pl), label="tab:tcq2aconvgrm1plsumm"))
@ 

Again, it can be seen from Table \ref{tab:tcq2aconvgrm1plsumm} that the Cream items appear to be the most discriminating, and possess the highest difficulty levels (on average).  
Both the pill and injection items seem to be endorsed by a much large proportion of the sample. This suggests that Creams are the least credible treatment for pain. 

\begin{figure}
<<tcq2aconvgrm1plPlot, echo=FALSE, fig=TRUE>>=
print(ggplotGRM(tcq2a.conv.grm.1pl))
@   
  \caption{Item Parameter Plot for TCQ2 (Split A). The Threshold parameter indicates the ability point where the next response becomes most likely. If the thresholds are not in order, this indicates a failure of montonicity}
  \label{fig:tcqcov2agrm1pl}
\end{figure}

A plot showing the threshold parameters for each of the items in the conventional model can be seen in Figure \ref{fig:tcqcov2agrm1pl}.

The same plot for the two parameter model can be seen in Figure \ref{}
\begin{figure}
<<tcq2aconvgrm2plPlot, echo=FALSE, fig=TRUE>>=
print(ggplotGRM(tcq2a.conv.grm.2pl))
@   
  \caption{Item Parameter Plot for TCQ2 (Split A). The Threshold parameter indicates the ability point where the next response becomes most likely. If the thresholds are not in order, this indicates a failure of montonicity}
  \label{fig:tcq2aconvgrm2pl}
\end{figure}

Another item parameter plot for the two parameter model is shown in Figure ~\ref{fig:tcq2aconvgrm2pl}, which again shows no obvious problems with the model. 


A likelihood ratio test was carried out for the two models, and the two parameter model appeared a better fit in terms of likelihood($p<0.001$), AIC and BIC. That being said, given the tradeoff in degrees of freedom (17), a better test will be the models accuracy on unseen data, a process which will be carried out after all the splits are analysed. 
Next, the beliefs about medicine questionnaire was examined in terms of item response theory.

<<bam2ascales, echo=FALSE, results=tex>>=
bam2a.scales <- aisp(na.omit(bamall2a))
print(xtable(bam2a.scales), label="tab:bam2ascales")
@ 

It can be seen from Table ~\ref{tab:bam2ascales} that many items on the beliefs about medicine questionnaire do not appear to be part of any scale (indicated by the zeros next to the item number). The algorithm suggests that there are two scales.

The first is made up of BAM6, BAM7, BAM9, BAM13, BAM14 and BAM17.
The second is made up of BAM4 and BAM10. This second scale appears to be less than useful, as some of the other tests of assumptions require at least three items per scale. The approach taken here will be to eliminate all but the first scale and conduct our analyses on that set of six items.

<<bam2areduce, echo=FALSE, results=hide>>=
bam2ascale <- bamall2a[,c("BAM6","BAM7","BAM9","BAM13","BAM14","BAM17")]
## bam2ascale.other <- bamall2a[,!c("BAM6","BAM7","BAM9","BAM13","BAM14","BAM17")]
@ 

The next step is to check the assumption of invariant item ordering. This is less important here, but is checked for the sake of completeness. 

<<bam2aiio, echo=FALSE, results=tex>>=
bam2a.iio <- check.iio(na.omit(bam2ascale))
print(xtable(bam2a.iio$violations, label="tab:bam2aiio"))
@ 

As can be seen from Table ~\ref{tab:bam2aiio}, no items violated the invariant item ordering assumption, and so are are retained until the next stage. The next step is to check the assumption of monotonicity.

<<bam2acheckmono, echo=FALSE, results=tex>>=
bam2a.mono <- check.monotonicity(na.omit(bam2ascale))
print(xtable(summary(bam2a.mono), label="tab:bam2amono"))
@ 

Table \ref{tab:bam2amono} shows that there were no violations of monotonicity in this split for the reduced set of items. 

The next step in our analysis plan is to fit a rasch model to the beliefs about medicine scale. 

<<bam2arasch, echo=FALSE, results=tex>>=
bam2a.gpcm.rasch <- gpcm(bam2ascale, constraint="rasch")
print(xtable(coef2mat(coef(bam2a.gpcm.rasch)), label="tab:bam2arasch"))
@ 

As can be seen from Table ~\ref{tab:bam2arasch}, this model shows serious violations of the monotonicity assumption and as such, does not need to be investigated further.

We next examine the fit of a one paramater generalised partial credit model with a discrimination parameter estimated from the data. 

<<bam2a1PL, echo=FALSE, results=tex>>=
bam2a.gpcm.1PL <- gpcm(bam2ascale, constraint="1PL")
print(xtable(coef2mat(coef(bam2a.gpcm.1PL)), label="tab:bam2a1PL"))
@ 

Again, Table \ref{tab:bam2a1PL} makes it very clear that the one parameter GPCM provides an extremely poor fit to the data. 

Next, the fit of a two parameter GPCM to this scale was examined. 

<<bam2agpcm, echo=FALSE, results=tex>>=
bam2a.gpcm.gpcm <- gpcm(bam2ascale, constraint="gpcm")
print(xtable(coef2mat(coef(bam2a.gpcm.gpcm)), label="tab:bam2agpcm"))
@ 
It can be clearly seen from Table ~\ref{tab:bam2agpcm} that even the two parameter GPCM provides a very poor fit to the data, with the monotonicity assumption violated for almost all the items in Category 3. In line with previous practice, the next models fit were the one and two parameter graded response models. 

<<bam2agrm1pl, echo=FALSE, results=tex>>=
bam2a.grm.1pl <- grm(na.omit(bam2ascale), constrained=TRUE)
bam2acoef.mat <- coef2mat(coef(bam2a.grm.1pl))
print(xtable(bam2acoef.mat, label="tab:bam2agrm1pl"))
@ 

It can be seen from Table \ref{tab:bam2agrm1pl} that the fit of this model is much better that the fit of any of the partial credit models. 

The next step is to fit a two parameter GRM, and examine the differences in fit between the two models. 

<<bam2agrm2pl, echo=FALSE, results=tex>>=
bam2a.grm.2pl <- grm(na.omit(bam2ascale), constrained=FALSE, Hessian=TRUE)
bam2acoef.mat <- coef2mat(coef(bam2a.grm.2pl))
print(xtable(bam2acoef.mat, label="tab:bam2agrm2pl"))
@ 

It can be seen from Table \ref{tab:bam2agrm2pl} that this model reveals some interesting features of the items. BAM13 and BAM17 have the highest discrimination parameters, but the ability estimates of their extremities have moved down to compensate. 

A likelihood ratio test carried out between the two models suggested that the two parameter model was significantly better than the one parameter model, ($p\le 0.001$). Again, this is a tentative result until the performance of the model on new data is examined. In any case, while both the AIC and the LR test favoured the two parameter model, the BIC was lower for the one parameter model indicating that according to this criterion, the one parameter model was superior. 

\subsubsection{Split B}
\label{sec:split-b}

The next task was to repeat the analyses on Split B. The TCQ was the instrument first examined in this split, in line with previous work.

Again, the first step is to examine whether or not the TCQ should be split into seperate scales, examine the monotonicity, the invariant item ordering assumption and examine a plot of Guttman errors. 

<<tcq2baisp, echo=FALSE, results=tex>>=
tcq2b.aisp <- aisp(na.omit(tcqall2b))
print(xtable(tcq2b.aisp), label="tab:tcq2baisp")
@ 

As can be seen from Table ~\ref{tab:tcq2baisp}, the scales split along alternative and conventional lines, as in Split A. All further analyses will be carried out on the seperate scales. 

<<tcq2bsplitscales, echo=FALSE, results=hide>>=
tcq2b.conv <- tcqall2b[,1:18]
tcq2b.alt <- tcqall2b[,19:36]
@ 

The first step in the examination of the tcq conventional in split B is to check the IIO assumption. 

<<tcq2bcheckiio, echo=FALSE, results=tex>>=
tcq2b.conv.iio <- check.iio(na.omit(tcq2b.conv))
print(xtable(tcq2b.conv.iio$violations, label="tab:tcq2bcheckiio"))
@ 

As can be seen from Table \ref{tab:tcq2bcheckiio}, there were no violations of this assumption. 

Next the assumption of montonicity was checked. 

<<tcq2bconvcheckmono, echo=FALSE, results=tex>>=
tcq2b.conv.mono <- check.monotonicity(na.omit(tcq2b.conv))
print(xtable(summary(tcq2b.conv.mono), label="tab:tcq2bconvcheckmono"))
@ 

As shown in Table \ref{tab:tcq2bconvcheckmono}, there were no violations of the monotonicity assumption in this split.

This process of repeating assumptions is then repeated for the alternative question TCQ for Split B.

<<tcq2baltcheckiio, echo=FALSE, results=tex>>=
tcq2b.alt.iio <- check.iio(na.omit(tcq2b.alt))
print(xtable(tcq2b.alt.iio$violations, label="tab:tcq2baltcheckiio"))
@ 

As can be seen from Table \ref{tab:tcq2baltcheckiio}, there were no violations of the invariant item ordering assumption in this split. Next, the monotonicity assumption was assessed. 

<<tcq2baltcheckmono, echo=FALSE, results=tex>>=
tcq2b.alt.mono <- check.monotonicity(na.omit(tcq2b.alt))
print(xtable(summary(tcq2b.alt.mono), label="tab:tcq2baltcheckmono"))
@ 

As shown from Table \ref{tab:tcq2baltcheckmono}, there were no violations of the montonicity assumption in this sample. 

Next, a series of partial credit models were fit and checked for violations of the assumptions. 

<<tcq2bconvgpcm, echo=FALSE, results=hide>>=
tcq2b.conv.gpcm.rasch <- gpcm(tcq2b.conv, constraint="rasch")
tcq2b.conv.gpcm.1PL <- gpcm(tcq2b.conv, constraint="1PL")
tcq2b.conv.gpcm.gpcm <- gpcm(tcq2b.conv, constraint="gpcm")
@ 

\begin{figure}
<<tcq2bconvgpcmraschplot, echo=FALSE, fig=TRUE>>=
gpcm.rasch.plot <- ggplotGRM(tcq2b.conv.gpcm.rasch)
print(gpcm.rasch.plot)
@   
  \caption{Item Parameter Plot for TCQ2B Conventional GPCM Rasch}
  \label{fig:tcq2bconvgpcmrasch}
\end{figure}

It can easily be seen from Figure \ref{fig:tcq2bconvgpcmrasch} that the Rasch generalised partial credit model does not provide a good fit for these items. Note the fact that thresholds 2 and 3 are almost identical for Inj6, Inj3, Inj2, and there are obvious violations of monotonicity for Inj2, Pill1 and Pill2. This indicates that this model is not suitable for this data. 


\begin{figure}
<<tcq2bconvgpcm1PLplot, echo=FALSE, fig=TRUE>>=
gpcm.1PL.plot <- ggplotGRM(tcq2b.conv.gpcm.1PL)
print(gpcm.1PL.plot)
@   
  \caption{Item Parameter Plot for TCQ2B Conventional GPCM}
  \label{fig:tcq2bconvgpcm1PLplot}
\end{figure}

Next, the fit of the one parameter GPCM was examined using an Item Parameter Plot (Figure \ref{fig:tcq2bconvgpcm1PLplot}). 
It can be seen that there are failures of the monotonicity assumption for Inj6, Inj2, Inj5, Inj1, Cream6, Cream5, Cream4, Cream2, Cream1, Pill6, Pill5, Pill4, Pill3, Pill2 and Pill1. In fact, most of the 2 and 3 thresholds are reversed, demonstrating that this model is not a good fit for the data. 


\begin{figure}
<<tcq2bconvgpcmgpcmplot, echo=FALSE, fig=TRUE>>=
gpcm.gpcm.plot <- ggplotGRM(tcq2b.conv.gpcm.gpcm)
print(gpcm.gpcm.plot)
@   
  \caption{Item Position Plot for Two Parameter GPCM (Split B)}
  \label{fig:tcq2bconvgpcm2plplot}
\end{figure}

As shown in Figure \ref{fig:tcq2bconvgpcm2plplot}, there are some failures of monotonicity here. Inj6, In5, Inj4, Inj3, Inj2, Inj1, Cream2, Cream1, Pill6, Pill5, Pill4, Pill3, Pill2 and Pill1. This demonstrates the extremely poor fit of this model. 

As none of the partial credit model fitted the items, the next step was to examine the fit of the one and two parameter graded response models. 

<<tcq2bconvgrm, echo=FALSE, results=hide>>=
tcq2b.conv.grm.1pl <- grm(tcq2b.conv, constrained=TRUE)
tcq2b.conv.grm.2pl <- grm(tcq2b.conv, constrained=FALSE)
@ 


\begin{figure}
<<tcq2bconvgrm1plot, echo=FALSE, fig=TRUE>>=
tcq2convgrm1plot <- ggplotGRM(tcq2b.conv.grm.1pl)
print(tcq2convgrm1plot)
@   
  \caption{Item Parameter Plot for TCQ Conventional 1 parameter Graded Response Model (Split B)}
  \label{fig:tcq2bconvgrm1plot}
\end{figure}

As shown in Figure \ref{fig:tcq2bconvgrm1plot}, there were no violations of monotonicity for the one parameter GRM. 

<<tcq2bconvgrm1plsumm, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2b.conv.grm.1pl), label="tab:tcq2bconvgrm1plsumm"))
@ 

Table \ref{tcq2bconvgrm1plsumm} shows that the cream items were the least endorsed, especially the highest response category. The estimated discrimination parameter is also quite high, at 2.08. This is probably due to a number of difficult items (the cream ones probably) dragging up the estimated discrimination parameter. 

\begin{figure}
<<tcq2bconvgrm2plot, echo=FALSE, fig=TRUE>>=
tcq2convgrm2plot <- ggplotGRM(tcq2b.conv.grm.2pl)
print(tcq2convgrm2plot)
@   
  \caption{Item Parameter Plot for TCQ Conventional 2 parameter Graded Response Model (Split B)}
  \label{fig:tcq2bconvgrm2plot}
\end{figure}
@ 

As can be seen from Figure \ref{fig:tcq2bconvgrm2plot}, there were no violations of monotonicity for the two parameter GRM. 

<<tcq2bconv2plgrmsum, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2b.conv.grm.2pl), label="tab:tcq2bconv2plgrmsum"))
@ 

As can be seen from Table \ref{tab:tcq2bconv2plgrmsum}, the discrimination parameters have lowered for most of the items, with the exception of Pill4, Pill5 and Pill6, where they have significantly increased. This is surprising, as the Cream items have much higher difficulty, but lower discrimination between different ability levels. 

The same model fitting procedure will now be repeated for the Beliefs About Medicine Questionnaire in this split. 

<<bam2baisp, echo=FALSE, results=tex>>=
bam2b.aisp <- aisp(na.omit(bamall2b))
print(xtable(bam2b.aisp, label="tab:bam2baisp"))
@ 

As shown in Table \ref{tab:bam2baisp}, some items do not load on any scales, and there is one two item scale (BAM1 and BAM2), along with one larger scale. As two items are not enough to form a useful scale, the larger scale will be the only one which is analysed. 

The scale that will be analysed consists of BAM3, BAM4, BAM6, BAM9, BAM10, BAM11, BAM13, BAM14 and BAM17. This is a larger scale than was observed with Split A. 

<<bamscale2b,echo=FALSE, results=hide>>=
bamscale2b <- bamall2b[,c("BAM3","BAM4","BAM6","BAM9","BAM10","BAM11","BAM13","BAM14", "BAM17")]
@ 

The first step is to examine the invariant item ordering assumption.

<<bam2checkiio, echo=FALSE, results=tex>>=
bam2b.iio <- check.iio(na.omit(bamscale2b))
print(xtable(bam2b.iio$violations, label="tab:bam2checkiio"))
@ 

In line with the results of Split A, no items were in violation of this assumption. 

The next assumption which needs to be checked is the monotonicity assumption. 

<<bam2bcheckmono, echo=FALSE, results=tex>>=
bam2b.mono <- check.monotonicity(na.omit(bamscale2b))
print(xtable(summary(bam2b.mono), label="tab:bam2bcheckmono"))
@ 

Table \ref{tab:bam2bcheckmono} shows clearly that there were no violations of the monotonicity assumption in this sample. 

The final preliminary model check consists of a plot displaying the number of Guttman errors for each participant.
\begin{figure}
<<bam2bguttman, echo=FALSE, fig=TRUE>>=
bam2b.guttman <- check.errors(na.omit(bamscale2b))
bam2b.guttplot <- ggplot(as.data.frame(bam2b.guttman), aes(x=bam2b.guttman))+layer(geom="bar", binwidth=2)
print(bam2b.guttplot)
@   
  \caption{Plot of Guttman errors for Beliefs about Medicine Scale, Split B}
  \label{fig:bam2bguttmanplot}
\end{figure}

As can be seen from Figure \ref{fig:bam2bguttmanplot}, the number of guttman errors was much higher for this scale than was observed in the previous split. This suggests that some of the respondents were not answering the questions in a consistent fashion, and will be investigated further when the person fit statistics are examined on a per model basis. 

The first step in modelling the Beliefs about Medicines questionnaire is to attempt to fit a Rasch partial credit model.

<<bam2bgpcm, echo=FALSE, results=hide>>=
bam2b.gpcm.rasch <- gpcm(bamscale2b, constraint="rasch")
bam2b.gpcm.1PL <- gpcm(bamscale2b, constraint="1PL")
bam2b.gpcm.gpcm <- gpcm(bamscale2b, constraint="gpcm")
@ 



## <<bam2bgpcmraschplot, echo=FALSE, fig=TRUE>>=
## bam2bgpcm.raschplot <- ggplotGRM(coef(coef2mat(bam2b.gpcm.rasch)))
% @                               %

The estimated parameters for the Rasch model are shown below, in Table \ref{tab:bam2bgpcmrasch}. It can be seen that there are a number of violations of monotonicity in this sample. 

<<bam2bgpcmrasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2b.gpcm.rasch)), label="tab:bam2bgpcmrasch"))
@ 
One and two parameter versions of the GPCM were also fit to this scale, but the models contained serious violations of monotonicity and are not further described here. 

The next step in the process of modelling was to fit one and two parameter Graded Response Models. 

<<bam2bgrm, echo=FALSE, results=hide>>=
bam2b.grm.1pl <- grm(bamscale2b, constrained=TRUE)
bam2b.grm.2pl <- grm(bamscale2b, constrained=FALSE)
@ 

<<bam2bgrm1sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(bam2b.grm.1pl), label="tab:bam2bgrm1sum"))
@ 

Table \ref{tab:bam2bgrm1sum} shows no signs of problems with monotonicity, and the fit appears acceptable. Next, the two parameter GRM was examined.

<<bam2bgrm2sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(bam2b.grm.2pl), label="tab:bam2bgrm2sum"))
@ 

Table \ref{tab:bam2bgrm2sum} shows that the fit of the two parameter model is equally unproblematic. An

<<bam2banovagrm, echo=FALSE, results=hide>>=
bam2bgrm.anova <- anova(bam2b.grm.1pl, bam2b.grm.2pl)
@ 

A likelihood ratio test suggests that the two parameter model provides a significantly better fit ($p \le 0.001$) than does the one parameter model. 


\subsubsection{Split C}
\label{sec:split-c}



<<tcq2caisp, echo=FALSE, results=tex>>=
tcq2c.aisp <- aisp(na.omit(tcqall2b))
print(xtable(tcq2c.aisp), label="tab:tcq2caisp")
@ 

<<tcq2csplitscales, echo=FALSE, results=hide>>=
tcq2c.conv <- tcqall2b[,1:18]
tcq2c.alt <- tcqall2b[,19:36]
@ 



<<tcq2ccheckiio, echo=FALSE, results=tex>>=
tcq2c.conv.iio <- check.iio(na.omit(tcq2c.conv))
print(xtable(tcq2c.conv.iio$violations, label="tab:tcq2ccheckiio"))
@ 


<<tcq2cconvcheckmono, echo=FALSE, results=tex>>=
tcq2c.conv.mono <- check.monotonicity(na.omit(tcq2c.conv))
print(xtable(summary(tcq2c.conv.mono), label="tab:tcq2cconvcheckmono"))
@ 



<<tcq2caltcheckiio, echo=FALSE, results=tex>>=
tcq2c.alt.iio <- check.iio(na.omit(tcq2c.alt))
print(xtable(tcq2c.alt.iio$violations, label="tab:tcq2caltcheckiio"))
@ 


<<tcq2caltcheckmono, echo=FALSE, results=tex>>=
tcq2c.alt.mono <- check.monotonicity(na.omit(tcq2c.alt))
print(xtable(summary(tcq2c.alt.mono), label="tab:tcq2caltcheckmono"))
@ 



<<tcq2cconvgpcm, echo=FALSE, results=hide>>=
tcq2c.conv.gpcm.rasch <- gpcm(tcq2c.conv, constraint="rasch")
tcq2c.conv.gpcm.1PL <- gpcm(tcq2c.conv, constraint="1PL")
tcq2c.conv.gpcm.gpcm <- gpcm(tcq2c.conv, constraint="gpcm")
@ 

\begin{figure}
<<tcq2cconvgpcmraschplot, echo=FALSE, fig=TRUE>>=
gpcm.rasch.plot <- ggplotGRM(tcq2c.conv.gpcm.rasch)
print(gpcm.rasch.plot)
@   
  \caption{Item Parameter Plot for TCQ2C Conventional GPCM Rasch}
  \label{fig:tcq2cconvgpcmrasch}
\end{figure}

\begin{figure}
<<tcq2cconvgpcm1PLplot, echo=FALSE, fig=TRUE>>=
gpcm.1PL.plot <- ggplotGRM(tcq2c.conv.gpcm.1PL)
print(gpcm.1PL.plot)
@   
  \caption{Item Parameter Plot for TCQ2C Conventional GPCM}
  \label{fig:tcq2cconvgpcm1PLplot}
\end{figure}


\begin{figure}
<<tcq2cconvgpcmgpcmplot, echo=FALSE, fig=TRUE>>=
gpcm.gpcm.plot <- ggplotGRM(tcq2c.conv.gpcm.gpcm)
print(gpcm.gpcm.plot)
@   
  \caption{Item Position Plot for Two Parameter GPCM (Split B)}
  \label{fig:tcq2cconvgpcm2plplot}
\end{figure}




<<tcq2cconvgrm, echo=FALSE, results=hide>>=
tcq2c.conv.grm.1pl <- grm(tcq2c.conv, constrained=TRUE)
tcq2c.conv.grm.2pl <- grm(tcq2c.conv, constrained=FALSE)
@ 


\begin{figure}
<<tcq2cconvgrm1plot, echo=FALSE, fig=TRUE>>=
tcq2convgrm1plot <- ggplotGRM(tcq2c.conv.grm.1pl)
print(tcq2convgrm1plot)
@   
  \caption{Item Parameter Plot for TCQ Conventional 1 parameter Graded Response Model (Split B)}
  \label{fig:tcq2cconvgrm1plot}
\end{figure}



<<tcq2cconvgrm1plsumm, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2c.conv.grm.1pl), label="tab:tcq2cconvgrm1plsumm"))
@ 



\begin{figure}
<<tcq2cconvgrm2plot, echo=FALSE, fig=TRUE>>=
tcq2convgrm2plot <- ggplotGRM(tcq2c.conv.grm.2pl)
print(tcq2convgrm2plot)
@   
  \caption{Item Parameter Plot for TCQ Conventional 2 parameter Graded Response Model (Split B)}
  \label{fig:tcq2cconvgrm2plot}
\end{figure}
@ 



<<tcq2cconv2plgrmsum, echo=FALSE, results=tex>>=
print(xtable(coef(tcq2c.conv.grm.2pl), label="tab:tcq2cconv2plgrmsum"))
@ 


<<bam2caisp, echo=FALSE, results=tex>>=
bam2c.aisp <- aisp(na.omit(bamall2b))
print(xtable(bam2c.aisp, label="tab:bam2caisp"))
@ 


<<bamscale2c,echo=FALSE, results=hide>>=
bamscale2c <- bamall2b[,c("BAM3","BAM4","BAM6","BAM9","BAM10","BAM11","BAM13","BAM14", "BAM17")]
@ 



<<bam2ccheckiio, echo=FALSE, results=tex>>=
bam2c.iio <- check.iio(na.omit(bamscale2b))
print(xtable(bam2c.iio$violations, label="tab:bam2checkiio"))
@ 



<<bam2ccheckmono, echo=FALSE, results=tex>>=
bam2c.mono <- check.monotonicity(na.omit(bamscale2b))
print(xtable(summary(bam2c.mono), label="tab:bam2ccheckmono"))
@ 


\begin{figure}
<<bam2cguttman, echo=FALSE, fig=TRUE>>=
bam2c.guttman <- check.errors(na.omit(bamscale2b))
bam2c.guttplot <- ggplot(as.data.frame(bam2c.guttman), aes(x=bam2c.guttman))+layer(geom="bar", binwidth=2)
print(bam2c.guttplot)
@   
  \caption{Plot of Guttman errors for Beliefs about Medicine Scale, Split B}
  \label{fig:bam2cguttmanplot}
\end{figure}




<<bam2cgpcm, echo=FALSE, results=hide>>=
bam2c.gpcm.rasch <- gpcm(bamscale2b, constraint="rasch")
bam2c.gpcm.1PL <- gpcm(bamscale2b, constraint="1PL")
bam2c.gpcm.gpcm <- gpcm(bamscale2b, constraint="gpcm")
@ 



## <<bam2cgpcmraschplot, echo=FALSE, fig=TRUE>>=
## bam2cgpcm.raschplot <- ggplotGRM(coef(coef2mat(bam2c.gpcm.rasch)))
% @                               %



<<bam2cgpcmrasch, echo=FALSE, results=tex>>=
print(xtable(coef2mat(coef(bam2c.gpcm.rasch)), label="tab:bam2cgpcmrasch"))
@ 


<<bam2cgrm, echo=FALSE, results=hide>>=
bam2c.grm.1pl <- grm(bamscale2b, constrained=TRUE)
bam2c.grm.2pl <- grm(bamscale2b, constrained=FALSE)
@ 

<<bam2cgrm1sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(bam2c.grm.1pl), label="tab:bam2cgrm1sum"))
@ 



<<bam2cgrm2sum, echo=FALSE, results=tex>>=
print(xtable(coef2mat(bam2c.grm.2pl), label="tab:bam2cgrm2sum"))
@ 



<<bam2canovagrm, echo=FALSE, results=hide>>=
bam2cgrm.anova <- anova(bam2c.grm.1pl, bam2c.grm.2pl)
@ 



\subsection{Discussion}

\subsubsection{Study One}
\label{sec:study-1}
A number of issues have become clear from this first sample taken to validate the Treatment Credibility Questionnaire. Firstly, the measure appears to have the expected factor structure, with four factors, one for each set of six questions. Secondly, an item response theory analysis has suggested that while the Pills, Cream and Injection questions can be conceptualised with one latent trait, this does not appear to work for acupuncture. This would seem to suggest that ratings of complementary and western medicine are somewhat independent. The second version of this survey added two more sections on complementary therapies, Homeopathy and Reiki, in order to both balance the kinds of treatments, and to examine whether the assumption of bi-dimensionality would hold in another student and UCC staff sample. 

 Very few demographic variables were collected in this survey. This limited what could be done with the ability estimates, and their relation to other factors. Therefore, for the second and third surveys, more demographics were added.  A question on experience with each of the treatments involved would seem like a useful check on what percentage of the respondents have experiential knowledge of these methods would prove useful. Given the cost of CAM and its unavailability to those of lower incomes, a question on income would also be useful.
Both of these changes were made to the survey, which has since been emailed to all staff and students for further validation. 

In addition, the General sub-scale of the Beliefs about Medicines Questionnaire was appended to V2 of the survey, in order to assess the extent to which the two instruments correlate (or fail to). This is a preliminary attempt to assess construct validity, which of course is but a prelude towards testing the instrument with clinical samples and in experimental settings.

\subsubsection{Study 2}
\label{sec:study-2}



This paper has demonstrated a number of matters with regards to this new instrument. Firstly, it appears to have the predicted factor structure. Secondly, this factor structure has been replicated over two samples. Thirdly, all the major hypotheses (from Study 2) have been confirmed. The measure appears to be stable, possesses good reliability, and seems to correlate in the expected ways with the Beliefs About Medicine Questionnaire. 

That being said, there are some important limitations to the study. Firstly, there was no behavioural or observational outcome to benchmark the test against. This is the authors current focus, and we hope to have such evidence collected by the end of 2010. Secondly, although we sampled twice from the student population and once from the staff population, this test still relies entirely on the responses of staff and students at one particular university. Further replication of the factor structure in heterogenous groups is warranted before extensive use of the instrument takes place. 

  

%%% Local Variables:
%%% TeX-master: "ThesisContents030511"
%%% End:
