<<importdata, echo=FALSE, results=hide>>=
expmeasures <- read.csv("explicitmeasures.csv")
vasscores <- read.csv("VASscores.csv"       )
optiat <- read.csv("optiatres.csv" )
tcqiat <- read.csv("tcqiatres.csv")
@ 

<<iatsort, echo=FALSE, results=hide>>=
tcqiatsorted <- tcqiat[,c("Participant", "Date", "Time", "Block", "Accurate", "Actual", "Real", "Truth", "Fake", "Illusory", "Inaccurate", "Lies", "Cream", "Injections", "Pills", "Surgery", "Acupuncture", "FlowerEssence", "Homeopathy", "Reiki", "Correct", "BlockTime")]
optiatsorted <- optiat[, c("Participant", "Date", "Time", "Block", "Me", "Mine", "Myself", "Theirs", "Them", "Themselves", "Better", "Happy", "Improving", "Succeeding", "Disimproving", "Failing", "Sad", "Worse", "Correct", "BlockTime")]
@ 

<<opttestblocks, echo=FALSE, results=hide>>=
optiatblock3 <- optiatsorted[optiatsorted$Block=="Block 3:",]
optiatblock5 <- optiatsorted[optiatsorted$Block=="Block 5:",]
optstimblock3=optiatblock3[,c(1,5:18)]
optstimblock3$b3sd <- with(optstimblock3, apply(optstimblock3, 1, function (x) sd(x, na.rm=TRUE)))
optstimblock5=optiatblock5[,c(1,5:18)]
optstimblock5$b5sd <- with(optstimblock5, apply(optstimblock5, 1, function (x) sd(x, na.rm=TRUE)))
optstimblock3$b3mean <- with(optstimblock3, apply(optstimblock3, 1, function (x) mean(x, na.rm=TRUE)))
optstimblock5$b5mean <- with(optstimblock5, apply(optstimblock5, 1, function (x) mean(x, na.rm=TRUE)))
optblock3scores <- optstimblock3[,c("Participant", "b3mean", "b3sd")]
optblock5scores <- optstimblock5[,c("Participant", "b5mean", "b5sd")]
optscores <- merge(optblock3scores, optblock5scores, all=FALSE)
optscores$overallsd <- with(optscores, (b3sd+b5sd)/2)
optscores$meandiff <- with(optscores, b5mean-b3mean)
optscores$optiatscore <- with(optscores, meandiff/overallsd)
optiatscores <- optscores[,c("Participant", "optiatscore")]
@ 

<<tcqtestblocks, echo=FALSE, results=hide>>=
tcqiatblock3 <- tcqiatsorted[tcqiatsorted$Block=="Block 3:",]
tcqiatblock5 <- tcqiatsorted[tcqiatsorted$Block=="Block 5:",]
tcqstimblock3=tcqiatblock3[,c(1,5:20)]
tcqstimblock3$b3sd <- with(tcqstimblock3, apply(tcqstimblock3, 1, function (x) sd(x, na.rm=TRUE)))
tcqstimblock5=tcqiatblock5[,c(1,5:20)]
tcqstimblock5$b5sd <- with(tcqstimblock5, apply(tcqstimblock5, 1, function (x) sd(x, na.rm=TRUE)))
tcqstimblock3$b3mean <- with(tcqstimblock3, apply(tcqstimblock3, 1, function (x) mean(x, na.rm=TRUE)))
tcqstimblock5$b5mean <- with(tcqstimblock5, apply(tcqstimblock5, 1, function (x) mean(x, na.rm=TRUE)))
tcqblock3scores <- tcqstimblock3[,c("Participant", "b3mean", "b3sd")]
tcqblock5scores <- tcqstimblock5[,c("Participant", "b5mean", "b5sd")]
tcqscores <- merge(tcqblock3scores, tcqblock5scores)
tcqscores$overallsd <- with(tcqscores, (b3sd+b5sd)/2)
tcqscores$meandiff <- with(tcqscores, b5mean-b3mean)
tcqscores$tcqiatscore <- with(tcqscores, meandiff/overallsd)
tcqiatscore <- tcqscores[, c("Participant", "tcqiatscore")]
@ 

<<selfreportcleanup, echo=FALSE, results=hide>>=
names(vasscores)[1] <-  "Participant"
names(expmeasures)[1] <- "Participant"
vasscores.test <- vasscores[,1:8]
expmeasurescomp <- merge(vasscores.test, expmeasures)
Iatandexpmeasures <- merge(expmeasurescomp, IATscores)
iatexp <- Iatandexpmeasures[,14:23]
Iatandexpmeasures$meanconv <- with(Iatandexpmeasures, (Pill+Cream+Inj)/3)
Iatandexpmeasures$meanalt <- with(Iatandexpmeasures, (Acu+Hom+Rei)/3)
Iatandexpmeasures$convaltcomp <- with(Iatandexpmeasures, meanconv -meanalt)
@ 

<<pairsplot, echo=FALSE, Fig=TRUE>>=
require(psych)
print(pairs.panels(iatexp))
@ 

<<survivaldata, echo=FALSE, results=hide>>=
painratings <- vasscores[,c(9:53)]
napainratings <- apply(painratings,1, function (x)  sum(is.na(x)))
lengthsurv <- 46-napainratings
Iatandexpmeasures$lengthsurv <- lengthsurv
@ 

<<ordtestiatprep, echo=FALSE, results=hide>>=
optblock3 <- optstimblock3[,1:15]
optblock5 <- optstimblock5[,1:15]
tcqblock3 <- tcqstimblock3[,1:17]
tcqblock5 <- tcqstimblock5[,1:17]
optblocks3and5 <-  merge(optblock3, optblock5, by="Participant")
optblocks3and5$Me.diff <-with(optblocks3and5,Me.x-Me.y )
optblocks3and5$Mine.diff <-with(optblocks3and5,Mine.x-Mine.y)
optblocks3and5$Myself.diff <-with(optblocks3and5,Myself.x-Myself.y)
optblocks3and5$Theirs.diff <-with(optblocks3and5,Theirs.x-Theirs.y)
optblocks3and5$Them.diff <-with(optblocks3and5,Them.x-Them.y)
optblocks3and5$Themselves.diff <-with(optblocks3and5,Themselves.x-Themselves.y)
optblocks3and5$Better.diff <-with(optblocks3and5,Better.x-Better.y)
optblocks3and5$Happy.diff <-with(optblocks3and5,Happy.x-Happy.y)
optblocks3and5$Happy.diff <-with(optblocks3and5,Improving.x-Improving.y)
optblocks3and5$Happy.diff <-with(optblocks3and5,Happy.x-Happy.y)
optblocks3and5$Improving.diff <-with(optblocks3and5,Improving.x-Improving.y)
optblocks3and5$Succeeding.diff<-with(optblocks3and5,Succeeding.x-Succeeding.y)
optblocks3and5$Disimproving.diff <- with(optblocks3and5,Disimproving.x-Disimproving.y)
optblocks3and5$Failing.diff <-with(optblocks3and5,Failing.x-Failing.y)
optblocks3and5$Worse.diff <-with(optblocks3and5,Worse.x-Worse.y)
tcqblocks3and5 <- merge(tcqblock3, tcqblock5, by="Participant")
tcqblocks3and5$Accurate.diff <- with(tcqblocks3and5, Accurate.x-Accurate.y)
tcqblocks3and5$Actual.diff <- with(tcqblocks3and5, Actual.x-Actual.y)
tcqblocks3and5$Real.diff <- with(tcqblocks3and5, Real.x-Real.y)
tcqblocks3and5$Truth.diff <- with(tcqblocks3and5, Truth.x-Truth.y)
tcqblocks3and5$Fake.diff <- with(tcqblocks3and5, Fake.x-Fake.y)
tcqblocks3and5$Illusory.diff <- with(tcqblocks3and5, Illusory.x-Illusory.y)
tcqblocks3and5$Inaccurate.diff <- with(tcqblocks3and5, Inaccurate.x-Inaccurate.y)
tcqblocks3and5$Lies.diff <- with(tcqblocks3and5, Lies.x-Lies.y)
tcqblocks3and5$Cream.diff <- with(tcqblocks3and5, Cream.x-Cream.y)
tcqblocks3and5$Injections.diff <- with(tcqblocks3and5, Injections.x-Injections.y)
tcqblocks3and5$Surgery.diff <- with(tcqblocks3and5, Surgery.x-Surgery.y)
tcqblocks3and5$Acupuncture.diff <- with(tcqblocks3and5, Acupuncture.x-Acupuncture.y)
tcqblocks3and5$FlowerEssence.diff <- with(tcqblocks3and5, FlowerEssence.x-FlowerEssence.y)
tcqblocks3and5$Homeopathy.diff <- with(tcqblocks3and5, Homeopathy.x-Homeopathy.y)
tcqblocks3and5$Reiki.diff <- with(tcqblocks3and5, Reiki.x-Reiki.y)
tcqdiffs <- tcqblocks3and5[,34:48]
optdiffs.dich <- apply(optdiffs, c(1,2), function (x) ifelse(x>0, 1, 0))
tcqdiffs.dich <- apply(tcqdiffs, c(1,2), function (x) ifelse(x>0, 1, 0))
@ 

<<pain.ts, echo=FALSE, results=hide>>=
painratings <- vasscores[,c(1,9:53)]
painratings.temp <- painratings[,2:length(painratings)]
painratings.trans <- t(painratings.temp)
colnames(painratings.trans) <- as.character(t(painratings[,1]))
@ 

<<placeboglm, echo=FALSE, results=tex>>=
require(arm)
require(xtable)
placmod5 <- glm(PlacResp~Condition+tcqiatscore*optiatscore*LOTR, data=Iatandexpmeasures, family=binomial(link="logit"))
sumplacmod5 <- summary(placmod5)
placmod.xtab <- xtable(sumplacmod5)
print(placmod.xtab)
@ 

<<placcoefplot, echo=FALSE, fig=TRUE>>=
print(coefplot(placmod5))
@ 
<<tsimport, echo=FALSE, results=hide>>=
phys2456 <- read.table("Richie-1-2456.txt")
colnames(phys2456) <- c("GSR2456", "ECG2456")
phys1903 <- read.table("Richie-2-1903.txt" )
colnames(phys1903) <- c("GSR1903", "ECG1903")
phys1879 <- read.table("Richie-3-1879.txt" )
colnames(phys1879) <- c("GSR1879", "ECG1879")
phys5701 <- read.table("Richie-4-5701.txt")
colnames(phys5701) <- c("GSR5701", "ECG5701")
phys0317 <- read.table("Richie-6-0317.txt")
colnames(phys0317) <- c("GSR0317", "ECG0317")
phys1243 <- read.table( "Richie-7-1243.txt")
colnames(phys1243) <- c("GSR1243", "ECG1243")
phys4325 <- read.table("Richie-8-4325.txt")
colnames(phys4325) <- c("GSR4325", "ECG4325")
phys2003 <- read.table("Richie-9-2003.txt" )
colnames(phys2003) <- c("GSR2003", "ECG2003")
phys6334 <- read.table("Richie-10-6334.txt"  )
colnames(phys6334) <- c("GSR6334", "ECG6334")
phys4181 <- read.table("Richie-11-4181.txt" )
colnames(phys4181) <- c("GSR4181", "ECG4181")
phys7327 <- read.table("Richie-12-7327.txt")
colnames(phys7327) <- c("GSR7327", "ECG7327")
phys4010 <- read.table("Richie-13-4010.txt")
colnames(phys4010) <- c("GSR4010", "ECG4010")
phys2634 <- read.table("Richie-14-2634.txt")
colnames(phys2634) <- c("GSR2634", "ECG2634")
 phys7443 <- read.table("Richie-15-7443.txt")
colnames(phys7443) <- c("GSR7443", "ECG7443")
 phys5682 <- read.table("Richie-16-5682.txt")
colnames(phys5682) <- c("GSR5682", "ECG5682")
 phys2232 <- read.table("Richie-17-2232.txt")
colnames(phys2232) <- c("GSR2232", "ECG2232")
 phys3101 <- read.table("Richie-18-3101.txt")
colnames(phys3101) <- c("GSR3101", "ECG3101")
 phys1101 <- read.table("Richie-19-1101.txt")
colnames(phys1101) <- c("GSR1101", "ECG1101")
 phys1089 <- read.table("Richie-20-1089.txt")
colnames(phys1089) <- c("GSR1089", "ECG1089")
 phys6936 <- read.table("Richie-21-6936.txt")
colnames(phys6936) <- c("GSR6936", "ECG6936")
 phys8273 <- read.table("Richie-22-8273.txt")
colnames(phys8273) <- c("GSR8273", "ECG8273")
 phys9876 <- read.table("Richie-23-9876.txt")
colnames(phys9786) <- c("GSR9786", "ECG9786")
 phys2212 <- read.table("Richie-24-2212.txt")
colnames(phys2212) <- c("GSR2212", "ECG2212")
 phys2928 <- read.table("Richie-25-2928.txt")
colnames(phys2928) <- c("GSR2928", "ECG2928")
 phys1911 <- read.table("Richie-26-1911.txt")
colnames(phys1911) <- c("GSR1911", "ECG1911")
 phys9120 <- read.table("Richie-27-9120.txt")
colnames(phys9120) <- c("GSR9120", "ECG9120")
 phys1956 <- read.table("Richie-28-1956.txt")
colnames(phys1956) <- c("GSR1956", "ECG1956")
 phys4242 <- read.table("Richie-29-4242.txt")
colnames(phys4242) <- c("GSR4242", "ECG4242")
 phys11012 <- read.table("Richie-30-11012.txt")
colnames(phys11012) <- c("GSR11012", "ECG11012")
 phys6647 <- read.table( "Richie-31-6647.txt")
colnames(phys6647) <- c("GSR6647", "ECG6647")
 phys2679 <- read.table( "Richie-32-2679.txt")
colnames(phys2679) <- c("GSR2679", "ECG2679")
 phys1321 <- read.table( "Richie-33-1321.txt")
colnames(phys1321) <- c("GSR1321", "ECG1321")
 phys1810 <- read.table( "Richie-34-1810.txt")
colnames(phys1810) <- c("GSR1810", "ECG1810")
 phys2069 <- read.table( "Richie-35-2069.txt")
colnames(phys2069) <- c("GSR2069", "ECG2069")
 phys1991 <- read.table( "Richie-36-1991.txt")
colnames(phys1991) <- c("GSR1991", "ECG1991")
 phys6542 <- read.table("Richie-37-6542.txt")
colnames(phys6542) <- c("GSR6542", "ECG6542")
 phys0856 <- read.table("Richie-38-0856.txt")
colnames(phys0856) <- c("GSR0856", "ECG0856")
 phys7787 <- read.table( "Richie-39-7787.txt")
colnames(phys7787) <- c("GSR7787", "ECG7787")
 phys5456 <- read.table( "Richie-40-5456.txt")
colnames(phys7787) <- c("GSR7787", "ECG7787")
 phys0405 <- read.table("Richie-41-0405.txt")
colnames(phys0405) <- c("GSR0405", "ECG0405")
phys4228 <- read.table( "Richie-42-4228.txt")
colnames(phys4228) <- c("GSR4228", "ECG4228")
phys19912 <- read.table( "Richie-43-19912.txt")
colnames(phys19912) <- c("GSR19912", "ECG19912")
phys0606 <- read.table( "Richie-44-0606.txt")
colnames(phys0606) <- c("GSR0606", "ECG0606")
 phys6691 <- read.table( "Richie-45-6691.txt")
colnames(phys6691) <- c("GSR6691", "ECG6691")
 phys1923 <- read.table( "Richie-46-1923.txt")
colnames(phys1923) <- c("GSR1923", "ECG1923")
 phys1748 <- read.table( "Richie-47-1748.txt")
colnames(phys1748) <- c("GSR1748", "ECG1748")
 phys2610 <- read.table( "Richie-48-2610.txt")
colnames(phys2610) <- c("GSR2610", "ECG2610")
 phys11012 <- read.table( "Richie-49-11012.txt")
colnames(phys11012) <- c("GSR11012", "ECG11012")
 phys1224 <- read.table( "Richie-50-1224.txt")
colnames(phys1224) <- c("GSR1224", "ECG1224")
 phys1212 <- read.table( "Richie-51-1212.txt")
colnames(phys1212) <- c("GSR1212", "ECG1212")
phys1617 <- read.table( "Richie-52-1617.txt")
colnames(phys1617) <- c("GSR1617", "ECG1617")
phys1209 <- read.table( "Richie-53-1209.txt")
colnames(phys1209) <- c("GSR1209", "ECG1209")
phys1103 <- read.table( "Richie-54-1103.txt")
colnames(phys1103) <- c("GSR1103", "ECG1103")
phys2510 <- read.table( "Richie-55-2510.txt")
colnames(phys2510) <- c("GSR2510", "ECG2510")
phys1986 <- read.table( "Richie-56-1986.txt")
colnames(phys1986) <- c("GSR1986", "ECG1986")
phys8888 <- read.table( "Richie-57-8888.txt")
colnames(phys8888) <- c("GSR8888", "ECG8888")
phys5923 <- read.table( "Richie-58-5923.txt")
colnames(phys5923) <- c("GSR5923", "ECG5923")
phys97862 <- read.table("Richie-59-98762.txt")
colnames(phys97862) <- c("GSR98762", "ECG98762")
phys9853 <- read.table( "Richie-60-9853.txt")
colnames(phys9853) <- c("GSR9853", "ECG9853")
phys1987 <- read.table( "Richie-61-1987.txt")
colnames(phys1987) <- c("GSR1987", "ECG1987")
phys1970 <- read.table( "Richie-62-1970.txt")
colnames(phys1970) <- c("GSR1970", "ECG1970")
phys0833 <- read.table("Richie-63-0833.txt")
colnames(phys0833) <- c("GSR0833", "ECG0833")
phys3497 <- read.table( "Richie-64-3497.txt")
colnames(phys3497) <- c("GSR3497", "ECG3497")
phys8421 <- read.table("Richie-65-8421.txt")
colnames(phys8421) <- c("GSR8421", "ECG8421")
phys8421 <- read.table("Richie-66-5440.txt")
colnames(phys8421) <- c("GSR8421", "ECG8421")
phys5262 <- read.table("Richie-67-5262.txt")
colnames(phys5262) <- c("GSR5262", "ECG5262")
phys1358 <-  read.table("Richie-68-1358.txt")
colnames(phys1358) <- c("GSR1358", "ECG1358")
phys7141 <- read.table( "Richie-69-7141.txt")
colnames(phys7141) <- c("GSR7141", "ECG7141")
phys5324 <- read.table( "Richie-70-5324.txt")
colnames(phys5324) <- c("GSR5324", "ECG5324")
phys8206 <- read.table( "Richie-71-8206.txt")
colnames(phys8206) <- c("GSR8206", "ECG8206")
phys19562 <- read.table( "Richie-72-19562.txt")
colnames(phys19562) <- c("GSR19562", "ECG19562")
phys0705 <- read.table( "Richie-73-0705.txt")
colnames(phys0705) <- c("GSR0705", "ECG0705")
phys2245 <- read.table("Richie-74-2245.txt")
colnames(phys2245) <- c("GSR2245", "ECG2245")
phys5328 <- read.table( "Richie-75-5328.txt")
colnames(phys5328) <- c("GSR5328", "ECG5328")
phys3049 <- read.table( "Richie-76-3049.txt")
colnames(phys3049) <- c("GSR3049", "ECG3049")
phys5209 <- read.table( "Richie-77-5209.txt")
colnames(phys5209) <- c("GSR5209", "ECG5209")
phys1580 <- read.table( "Richie-78-1580.txt")
colnames(phys1580) <- c("GSR1580", "ECG1580")
phys7198 <- read.table( "Richie-79-7198.txt")
colnames(phys7198) <- c("GSR7198", "ECG7198")
phys3580 <- read.table( "Richie-80-3580.txt")
colnames(phys3580) <- c("GSR3580", "ECG3580")
phys2345 <- read.table( "Richie-81-2345.txt")
colnames(phys2345) <- c("GSR2345", "ECG2345")
phys6955 <- read.table("Richie-82-6955.txt")
colnames(phys6955) <- c("GSR6955", "ECG6955")
phys4062 <- read.table( "Richie-83-4062.txt")
colnames(phys4062) <- c("GSR4062", "ECG4062")
phys4662 <- read.table( "Richie-84-4662.txt")
colnames(phys4662) <- c("GSR4662", "ECG4662")
phys4892 <- read.table("Richie-85-4892.txt")
colnames(phys4892) <- c("GSR4892", "ECG4892")
phys0473 <- read.table("Richie-86-0473.txt")
colnames(phys0473) <- c("GSR0473", "ECG0473")
phys6536 <- read.table( "Richie-87-6536.txt")
colnames(phys6536) <- c("GSR6536", "ECG6536")
phys1004 <- read.table( "Richie-88-1004.txt")
colnames(phys1004) <- c("GSR1004", "ECG1004")
phys1234 <- read.table( "Richie-89-1234.txt")
colnames(phys1234) <- c("GSR1234", "ECG1234")
phys3190 <- read.table( "Richie-90-3190.txt")
colnames(phys3190) <- c("GSR3190", "ECG3190")
phys2385 <- read.table( "Richie-91-2385.txt")
colnames(phys2385) <- c("GSR2385", "ECG2385")
phys4391 <- read.table( "Richie-92-4391.txt")
colnames(phys4391) <- c("GSR4391", "ECG4391")
phys7983 <- read.table( "Richie-93-7983.txt")
colnames(phys7983) <- c("GSR7983", "ECG7983")
phys1843 <- read.table( "Richie-94-1843.txt")
colnames(phys1843) <- c("GSR1843", "ECG1843")
phys4278 <- read.table( "Richie-95-4278.txt")
colnames(phys4278) <- c("GSR4278", "ECG4278")
phys1717 <- read.table( "Richie-96-1717.txt")
colnames(phys1717) <- c("GSR1717", "ECG1717")
phys1604 <- read.table( "Richie-97-1604.txt")
colnames(phys1604) <- c("GSR1604", "ECG1604")
phys0234 <- read.table( "Richie-98-0234.txt")
colnames(phys0234) <- c("GSR0234", "ECG0234")
phys5533 <- read.table( "Richie-99-5533.txt")
colnames(phys5533) <- c("GSR5533", "ECG5533")
phys19563 <- read.table("Richie-100-19563.txt")
colnames(phys19563) <- c("GSR19563", "ECG19563")
phys7837 <- read.table( "Richie-101-7837.txt")
colnames(phys7837) <- c("GSR7837", "ECG7837")
phys5669 <- read.table("Richie-103-5669.txt")
colnames(phys5669) <- c("GSR5669", "ECG5669")
phys9548 <- read.table( "Richie-104-9548.txt")
colnames(phys9548) <- c("GSR9548", "ECG9548")
phys3725 <- read.table( "Richie-105-3725.txt")
colnames(phys3725) <- c("GSR3725", "ECG3725")
phys7521 <- read.table( "Richie-106-7521.txt")
colnames(phys7521) <- c("GSR7521", "ECG7521")
phys2983 <- read.table( "Richie-107-2983.txt")
colnames(phys2983) <- c("GSR2983", "ECG2983")
phys27122 <- read.table( "Richie-108-27122.txt")
colnames(phys27122) <- c("GSR27122", "ECG27122")
phys3687 <- read.csv( "Richie-109-3687.txt")
colnames(phys3687) <- c("GSR3687", "ECG3687")
phys7706 <- read.table( "Richie-110-7706.txt")
colnames(phys7706) <- c("GSR7706", "ECG7706")
phys9782 <- read.table("Richie-111-9782.txt")
colnames(phys9782) <- c("GSR9782", "ECG9782")
 

@ 
